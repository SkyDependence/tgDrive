var e=(e,a,l)=>new Promise((s,t)=>{var r=e=>{try{u(l.next(e))}catch(a){t(a)}},o=e=>{try{u(l.throw(e))}catch(a){t(a)}},u=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,o);u((l=l.apply(e,a)).next())});import{_ as a}from"./index-BMCoaVX0.js";/* empty css                               *//* empty css                             *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                *//* empty css                 */import{p as l,a as s,Z as t,o as r,q as o,U as u,O as n,v as d,t as i,u as c,a2 as m,S as p,T as f,F as g,a8 as v,R as _,M as h}from"./vue-vendor-BrR667iQ.js";import{s as y}from"./request-ByDjFvYQ.js";import{E as x,Q as b,Y as V,T as k,Z as j,_ as z,U as w,$ as U,a0 as T,h as C,e as B,a1 as q,a2 as I,R,L as D,f as F,a3 as $,a4 as L,a5 as P,a6 as A,a7 as S,P as Z,a8 as E}from"./element-plus-p6bCxHry.js";import"./utils-CuRI1GyR.js";const H={class:"page-container"},M={class:"card-header"},O={class:"card-header"},Q={class:"load-config-wrapper"},Y={key:0,class:"config-preview"},G=a(l({__name:"Home",setup(a){const l=s(),G=t({name:"",token:"",target:"",url:"",pass:""}),J=s(!1),K=s(!1),N=s(!1),W=s(!1),X=s([]),ee=s(""),ae=s(null),le=t({name:[{required:!0,message:"请输入配置名称",trigger:"blur"}],token:[{required:!0,message:"请输入 Bot Token",trigger:"blur"}],target:[{required:!0,message:"请输入 Chat ID",trigger:"blur"}]}),se=()=>e(this,null,function*(){N.value=!0;try{const e=yield y.get("/config/configs");1===e.data.code&&Array.isArray(e.data.data)?X.value=e.data.data:x.error("获取配置列表失败")}catch(e){x.error("获取配置列表失败，请检查网络")}finally{N.value=!1}}),te=e=>{ae.value=X.value.find(a=>a.name===e)||null},re=()=>e(this,null,function*(){l.value&&(yield l.value.validate(a=>e(this,null,function*(){var e,s,t;if(a){J.value=!0;try{const a=yield y.post("/config",G);1===a.data.code?(x.success(a.data.msg||"配置提交成功"),null==(e=l.value)||e.resetFields(),se()):x.error(a.data.msg||"提交失败")}catch(r){x.error((null==(t=null==(s=r.response)?void 0:s.data)?void 0:t.msg)||"提交失败，请检查网络")}finally{J.value=!1}}})))}),oe=()=>{var e;null==(e=l.value)||e.resetFields()},ue=()=>e(this,null,function*(){if(ee.value){K.value=!0;try{const e=yield y.get(`/config/${ee.value}`);1===e.data.code?x.success(e.data.msg||"配置加载成功"):x.error(e.data.msg||"加载配置失败")}catch(e){x.error("加载失败，请检查网络")}finally{K.value=!1}}else x.warning("请先选择一个配置")}),ne=()=>e(this,null,function*(){var e,a;if(ee.value){try{yield C.confirm(`确定要删除配置 "${ee.value}" 吗？此操作不可撤销。`,"确认删除",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"})}catch(l){return}W.value=!0;try{const e=yield y.delete(`/config/${ee.value}`);1===e.data.code?(x.success(e.data.msg||"配置删除成功"),ee.value="",ae.value=null,se()):x.error(e.data.msg||"删除配置失败")}catch(s){x.error((null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.msg)||"删除失败，请检查网络")}finally{W.value=!1}}else x.warning("请先选择一个配置")});return r(()=>{se()}),(e,a)=>{const s=B,t=q,r=I,y=R,x=D,C=F,se=$,de=b,ie=E,ce=L,me=P,pe=A,fe=S,ge=Z;return d(),o("div",H,[u(de,{class:"content-card"},{header:n(()=>[i("div",M,[u(s,null,{default:n(()=>[u(c(V))]),_:1}),a[6]||(a[6]=i("span",null,"Bot 配置",-1))])]),default:n(()=>[u(se,{ref_key:"ruleFormRef",ref:l,model:G,rules:le,"label-position":"top",class:"config-form",onSubmit:m(re,["prevent"])},{default:n(()=>[u(x,{gutter:20},{default:n(()=>[u(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:n(()=>[u(r,{label:"配置名称",prop:"name"},{default:n(()=>[u(t,{modelValue:G.name,"onUpdate:modelValue":a[0]||(a[0]=e=>G.name=e),placeholder:"为您的配置命名","prefix-icon":c(k),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),u(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:n(()=>[u(r,{label:"Chat ID",prop:"target"},{default:n(()=>[u(t,{modelValue:G.target,"onUpdate:modelValue":a[1]||(a[1]=e=>G.target=e),placeholder:"请输入接收文件的频道/用户 ID","prefix-icon":c(j),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),u(y,{xs:24,sm:24,md:24,lg:24,xl:24},{default:n(()=>[u(r,{label:"Bot Token",prop:"token"},{default:n(()=>[u(t,{modelValue:G.token,"onUpdate:modelValue":a[2]||(a[2]=e=>G.token=e),placeholder:"请输入 Telegram Bot Token","prefix-icon":c(z),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),u(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:n(()=>[u(r,{label:"自定义 URL (选填)",prop:"url"},{default:n(()=>[u(t,{modelValue:G.url,"onUpdate:modelValue":a[3]||(a[3]=e=>G.url=e),placeholder:"用于生成下载链接的域名","prefix-icon":c(w),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),u(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:n(()=>[u(r,{label:"访问密码 (选填)",prop:"pass"},{default:n(()=>[u(t,{modelValue:G.pass,"onUpdate:modelValue":a[4]||(a[4]=e=>G.pass=e),type:"password",placeholder:"为配置设置访问密码","show-password":"","prefix-icon":c(U),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1})]),_:1}),u(r,{class:"form-actions"},{default:n(()=>[u(C,{type:"primary","native-type":"submit",loading:J.value,size:"large"},{default:n(()=>[p(f(J.value?"提交中...":"保存并提交"),1)]),_:1},8,["loading"]),u(C,{onClick:oe,size:"large"},{default:n(()=>a[7]||(a[7]=[p("重置表单")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),u(de,{class:"content-card"},{header:n(()=>[i("div",O,[u(s,null,{default:n(()=>[u(c(T))]),_:1}),a[8]||(a[8]=i("span",null,"加载现有配置",-1))])]),default:n(()=>[i("div",Q,[u(ce,{modelValue:ee.value,"onUpdate:modelValue":a[5]||(a[5]=e=>ee.value=e),placeholder:"请选择一个配置文件进行加载",class:"config-select",size:"large",loading:N.value,onChange:te,filterable:""},{default:n(()=>[(d(!0),o(g,null,v(X.value,e=>(d(),h(ie,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),u(C,{type:"success",onClick:ue,loading:K.value,disabled:!ee.value,size:"large",plain:""},{default:n(()=>a[9]||(a[9]=[p(" 加载选中配置 ")])),_:1},8,["loading","disabled"]),u(C,{type:"danger",onClick:ne,loading:W.value,disabled:!ee.value,size:"large",plain:""},{default:n(()=>a[10]||(a[10]=[p(" 删除配置 ")])),_:1},8,["loading","disabled"])]),u(ge,null,{default:n(()=>[ae.value?(d(),o("div",Y,[u(me),a[11]||(a[11]=i("h3",null,"配置预览",-1)),u(fe,{column:1,border:"",size:"small"},{default:n(()=>[u(pe,{label:"名称"},{default:n(()=>[p(f(ae.value.name),1)]),_:1}),u(pe,{label:"Token"},{default:n(()=>[p(f(ae.value.token),1)]),_:1}),u(pe,{label:"Chat ID"},{default:n(()=>[p(f(ae.value.target),1)]),_:1}),u(pe,{label:"URL"},{default:n(()=>[p(f(ae.value.url||"未设置"),1)]),_:1}),u(pe,{label:"密码"},{default:n(()=>[p(f(ae.value.pass?"******":"未设置"),1)]),_:1})]),_:1})])):_("",!0)]),_:1})]),_:1})])}}}),[["__scopeId","data-v-8a5d5fcf"]]);export{G as default};
