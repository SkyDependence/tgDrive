import{_ as a}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                *//* empty css                             *//* empty css               *//* empty css                   *//* empty css                 */import{a as e,i as t,an as l,au as s,av as i,aw as o,y as n,d as c,ax as r,D as d,f as u,F as p,a5 as v,G as m}from"./element-plus-4BAtKzRy.js";import{a as f}from"./vendor-BRDptmtZ.js";import{d as g,r as y,j as _,f as h,c as b,P as w,H as j,o as k,a as z,u as x,R as T,O as B}from"./vue-vendor-B9yd_xiB.js";const C={class:"page-container"},D={class:"card-header"},P={class:"action-section"},A={class:"status-section"},F={class:"action-item"},G={class:"action-item"},H={class:"task-controls"},I={class:"action-item"},K={class:"config-info"},L=a(g({__name:"BotKeepAlivePage",setup(a){const g=y(!1),L=y(!1),N=y(!1),O=y(!1),R=y(""),S=_(()=>g.value?"保活任务运行中":"保活任务已停止"),q=_(()=>g.value?"success":"warning"),E=_(()=>g.value?"定时保活任务正在运行，将在每天凌晨2点自动发送保活消息，确保机器人保持活跃状态。":"定时保活任务已停止，机器人可能会因长时间不活跃而被Telegram限制。建议启动定时任务。"),J=()=>{R.value=(new Date).toLocaleString("zh-CN")},M=async()=>{try{const a=await f.get("/api/bot/keep-alive/status");1===a.data.code&&(g.value="运行中"===a.data.data,J())}catch(a){e.error("获取任务状态失败")}},Q=async()=>{L.value=!0;try{const a=await f.post("/api/bot/keep-alive/send");1===a.data.code?(e.success("保活消息发送成功"),J()):e.error(a.data.msg||"发送失败")}catch(a){e.error("发送保活消息失败")}finally{L.value=!1}},U=async()=>{try{await n.confirm("确定要启动定时保活任务吗？任务将在每天凌晨2点自动发送保活消息。","确认启动",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),N.value=!0;const a=await f.post("/api/bot/keep-alive/start");1===a.data.code?(e.success("定时保活任务启动成功"),await M()):e.error(a.data.msg||"启动失败")}catch(a){"cancel"!==a&&e.error("启动定时任务失败")}finally{N.value=!1}},V=async()=>{try{await n.confirm("确定要停止定时保活任务吗？停止后机器人可能会因长时间不活跃而被限制。","确认停止",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),O.value=!0;const a=await f.post("/api/bot/keep-alive/stop");1===a.data.code?(e.success("定时保活任务停止成功"),await M()):e.error(a.data.msg||"停止失败")}catch(a){"cancel"!==a&&e.error("停止定时任务失败")}finally{O.value=!1}};return h(()=>{M()}),(a,e)=>{const n=c,f=r,y=d,_=u,h=p,J=v,M=m,W=t;return k(),b("div",C,[w(W,{class:"content-card"},{header:j(()=>[z("div",D,[w(n,null,{default:j(()=>[w(x(l))]),_:1}),e[0]||(e[0]=z("span",null,"机器人保活管理",-1))])]),default:j(()=>[z("div",P,[z("div",A,[w(f,{title:S.value,type:q.value,description:E.value,"show-icon":"",closable:!1},null,8,["title","type","description"])]),w(y,{direction:"horizontal"}),z("div",F,[e[2]||(e[2]=z("h3",null,"手动发送保活消息",-1)),e[3]||(e[3]=z("p",null,"立即发送一条保活消息到Telegram，用于测试机器人连接状态。",-1)),w(_,{type:"primary",onClick:Q,loading:L.value,icon:x(s),size:"large"},{default:j(()=>e[1]||(e[1]=[T(" 发送保活消息 ")])),_:1},8,["loading","icon"])]),w(y,{direction:"horizontal"}),z("div",G,[e[6]||(e[6]=z("h3",null,"定时保活任务",-1)),e[7]||(e[7]=z("p",null,"控制自动保活任务的启动和停止。任务将在每天凌晨2点自动发送保活消息。",-1)),z("div",H,[w(_,{type:"success",onClick:U,loading:N.value,disabled:g.value,icon:x(i),size:"large"},{default:j(()=>e[4]||(e[4]=[T(" 启动定时任务 ")])),_:1},8,["loading","disabled","icon"]),w(_,{type:"warning",onClick:V,loading:O.value,disabled:!g.value,icon:x(o),size:"large",plain:""},{default:j(()=>e[5]||(e[5]=[T(" 停止定时任务 ")])),_:1},8,["loading","disabled","icon"])])]),w(y,{direction:"horizontal"}),z("div",I,[e[10]||(e[10]=z("h3",null,"保活配置",-1)),z("div",K,[w(M,{column:1,border:""},{default:j(()=>[w(h,{label:"发送时间"},{default:j(()=>e[8]||(e[8]=[T("每天凌晨2点")])),_:1}),w(h,{label:"发送间隔"},{default:j(()=>e[9]||(e[9]=[T("24小时")])),_:1}),w(h,{label:"任务状态"},{default:j(()=>[w(J,{type:g.value?"success":"danger"},{default:j(()=>[T(B(g.value?"运行中":"已停止"),1)]),_:1},8,["type"])]),_:1}),w(h,{label:"最后更新"},{default:j(()=>[T(B(R.value),1)]),_:1})]),_:1})])])])]),_:1})])}}}),[["__scopeId","data-v-a24025c8"]]);export{L as default};
