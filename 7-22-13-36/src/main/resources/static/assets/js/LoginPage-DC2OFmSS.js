import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                     *//* empty css                    *//* empty css                 */import{d as a,r as l,f as s,c as r,a as o,P as t,H as u,ah as i,au as n,o as m,u as d,R as p,O as c}from"./vue-vendor-B9yd_xiB.js";import{d as g,B as v,X as f,Y as _,w as y,a as b,y as h,z as w,A as V,V as I,Z as j,f as k}from"./element-plus-DGu32Jg7.js";import{s as x}from"./request-Btv0w3bA.js";import"./vendor-u6XoYjkS.js";const S={class:"login-page-container"},z={class:"login-card"},U={class:"login-header"},q={class:"login-options"},C=e(a({__name:"LoginPage",setup(e){const a=n(),C=l({username:"",password:""}),T=l(),B=l(!1),P=l(!1),R={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名长度至少为3个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6个字符",trigger:"blur"}]},A=()=>{var e;null==(e=T.value)||e.validate(async e=>{if(e){B.value=!0;try{const e=await x.post("/auth/login",{username:C.value.username,password:C.value.password});if(1===e.data.code){const l=e.data.data;localStorage.setItem("token",l.token),localStorage.setItem("role",l.role),localStorage.setItem("userId",l.UserId),P.value?localStorage.setItem("username",C.value.username):localStorage.removeItem("username"),b.success(e.data.msg||"登录成功"),a.push("/home")}else b.error(e.data.msg||"登录失败")}catch(l){b.error("登录失败，请检查网络或联系管理员")}finally{B.value=!1}}})},F=()=>{h.alert("请联系管理员重置您的密码。","忘记密码",{confirmButtonText:"好的"})},G=()=>{a.push("/register")};return s(()=>{const e=localStorage.getItem("username");e&&(C.value.username=e,P.value=!0)}),(e,a)=>{const l=g,s=w,n=V,b=I,h=j,x=k,H=v;return m(),r("div",S,[o("div",z,[o("div",U,[t(l,{size:28,color:"var(--el-color-primary)"},{default:u(()=>[t(d(f))]),_:1}),a[3]||(a[3]=o("h2",{class:"login-title"},"欢迎回来",-1)),a[4]||(a[4]=o("p",{class:"login-subtitle"},"登录以继续使用 ST-TG网盘",-1))]),t(H,{model:C.value,rules:R,ref_key:"loginFormRef",ref:T,"label-position":"top",onKeyup:i(A,["enter"]),class:"login-form"},{default:u(()=>[t(n,{label:"用户名",prop:"username"},{default:u(()=>[t(s,{modelValue:C.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>C.value.username=e),"prefix-icon":d(_),placeholder:"请输入用户名",size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),t(n,{label:"密码",prop:"password"},{default:u(()=>[t(s,{modelValue:C.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>C.value.password=e),"prefix-icon":d(y),type:"password",placeholder:"请输入密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),t(n,null,{default:u(()=>[o("div",q,[t(b,{modelValue:P.value,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value=e)},{default:u(()=>a[5]||(a[5]=[p("记住我")])),_:1},8,["modelValue"]),t(h,{type:"primary",onClick:F},{default:u(()=>a[6]||(a[6]=[p("忘记密码？")])),_:1}),t(h,{type:"primary",onClick:G},{default:u(()=>a[7]||(a[7]=[p("注册新账号")])),_:1})])]),_:1}),t(n,null,{default:u(()=>[t(x,{type:"primary",onClick:A,loading:B.value,class:"login-button",size:"large",block:""},{default:u(()=>[p(c(B.value?"登录中...":"登 录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),[["__scopeId","data-v-81c7e0ea"]]);export{C as default};
