import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                 *//* empty css                *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                   */import{a as l,i as a,s as t,$ as o,aA as d,aB as i,Q as s,aC as n,aD as r,y as u,d as c,D as p,U as m,A as b,z as f,H as v,C as g,aE as w,f as V,B as _,az as h}from"./element-plus-Kv_AC7qh.js";import{a as x}from"./vendor-DlW7-jsh.js";import{d as y,b as D,W as A,j as W,f as j,c as U,Q as C,I as k,H as M,O as z,o as B,a as P,u as S,S as q,P as R}from"./vue-vendor-uyOI1CZy.js";const T={class:"webdav-config-container"},F={class:"usage-content"},$={class:"webdav-url"},E=e(y({__name:"WebDavConfigPage",setup(e){const y=D(),E=D(!1),O=D(!1),H=A({enabled:!0,pathPrefix:"/webdav",requireAuth:!0,allowedRoles:"admin",maxUploadSize:100,allowMkdir:!0,allowDelete:!0,allowMove:!0,allowCopy:!0,description:"WebDAV服务配置"}),I={pathPrefix:[{required:!0,message:"请输入访问路径",trigger:"blur"},{pattern:/^\/.*/,message:"路径必须以/开头",trigger:"blur"}],allowedRoles:[{required:!0,message:"请选择允许的角色",trigger:"change"}],maxUploadSize:[{required:!0,message:"请输入最大上传大小",trigger:"blur"},{type:"number",min:1,max:1024,message:"大小必须在1-1024MB之间",trigger:"blur"}]},Q=W(()=>`${window.location.protocol}//${window.location.host}${H.pathPrefix}`),L=async()=>{try{const e=await x.get("/api/webdav-config");1===e.data.code?Object.assign(H,e.data.data):l.error(e.data.msg||"加载配置失败")}catch(e){l.error("加载配置失败")}},N=async()=>{if(y.value)try{await y.value.validate(),E.value=!0;const e=await x.put("/api/webdav-config",H);1===e.data.code?l.success("配置保存成功"):l.error(e.data.msg||"配置保存失败")}catch(e){l.error("配置保存失败")}finally{E.value=!1}},G=()=>{y.value&&(y.value.resetFields(),L())},J=async()=>{try{await u.confirm("确定要恢复默认配置吗？这将覆盖当前所有设置。","确认恢复默认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),O.value=!0;const e=await x.post("/api/webdav-config/reset");1===e.data.code?(l.success("已恢复默认配置"),await L()):l.error(e.data.msg||"恢复默认配置失败")}catch(e){"cancel"!==e&&l.error("恢复默认配置失败")}finally{O.value=!1}},K=e=>{e||u.confirm("禁用WebDAV服务后，所有WebDAV客户端将无法访问。确定要禁用吗？","确认禁用",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>{H.enabled=!0})},X=async()=>{try{await navigator.clipboard.writeText(Q.value),l.success("WebDAV地址已复制到剪贴板")}catch(e){l.error("复制失败")}};return j(()=>{L()}),(e,l)=>{const u=c,x=p,D=m,A=b,W=f,j=v,L=g,Y=w,Z=V,ee=_,le=a,ae=h;return B(),U("div",T,[C(le,{class:"config-card"},{header:k(()=>l[10]||(l[10]=[P("div",{class:"card-header"},[P("h2",null,"WebDAV配置"),P("p",{class:"subtitle"},"配置WebDAV服务的访问权限和功能设置")],-1)])),default:k(()=>[C(ee,{ref_key:"configFormRef",ref:y,model:H,rules:I,"label-width":"140px",class:"config-form"},{default:k(()=>[C(x,{"content-position":"left"},{default:k(()=>[C(u,null,{default:k(()=>[C(S(t))]),_:1}),l[11]||(l[11]=q(" 基础设置 "))]),_:1}),C(A,{label:"启用WebDAV",prop:"enabled"},{default:k(()=>[C(D,{modelValue:H.enabled,"onUpdate:modelValue":l[0]||(l[0]=e=>H.enabled=e),"active-text":"启用","inactive-text":"禁用",onChange:K},null,8,["modelValue"]),l[12]||(l[12]=P("div",{class:"form-tip"},"启用后可通过WebDAV协议访问文件",-1))]),_:1}),C(A,{label:"访问路径",prop:"pathPrefix"},{default:k(()=>[C(W,{modelValue:H.pathPrefix,"onUpdate:modelValue":l[1]||(l[1]=e=>H.pathPrefix=e),placeholder:"/webdav",disabled:!H.enabled},null,8,["modelValue","disabled"]),l[13]||(l[13]=P("div",{class:"form-tip"},"WebDAV服务的访问路径前缀",-1))]),_:1}),C(A,{label:"需要认证",prop:"requireAuth"},{default:k(()=>[C(D,{modelValue:H.requireAuth,"onUpdate:modelValue":l[2]||(l[2]=e=>H.requireAuth=e),"active-text":"需要","inactive-text":"不需要",disabled:!H.enabled},null,8,["modelValue","disabled"]),l[14]||(l[14]=P("div",{class:"form-tip"},"是否需要用户名密码认证",-1))]),_:1}),C(x,{"content-position":"left"},{default:k(()=>[C(u,null,{default:k(()=>[C(S(o))]),_:1}),l[15]||(l[15]=q(" 权限设置 "))]),_:1}),C(A,{label:"允许的角色",prop:"allowedRoles"},{default:k(()=>[C(L,{modelValue:H.allowedRoles,"onUpdate:modelValue":l[3]||(l[3]=e=>H.allowedRoles=e),placeholder:"请选择允许访问的用户角色",disabled:!H.enabled},{default:k(()=>[C(j,{label:"仅管理员",value:"admin"}),C(j,{label:"访客用户",value:"visitor"})]),_:1},8,["modelValue","disabled"]),l[16]||(l[16]=P("div",{class:"form-tip"},"设置哪些角色的用户可以访问WebDAV",-1))]),_:1}),C(x,{"content-position":"left"},{default:k(()=>[C(u,null,{default:k(()=>[C(S(d))]),_:1}),l[17]||(l[17]=q(" 功能设置 "))]),_:1}),C(A,{label:"最大上传大小",prop:"maxUploadSize"},{default:k(()=>[C(Y,{modelValue:H.maxUploadSize,"onUpdate:modelValue":l[4]||(l[4]=e=>H.maxUploadSize=e),min:1,max:1024,step:10,disabled:!H.enabled},null,8,["modelValue","disabled"]),l[18]||(l[18]=P("span",{class:"unit"},"MB",-1)),l[19]||(l[19]=P("div",{class:"form-tip"},"单个文件的最大上传大小限制",-1))]),_:1}),C(A,{label:"允许创建目录",prop:"allowMkdir"},{default:k(()=>[C(D,{modelValue:H.allowMkdir,"onUpdate:modelValue":l[5]||(l[5]=e=>H.allowMkdir=e),"active-text":"允许","inactive-text":"禁止",disabled:!H.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"允许删除文件",prop:"allowDelete"},{default:k(()=>[C(D,{modelValue:H.allowDelete,"onUpdate:modelValue":l[6]||(l[6]=e=>H.allowDelete=e),"active-text":"允许","inactive-text":"禁止",disabled:!H.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"允许移动文件",prop:"allowMove"},{default:k(()=>[C(D,{modelValue:H.allowMove,"onUpdate:modelValue":l[7]||(l[7]=e=>H.allowMove=e),"active-text":"允许","inactive-text":"禁止",disabled:!H.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"允许复制文件",prop:"allowCopy"},{default:k(()=>[C(D,{modelValue:H.allowCopy,"onUpdate:modelValue":l[8]||(l[8]=e=>H.allowCopy=e),"active-text":"允许","inactive-text":"禁止",disabled:!H.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"配置描述",prop:"description"},{default:k(()=>[C(W,{modelValue:H.description,"onUpdate:modelValue":l[9]||(l[9]=e=>H.description=e),type:"textarea",rows:3,placeholder:"请输入配置描述",disabled:!H.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,null,{default:k(()=>[C(Z,{type:"primary",onClick:N,loading:E.value},{default:k(()=>[C(u,null,{default:k(()=>[C(S(i))]),_:1}),l[20]||(l[20]=q(" 保存配置 "))]),_:1},8,["loading"]),C(Z,{onClick:G},{default:k(()=>[C(u,null,{default:k(()=>[C(S(s))]),_:1}),l[21]||(l[21]=q(" 重置 "))]),_:1}),C(Z,{onClick:J,loading:O.value},{default:k(()=>[C(u,null,{default:k(()=>[C(S(n))]),_:1}),l[22]||(l[22]=q(" 恢复默认 "))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),H.enabled?(B(),M(le,{key:0,class:"usage-card"},{header:k(()=>l[23]||(l[23]=[P("div",{class:"card-header"},[P("h3",null,"WebDAV使用说明")],-1)])),default:k(()=>[P("div",F,[C(ae,{title:"WebDAV访问地址",type:"info",closable:!1,"show-icon":""},{default:k(()=>[P("div",$,[P("code",null,R(Q.value),1),C(Z,{size:"small",type:"primary",link:"",onClick:X},{default:k(()=>[C(u,null,{default:k(()=>[C(S(r))]),_:1}),l[24]||(l[24]=q(" 复制 "))]),_:1})])]),_:1}),l[25]||(l[25]=P("div",{class:"usage-steps"},[P("h4",null,"使用步骤："),P("ol",null,[P("li",null,"在支持WebDAV的客户端中添加网络位置"),P("li",null,"输入上述WebDAV访问地址"),P("li",null,"使用您的用户名和密码进行认证"),P("li",null,"即可像本地文件夹一样操作远程文件")])],-1)),l[26]||(l[26]=P("div",{class:"client-recommendations"},[P("h4",null,"推荐客户端："),P("ul",null,[P("li",null,[P("strong",null,"Windows:"),q(" 文件资源管理器、WinSCP")]),P("li",null,[P("strong",null,"macOS:"),q(" Finder、Cyberduck")]),P("li",null,[P("strong",null,"Linux:"),q(" Nautilus、Dolphin")]),P("li",null,[P("strong",null,"移动端:"),q(" ES文件浏览器、FE文件管理器")])])],-1))])]),_:1})):z("",!0)])}}}),[["__scopeId","data-v-a10f13cb"]]);export{E as default};
