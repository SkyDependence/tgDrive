import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                *//* empty css                 *//* empty css                     *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css                  */import{i as a,aF as l,a as o,y as t,U as s,A as d,d as n,e as r,aG as u,aH as c,aI as i,f as m,B as p,aJ as g,z as f,aK as b}from"./element-plus-Kv_AC7qh.js";import{s as y}from"./request-DEbmt4v_.js";import{d as h,b as v,W as _,f as k,c as V,Q as w,I as x,o as U,a as j,H as S,u as O,O as I,S as B,P as E}from"./vue-vendor-uyOI1CZy.js";import"./vendor-DlW7-jsh.js";const z={class:"misc-settings-container"},C={class:"background-settings"},P={class:"upload-section"},G=["src"],T={class:"opacity-value"},q={class:"seo-settings"},A=e(h({__name:"MiscSettingsPage",setup(e){const h=v("background"),A=v(!1),M=_({enabled:!1,imageUrl:"",mode:"cover",opacity:80}),R=_({title:"",description:"",keywords:"",author:"",favicon:"",ogImage:""}),W={Authorization:`Bearer ${localStorage.getItem("token")}`},$=e=>{const a=e.type.startsWith("image/"),l=e.size/1024/1024<5;return a?!!l||(o.error("图片大小不能超过 5MB!"),!1):(o.error("只能上传图片文件!"),!1)},H=e=>{e.success?(M.imageUrl=e.data.url,o.success("背景图片上传成功")):o.error(e.message||"上传失败")},J=async()=>{A.value=!0;try{const e=await y.post("/api/misc/background",M);e.data.success?(o.success("背景设置保存成功"),K()):o.error(e.data.message||"保存失败")}catch(e){o.error("保存失败")}finally{A.value=!1}},L=async()=>{A.value=!0;try{const e=await y.post("/api/misc/seo",R);e.data.success?o.success("SEO设置保存成功"):o.error(e.data.message||"保存失败")}catch(e){o.error("保存失败")}finally{A.value=!1}},N=()=>{t.confirm("确定要重置背景设置吗？","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{M.enabled=!1,M.imageUrl="",M.mode="cover",M.opacity=80,o.success("背景设置已重置")})},F=()=>{t.confirm("确定要重置SEO设置吗？","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{R.title="",R.description="",R.keywords="",R.author="",R.favicon="",R.ogImage="",o.success("SEO设置已重置")})},K=()=>{const e=document.body;if(M.enabled&&M.imageUrl){e.style.backgroundImage=`url(${M.imageUrl})`,e.style.backgroundSize=M.mode,e.style.backgroundRepeat="repeat"===M.mode?"repeat":"no-repeat",e.style.backgroundPosition="center",e.style.backgroundAttachment="fixed"===M.mode?"fixed":"scroll";const a=document.querySelector(".background-overlay");if(a)a.style.opacity=""+(100-M.opacity)/100;else{const a=document.createElement("div");a.className="background-overlay",a.style.cssText=`\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: var(--el-bg-color);\n        opacity: ${(100-M.opacity)/100};\n        pointer-events: none;\n        z-index: -1;\n      `,e.appendChild(a)}}else{e.style.backgroundImage="";const a=document.querySelector(".background-overlay");a&&a.remove()}};return k(()=>{(async()=>{try{const e=await y.get("/api/misc/settings");if(e.data.success){const{background:a,seo:l}=e.data.data;a&&Object.assign(M,a),l&&Object.assign(R,l)}}catch(e){}})()}),(e,o)=>{const t=s,y=d,v=n,_=r,k=u,K=c,Q=i,D=m,X=p,Y=g,Z=f,ee=b,ae=a;return U(),V("div",z,[w(ae,{class:"settings-card"},{header:x(()=>o[10]||(o[10]=[j("div",{class:"card-header"},[j("h2",null,"杂项管理"),j("p",null,"管理网站背景图片和SEO设置")],-1)])),default:x(()=>[w(ee,{modelValue:h.value,"onUpdate:modelValue":o[9]||(o[9]=e=>h.value=e),class:"settings-tabs"},{default:x(()=>[w(Y,{label:"背景图片",name:"background"},{default:x(()=>[j("div",C,[w(X,{model:M,"label-width":"120px"},{default:x(()=>[w(y,{label:"启用背景图"},{default:x(()=>[w(t,{modelValue:M.enabled,"onUpdate:modelValue":o[0]||(o[0]=e=>M.enabled=e)},null,8,["modelValue"])]),_:1}),M.enabled?(U(),S(y,{key:0,label:"背景图片"},{default:x(()=>[j("div",P,[w(_,{class:"background-uploader",action:"/api/misc/upload-background",headers:W,"show-file-list":!1,"on-success":H,"before-upload":$,accept:"image/*"},{default:x(()=>[M.imageUrl?(U(),V("img",{key:0,src:M.imageUrl,class:"background-preview"},null,8,G)):(U(),S(v,{key:1,class:"background-uploader-icon"},{default:x(()=>[w(O(l))]),_:1}))]),_:1}),o[11]||(o[11]=j("div",{class:"upload-tips"},[j("p",null,"建议尺寸：1920x1080 或更高"),j("p",null,"支持格式：JPG、PNG、WebP"),j("p",null,"文件大小：不超过5MB")],-1))])]),_:1})):I("",!0),M.enabled?(U(),S(y,{key:1,label:"背景模式"},{default:x(()=>[w(K,{modelValue:M.mode,"onUpdate:modelValue":o[1]||(o[1]=e=>M.mode=e)},{default:x(()=>[w(k,{value:"cover"},{default:x(()=>o[12]||(o[12]=[B("覆盖")])),_:1}),w(k,{value:"contain"},{default:x(()=>o[13]||(o[13]=[B("包含")])),_:1}),w(k,{value:"repeat"},{default:x(()=>o[14]||(o[14]=[B("重复")])),_:1}),w(k,{value:"fixed"},{default:x(()=>o[15]||(o[15]=[B("固定")])),_:1})]),_:1},8,["modelValue"])]),_:1})):I("",!0),M.enabled?(U(),S(y,{key:2,label:"透明度"},{default:x(()=>[w(Q,{modelValue:M.opacity,"onUpdate:modelValue":o[2]||(o[2]=e=>M.opacity=e),min:10,max:100,step:5,"show-stops":""},null,8,["modelValue"]),j("span",T,E(M.opacity)+"%",1)]),_:1})):I("",!0),w(y,null,{default:x(()=>[w(D,{type:"primary",onClick:J,loading:A.value},{default:x(()=>o[16]||(o[16]=[B("保存背景设置")])),_:1},8,["loading"]),w(D,{onClick:N},{default:x(()=>o[17]||(o[17]=[B("重置")])),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),w(Y,{label:"SEO设置",name:"seo"},{default:x(()=>[j("div",q,[w(X,{model:R,"label-width":"120px"},{default:x(()=>[w(y,{label:"网站标题"},{default:x(()=>[w(Z,{modelValue:R.title,"onUpdate:modelValue":o[3]||(o[3]=e=>R.title=e),placeholder:"请输入网站标题",maxlength:"60","show-word-limit":""},null,8,["modelValue"])]),_:1}),w(y,{label:"网站描述"},{default:x(()=>[w(Z,{modelValue:R.description,"onUpdate:modelValue":o[4]||(o[4]=e=>R.description=e),type:"textarea",rows:3,placeholder:"请输入网站描述",maxlength:"160","show-word-limit":""},null,8,["modelValue"])]),_:1}),w(y,{label:"关键词"},{default:x(()=>[w(Z,{modelValue:R.keywords,"onUpdate:modelValue":o[5]||(o[5]=e=>R.keywords=e),type:"textarea",rows:2,placeholder:"请输入关键词，用英文逗号分隔",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),w(y,{label:"作者"},{default:x(()=>[w(Z,{modelValue:R.author,"onUpdate:modelValue":o[6]||(o[6]=e=>R.author=e),placeholder:"请输入作者信息",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),w(y,{label:"网站图标"},{default:x(()=>[w(Z,{modelValue:R.favicon,"onUpdate:modelValue":o[7]||(o[7]=e=>R.favicon=e),placeholder:"请输入网站图标URL"},null,8,["modelValue"])]),_:1}),w(y,{label:"OG图片"},{default:x(()=>[w(Z,{modelValue:R.ogImage,"onUpdate:modelValue":o[8]||(o[8]=e=>R.ogImage=e),placeholder:"请输入Open Graph图片URL"},null,8,["modelValue"])]),_:1}),w(y,null,{default:x(()=>[w(D,{type:"primary",onClick:L,loading:A.value},{default:x(()=>o[18]||(o[18]=[B("保存SEO设置")])),_:1},8,["loading"]),w(D,{onClick:F},{default:x(()=>o[19]||(o[19]=[B("重置")])),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}}),[["__scopeId","data-v-029bcdde"]]);export{A as default};
