import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                     *//* empty css                   *//* empty css                *//* empty css                    *//* empty css                 */import{d as a,r as s,f as l,c as r,a as o,P as t,H as u,ah as i,au as d,ac as n,o as m,u as p,R as c,O as g}from"./vue-vendor-B9yd_xiB.js";import{d as f,B as v,_,$ as b,w,a as y,z as h,A as j,Y as k,a0 as x,f as I,D as V}from"./element-plus-BpKNpHyv.js";import{s as S}from"./request-CJwrkdbI.js";import"./vendor-BoV0XpOF.js";const z={class:"login-page-container"},U={class:"login-card"},q={class:"login-header"},C=e(a({__name:"LoginPage",setup(e){const a=d(),C=s({username:"",password:""}),F=s(),P=s(!1),R=s(!1),T={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名长度至少为3个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6个字符",trigger:"blur"}]},A=()=>{var e;null==(e=F.value)||e.validate(async e=>{if(e){P.value=!0;try{const e=await S.post("/auth/login",{username:C.value.username,password:C.value.password});if(1===e.data.code){const s=e.data.data;localStorage.setItem("token",s.token),localStorage.setItem("role",s.role),localStorage.setItem("userId",s.UserId),R.value?localStorage.setItem("username",C.value.username):localStorage.removeItem("username"),y.success(e.data.msg||"登录成功"),a.push("/home")}else y.error(e.data.msg||"登录失败")}catch(s){y.error("登录失败，请检查网络或联系管理员")}finally{P.value=!1}}})};return l(()=>{const e=localStorage.getItem("username");e&&(C.value.username=e,R.value=!0)}),(e,a)=>{const s=f,l=h,d=j,y=k,S=x,B=I,D=V,G=n("router-link"),H=v;return m(),r("div",z,[o("div",U,[o("div",q,[t(s,{size:32,color:"var(--el-color-primary)"},{default:u(()=>[t(p(_))]),_:1}),a[3]||(a[3]=o("h2",{class:"login-title"},"欢迎回来",-1)),a[4]||(a[4]=o("p",{class:"login-subtitle"},"登录以继续使用 ST-TG网盘",-1))]),t(H,{model:C.value,rules:T,ref_key:"loginFormRef",ref:F,"label-position":"top",onKeyup:i(A,["enter"]),class:"login-form"},{default:u(()=>[t(d,{label:"用户名",prop:"username"},{default:u(()=>[t(l,{modelValue:C.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>C.value.username=e),placeholder:"请输入用户名或邮箱","prefix-icon":p(b),size:"large",clearable:"",autocomplete:"username"},null,8,["modelValue","prefix-icon"])]),_:1}),t(d,{label:"密码",prop:"password"},{default:u(()=>[t(l,{modelValue:C.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>C.value.password=e),type:"password",placeholder:"请输入密码","prefix-icon":p(w),size:"large","show-password":"",clearable:"",autocomplete:"current-password"},null,8,["modelValue","prefix-icon"])]),_:1}),t(d,{class:"form-options"},{default:u(()=>[t(y,{modelValue:R.value,"onUpdate:modelValue":a[2]||(a[2]=e=>R.value=e)},{default:u(()=>a[5]||(a[5]=[c("记住用户名")])),_:1},8,["modelValue"]),t(S,{type:"primary",class:"forgot-password"},{default:u(()=>a[6]||(a[6]=[c("忘记密码？")])),_:1})]),_:1}),t(d,null,{default:u(()=>[t(B,{type:"primary",onClick:A,loading:P.value,class:"login-button",size:"large",block:""},{default:u(()=>[c(g(P.value?"登录中...":"登 录"),1)]),_:1},8,["loading"])]),_:1}),t(D,{class:"divider"},{default:u(()=>a[7]||(a[7]=[o("span",{class:"divider-text"},"或",-1)])),_:1}),t(d,{class:"register-section"},{default:u(()=>[a[9]||(a[9]=o("p",{class:"register-text"},"还没有账户？",-1)),t(G,{to:"/register",class:"register-link"},{default:u(()=>[t(B,{type:"default",size:"large",block:""},{default:u(()=>a[8]||(a[8]=[c(" 立即注册 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])}}}),[["__scopeId","data-v-01cbcd06"]]);export{C as default};
