import{a as e}from"./vendor-CPGCUlN1.js";import{c as t}from"./user-CWlPWJjU.js";const r=new Map,o=e.create({baseURL:"/api",timeout:3e4});o.interceptors.request.use(e=>{const t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`);const o=`${e.method}_${e.url}_${JSON.stringify(e.data||{})}`;if(r.has(o)){const e=r.get(o);null==e||e.abort()}const s=new AbortController;return e.signal=s.signal,r.set(o,s),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>{const t=e.config,o=`${t.method}_${t.url}_${JSON.stringify(t.data||{})}`;return r.delete(o),e},e=>{if(e.config){const t=e.config,o=`${t.method}_${t.url}_${JSON.stringify(t.data||{})}`;r.delete(o)}return e.response&&401===e.response.status&&(t(),window.location.href="/login"),Promise.reject(e)});export{o as s};
