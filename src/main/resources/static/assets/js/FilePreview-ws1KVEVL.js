import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                   *//* empty css                     */import{I as l,N as a,aC as s,l as i,aD as o,d as t,aE as r,f as v,U as u,a as n}from"./element-plus-DGu32Jg7.js";import{H as p}from"./vendor-u6XoYjkS.js";import{d as c,j as d,r as f,w as m,G as w,H as g,o as y,a as h,P as x,u as I,R as _,c as k,O as j,K as b,I as M,M as B,n as F}from"./vue-vendor-B9yd_xiB.js";const N={class:"preview-container"},V={key:0,class:"image-preview"},C={key:1,class:"video-preview"},H=["src"],U={key:2,class:"audio-preview"},z={class:"audio-info"},L=["src"],P={key:3,class:"pdf-preview"},T=["src"],D=["href"],E={key:4,class:"text-preview"},G={class:"text-content"},K={key:5,class:"office-preview"},R={class:"office-viewer"},O=["src"],$={key:6,class:"code-preview"},q=["innerHTML"],A={key:7,class:"unsupported-preview"},J={class:"unsupported-content"},Q={key:8,"element-loading-text":"加载中...",class:"loading-overlay"},S={class:"dialog-footer"},W=e(c({__name:"FilePreview",props:{modelValue:{type:Boolean},fileInfo:{}},emits:["update:modelValue","download"],setup(e,{emit:c}){const W=e,X=c,Y=d({get:()=>W.modelValue,set:e=>X("update:modelValue",e)}),Z=f(!1),ee=f(""),le=f(""),ae=d(()=>{var e,l;return(null==(e=W.fileInfo)?void 0:e.fileName)&&(null==(l=W.fileInfo.fileName.split(".").pop())?void 0:l.toLowerCase())||""}),se=d(()=>["jpg","jpeg","png","gif","bmp","webp","svg"].includes(ae.value)),ie=d(()=>["mp4","avi","mov","wmv","flv","webm","mkv"].includes(ae.value)),oe=d(()=>["mp3","wav","flac","aac","ogg","m4a"].includes(ae.value)),te=d(()=>"pdf"===ae.value),re=d(()=>["txt","md","json","xml","csv","log"].includes(ae.value)),ve=d(()=>["doc","docx","xls","xlsx","ppt","pptx"].includes(ae.value)),ue=d(()=>["js","ts","vue","html","css","scss","less","java","py","cpp","c","go","rs","php","rb","swift","kt"].includes(ae.value)),ne=d(()=>{var e;return(null==(e=W.fileInfo)?void 0:e.downloadUrl)||""}),pe=()=>({js:"javascript",ts:"typescript",vue:"vue",html:"html",css:"css",scss:"scss",less:"less",java:"java",py:"python",cpp:"cpp",c:"c",go:"go",rs:"rust",php:"php",rb:"ruby",swift:"swift",kt:"kotlin"}[ae.value]||"plaintext"),ce=e=>{const l="string"==typeof e?parseInt(e):e;if(0===l)return"0 B";const a=Math.floor(Math.log(l)/Math.log(1024));return parseFloat((l/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB","TB"][a]},de=async()=>{if(W.fileInfo&&(re.value||ue.value)){Z.value=!0;try{const e=await fetch(ne.value),l=await e.text();if(ue.value){const e=p.highlight(l,{language:pe()});le.value=e.value}else ee.value=l}catch(e){n.error("加载文件内容失败")}finally{Z.value=!1}}},fe=()=>{W.fileInfo&&X("download",W.fileInfo)},me=()=>{Y.value=!1,ee.value="",le.value=""};return m(()=>W.fileInfo,async e=>{e&&Y.value&&(await F(),(re.value||ue.value)&&de())},{immediate:!0}),m(Y,async e=>{e&&W.fileInfo&&(await F(),(re.value||ue.value)&&de())}),(e,n)=>{var p;const c=o,d=t,f=r,m=v,F=l,W=u;return y(),w(F,{modelValue:Y.value,"onUpdate:modelValue":n[0]||(n[0]=e=>Y.value=e),title:(null==(p=e.fileInfo)?void 0:p.fileName)||"文件预览",width:"80%","before-close":me,class:"file-preview-dialog"},{footer:g(()=>[h("div",S,[x(m,{onClick:fe},{default:g(()=>[x(d,null,{default:g(()=>[x(I(a))]),_:1}),n[4]||(n[4]=_(" 下载 "))]),_:1}),x(m,{type:"primary",onClick:me},{default:g(()=>n[5]||(n[5]=[_("关闭")])),_:1})])]),default:g(()=>{var l,o,t,r;return[h("div",N,[se.value?(y(),k("div",V,[x(c,{src:ne.value,alt:null==(l=e.fileInfo)?void 0:l.fileName,fit:"contain",class:"preview-image","preview-src-list":[ne.value],"initial-index":0,"preview-teleported":""},null,8,["src","alt","preview-src-list"])])):ie.value?(y(),k("div",C,[h("video",{src:ne.value,controls:"",class:"preview-video",preload:"metadata"}," 您的浏览器不支持视频播放 ",8,H)])):oe.value?(y(),k("div",U,[h("div",z,[x(d,{size:"48",color:"#409EFF"},{default:g(()=>[x(I(s))]),_:1}),h("h3",null,j(null==(o=e.fileInfo)?void 0:o.fileName),1)]),h("audio",{src:ne.value,controls:"",class:"preview-audio",preload:"metadata"}," 您的浏览器不支持音频播放 ",8,L)])):te.value?(y(),k("div",P,[h("iframe",{src:ne.value,class:"preview-iframe",frameborder:"0"},[n[1]||(n[1]=_(" 您的浏览器不支持PDF预览，请")),h("a",{href:ne.value,target:"_blank"},"点击下载",8,D)],8,T)])):re.value?(y(),k("div",E,[x(f,{height:"500px"},{default:g(()=>[h("pre",G,j(ee.value),1)]),_:1})])):ve.value?(y(),k("div",K,[h("div",R,[h("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(ne.value)}`,class:"preview-iframe",frameborder:"0"}," 文档预览加载中... ",8,O)])])):ue.value?(y(),k("div",$,[x(f,{height:"500px"},{default:g(()=>[h("pre",null,[h("code",{class:b(pe()),innerHTML:le.value},null,10,q)])]),_:1})])):(y(),k("div",A,[h("div",J,[x(d,{size:"64",color:"#909399"},{default:g(()=>[x(I(i))]),_:1}),n[3]||(n[3]=h("h3",null,"暂不支持此文件类型的预览",-1)),h("p",null,"文件名: "+j(null==(t=e.fileInfo)?void 0:t.fileName),1),h("p",null,"文件大小: "+j(ce(null==(r=e.fileInfo)?void 0:r.size)),1),x(m,{type:"primary",onClick:fe},{default:g(()=>[x(d,null,{default:g(()=>[x(I(a))]),_:1}),n[2]||(n[2]=_(" 下载文件 "))]),_:1})])])),Z.value?M((y(),k("div",Q,null,512)),[[W,Z.value]]):B("",!0)])]}),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-0f36186f"]]);export{W as F};
