import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                 *//* empty css                *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                   */import{e as l,c as a,q as t,B as o,h as d,z as s,r as i,aG as n,_ as r,A as u,H as c,aH as p,s as m,i as b,a5 as f,X as v,aI as _,aJ as w,aD as V,G as g}from"./element-plus-CYTMbAJU.js";import{a as y}from"./vendor-B84xEdly.js";import{d as h,r as x,V as D,b as A,l as C,c as W,M as j,D as k,H as M,E as U,o as q,J as R,u as B,a as T,K as E}from"./vue-vendor-BnwFTR-N.js";const F={class:"webdav-config-container"},S={class:"button-group"},G={class:"usage-content"},H={class:"webdav-url"},z=e(h({__name:"WebDavConfigPage",setup(e){const h=x(),z=x(!1),I=x(!1),J=D({enabled:!0,requireAuth:!0,allowedRoles:"admin",allowMkdir:!0,allowDelete:!0,allowMove:!0,allowCopy:!0,description:"WebDAV服务配置"}),O={allowedRoles:[{required:!0,message:"请选择允许的角色",trigger:"change"}]},P=A(()=>`${window.location.protocol}//${window.location.host}/webdav`),$=async()=>{try{const e=await y.get("/api/webdav-config");1===e.data.code?Object.assign(J,e.data.data):a.error(e.data.msg||"加载配置失败")}catch(e){a.error("加载配置失败")}},K=async()=>{if(h.value)try{await h.value.validate(),z.value=!0;const e=await y.put("/api/webdav-config",J);1===e.data.code?a.success("配置保存成功"):a.error(e.data.msg||"配置保存失败")}catch(e){a.error("配置保存失败")}finally{z.value=!1}},L=()=>{h.value&&(h.value.resetFields(),$())},N=async()=>{try{await g.confirm("确定要恢复默认配置吗？这将覆盖当前所有设置。","确认恢复默认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),I.value=!0;const e=await y.post("/api/webdav-config/reset");1===e.data.code?(a.success("已恢复默认配置"),await $()):a.error(e.data.msg||"恢复默认配置失败")}catch(e){"cancel"!==e&&a.error("恢复默认配置失败")}finally{I.value=!1}},X=e=>{e||g.confirm("禁用WebDAV服务后，所有WebDAV客户端将无法访问。确定要禁用吗？","确认禁用",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>{J.enabled=!0})},Q=async()=>{const e=P.value,l="WebDAV地址已复制到剪贴板";if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(e),a.success(l)}catch(t){Y(e,l)}else Y(e,l)},Y=(e,l)=>{const t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")?a.success(l):a.error("复制失败，请手动复制")}catch(o){a.error("复制失败，请手动复制")}document.body.removeChild(t)};return C(()=>{$()}),(e,a)=>{const g=d,y=o,x=n,D=i,A=c,C=u,$=m,Y=b,Z=t,ee=l,le=V;return q(),W("div",F,[j(ee,{class:"config-card"},{header:U(()=>a[8]||(a[8]=[T("div",{class:"card-header"},[T("h2",null,"WebDAV配置"),T("p",{class:"subtitle"},"配置WebDAV服务的访问权限和功能设置")],-1)])),default:U(()=>[j(Z,{ref_key:"configFormRef",ref:h,model:J,rules:O,"label-width":"140px",class:"config-form"},{default:U(()=>[j(y,{"content-position":"left"},{default:U(()=>[j(g,null,{default:U(()=>[j(B(s))]),_:1}),a[9]||(a[9]=R(" 基础设置 ",-1))]),_:1,__:[9]}),j(D,{label:"启用WebDAV",prop:"enabled"},{default:U(()=>[j(x,{modelValue:J.enabled,"onUpdate:modelValue":a[0]||(a[0]=e=>J.enabled=e),"active-text":"启用","inactive-text":"禁用",onChange:X},null,8,["modelValue"]),a[10]||(a[10]=T("div",{class:"form-tip"},"启用后可通过WebDAV协议访问文件",-1))]),_:1,__:[10]}),j(D,{label:"需要认证",prop:"requireAuth"},{default:U(()=>[j(x,{modelValue:J.requireAuth,"onUpdate:modelValue":a[1]||(a[1]=e=>J.requireAuth=e),"active-text":"需要","inactive-text":"不需要",disabled:!J.enabled},null,8,["modelValue","disabled"]),a[11]||(a[11]=T("div",{class:"form-tip"},"是否需要用户名密码认证（正在施工中...）",-1))]),_:1,__:[11]}),j(y,{"content-position":"left"},{default:U(()=>[j(g,null,{default:U(()=>[j(B(r))]),_:1}),a[12]||(a[12]=R(" 权限设置 ",-1))]),_:1,__:[12]}),j(D,{label:"允许的角色",prop:"allowedRoles"},{default:U(()=>[j(C,{modelValue:J.allowedRoles,"onUpdate:modelValue":a[2]||(a[2]=e=>J.allowedRoles=e),placeholder:"请选择允许访问的用户角色",disabled:!J.enabled},{default:U(()=>[j(A,{label:"仅管理员",value:"admin"}),j(A,{label:"访客用户",value:"visitor"})]),_:1},8,["modelValue","disabled"]),a[13]||(a[13]=T("div",{class:"form-tip"},"设置哪些角色的用户可以访问WebDAV",-1))]),_:1,__:[13]}),j(y,{"content-position":"left"},{default:U(()=>[j(g,null,{default:U(()=>[j(B(p))]),_:1}),a[14]||(a[14]=R(" 功能设置 ",-1))]),_:1,__:[14]}),j(D,{label:"允许创建目录",prop:"allowMkdir"},{default:U(()=>[j(x,{modelValue:J.allowMkdir,"onUpdate:modelValue":a[3]||(a[3]=e=>J.allowMkdir=e),"active-text":"允许","inactive-text":"禁止",disabled:!J.enabled},null,8,["modelValue","disabled"]),a[15]||(a[15]=T("div",{class:"form-tip"},"（正在施工中...）",-1))]),_:1,__:[15]}),j(D,{label:"允许删除文件",prop:"allowDelete"},{default:U(()=>[j(x,{modelValue:J.allowDelete,"onUpdate:modelValue":a[4]||(a[4]=e=>J.allowDelete=e),"active-text":"允许","inactive-text":"禁止",disabled:!J.enabled},null,8,["modelValue","disabled"]),a[16]||(a[16]=T("div",{class:"form-tip"},"（正在施工中...）",-1))]),_:1,__:[16]}),j(D,{label:"允许移动文件",prop:"allowMove"},{default:U(()=>[j(x,{modelValue:J.allowMove,"onUpdate:modelValue":a[5]||(a[5]=e=>J.allowMove=e),"active-text":"允许","inactive-text":"禁止",disabled:!J.enabled},null,8,["modelValue","disabled"]),a[17]||(a[17]=T("div",{class:"form-tip"},"（正在施工中...）",-1))]),_:1,__:[17]}),j(D,{label:"允许复制文件",prop:"allowCopy"},{default:U(()=>[j(x,{modelValue:J.allowCopy,"onUpdate:modelValue":a[6]||(a[6]=e=>J.allowCopy=e),"active-text":"允许","inactive-text":"禁止",disabled:!J.enabled},null,8,["modelValue","disabled"]),a[18]||(a[18]=T("div",{class:"form-tip"},"（正在施工中...）",-1))]),_:1,__:[18]}),j(D,{label:"配置描述",prop:"description"},{default:U(()=>[j($,{modelValue:J.description,"onUpdate:modelValue":a[7]||(a[7]=e=>J.description=e),type:"textarea",rows:3,placeholder:"请输入配置描述",disabled:!J.enabled},null,8,["modelValue","disabled"])]),_:1}),j(D,null,{default:U(()=>[T("div",S,[j(Y,{type:"primary",onClick:K,loading:z.value},{default:U(()=>[j(g,null,{default:U(()=>[j(B(f))]),_:1}),a[19]||(a[19]=R(" 保存配置 ",-1))]),_:1,__:[19]},8,["loading"]),j(Y,{onClick:L},{default:U(()=>[j(g,null,{default:U(()=>[j(B(v))]),_:1}),a[20]||(a[20]=R(" 重置 ",-1))]),_:1,__:[20]}),j(Y,{onClick:N,loading:I.value},{default:U(()=>[j(g,null,{default:U(()=>[j(B(_))]),_:1}),a[21]||(a[21]=R(" 恢复默认 ",-1))]),_:1,__:[21]},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1}),J.enabled?(q(),k(ee,{key:0,class:"usage-card"},{header:U(()=>a[22]||(a[22]=[T("div",{class:"card-header"},[T("h3",null,"WebDAV使用说明")],-1)])),default:U(()=>[T("div",G,[j(le,{title:"WebDAV访问地址",type:"info",closable:!1,"show-icon":""},{default:U(()=>[T("div",H,[T("code",null,E(P.value),1),j(Y,{size:"small",type:"primary",link:"",onClick:Q},{default:U(()=>[j(g,null,{default:U(()=>[j(B(w))]),_:1}),a[23]||(a[23]=R(" 复制 ",-1))]),_:1,__:[23]})])]),_:1}),a[24]||(a[24]=T("div",{class:"usage-steps"},[T("h4",null,"使用步骤："),T("ol",null,[T("li",null,"在支持WebDAV的客户端中添加网络位置"),T("li",null,"输入上述WebDAV访问地址"),T("li",null,"使用您的用户名和密码进行认证"),T("li",null,"即可像本地文件夹一样操作远程文件")])],-1)),a[25]||(a[25]=T("div",{class:"client-recommendations"},[T("h4",null,"推荐客户端："),T("ul",null,[T("li",null,[T("strong",null,"Windows:"),R(" 文件资源管理器、WinSCP")]),T("li",null,[T("strong",null,"macOS:"),R(" Finder、Cyberduck")]),T("li",null,[T("strong",null,"Linux:"),R(" Nautilus、Dolphin")]),T("li",null,[T("strong",null,"移动端:"),R(" ES文件浏览器、FE文件管理器")])])],-1))])]),_:1})):M("",!0)])}}}),[["__scopeId","data-v-8fea4ece"]]);export{z as default};
