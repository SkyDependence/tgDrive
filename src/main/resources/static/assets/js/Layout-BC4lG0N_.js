import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                         *//* empty css                        *//* empty css                  *//* empty css                     */import{d as a,r as o,b as s,av as t,l,U as n,D as r,E as c,o as u,M as d,a as i,u as m,c as p,H as _,I as f,J as v,K as g,ab as h,T as k}from"./vue-vendor-CxLOoai_.js";import{ae as y,af as w,ag as b,ah as x,f as C,Z as j,ai as I,aj as L,ak as E,h as S,al as T,am as B,i as M,y as U,an as q,ao as z,ap as D,aq as G,G as R,b as H}from"./element-plus-DQjCWvVU.js";import{u as J}from"./user-CWlPWJjU.js";import"./index-CLLrkTrC.js";const K={class:"header-content"},P={class:"logo"},Z={class:"actions"},A={class:"el-dropdown-link",style:{outline:"none",cursor:"pointer"}},F={key:0,class:"user-nav-desktop"},N={class:"user-info"},O={class:"user-details"},Q={class:"username"},V={class:"user-role"},W={class:"dropdown-user-info"},X={class:"dropdown-username"},Y={class:"dropdown-email"},$=e(a({__name:"Layout",setup(e){const a=t(),$=o("auto"),ee=J(),ae=s(()=>ee.isLoggedIn),oe=s(()=>ee.role),se=s(()=>ee.username||"用户"),te=s(()=>ee.email||""),le=s(()=>ee.userRoleText);s(()=>a.currentRoute.value.path);const ne=s(()=>"light"===$.value?y:"dark"===$.value?w:b),re=()=>{if("auto"===$.value){const e=window.matchMedia("(prefers-color-scheme: dark)");document.documentElement.classList.toggle("dark",e.matches)}else document.documentElement.classList.toggle("dark","dark"===$.value)},ce=e=>{$.value=e,localStorage.setItem("theme",e),re()},ue=e=>{"auto"===$.value&&document.documentElement.classList.toggle("dark",e.matches)};l(()=>{ee.initUserInfo();const e=localStorage.getItem("theme");$.value=e||"auto",re(),(()=>{const e=document.body;e.style.backgroundImage="",e.style.backgroundColor="#ffffff";const a=document.querySelector(".background-overlay");a&&a.remove()})(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",ue)}),n(()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",ue)});const de=()=>{a.push("/login")},ie=()=>{a.push("/about")},me=()=>{const e=localStorage.getItem("token"),o=localStorage.getItem("role");e&&"visitor"!==o?a.push("/home"):R.alert("您当前是访客，请使用管理员账号登录！","权限提示",{confirmButtonText:"确定",type:"warning"})},pe=e=>{"logout"===e&&he()},_e=()=>{a.push("/user/home")},fe=()=>{a.push("/user/upload")},ve=()=>{a.push("/user/changePassword")},ge=e=>{switch(e){case"home":_e();break;case"upload":fe();break;case"password":ve()}},he=()=>{R.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ee.clearUserInfo(),H.success("已退出登录"),a.push("/login")}).catch(()=>{})};return(e,a)=>{const o=C,s=E,t=L,l=I,n=S,R=q,H=D,J=h("router-view"),$=G,ee=x;return u(),r(ee,{class:"layout-container"},{default:c(()=>[d(H,{class:"header"},{default:c(()=>[i("div",K,[i("div",P,[d(o,{class:"logo-icon"},{default:c(()=>[d(m(j))]),_:1}),a[0]||(a[0]=i("div",{class:"logo-text"},[i("span",{class:"main-title"},"TG-Drive"),i("span",{class:"sub-title"},"Stanley_Legend")],-1))]),i("div",Z,[d(l,{onCommand:ce,trigger:"click"},{dropdown:c(()=>[d(t,null,{default:c(()=>[d(s,{command:"light",icon:m(y)},{default:c(()=>a[1]||(a[1]=[v("亮色模式")])),_:1,__:[1]},8,["icon"]),d(s,{command:"dark",icon:m(w)},{default:c(()=>a[2]||(a[2]=[v("暗色模式")])),_:1,__:[2]},8,["icon"]),d(s,{command:"auto",icon:m(b)},{default:c(()=>a[3]||(a[3]=[v("跟随系统")])),_:1,__:[3]},8,["icon"])]),_:1})]),default:c(()=>[i("span",A,[d(o,{size:20},{default:c(()=>[(u(),r(f(ne.value)))]),_:1})])]),_:1}),ae.value&&"user"===oe.value?(u(),p("div",F,[d(n,{type:"text",onClick:_e},{default:c(()=>a[4]||(a[4]=[v("我的文件")])),_:1,__:[4]}),d(n,{type:"text",onClick:fe},{default:c(()=>a[5]||(a[5]=[v("上传文件")])),_:1,__:[5]}),d(n,{type:"text",onClick:ve},{default:c(()=>a[6]||(a[6]=[v("修改密码")])),_:1,__:[6]})])):_("",!0),ae.value&&"user"===oe.value?(u(),r(l,{key:1,class:"user-nav-mobile",onCommand:ge,trigger:"click"},{dropdown:c(()=>[d(t,null,{default:c(()=>[d(s,{command:"home",icon:m(B)},{default:c(()=>a[8]||(a[8]=[v("我的文件")])),_:1,__:[8]},8,["icon"]),d(s,{command:"upload",icon:m(M)},{default:c(()=>a[9]||(a[9]=[v("上传文件")])),_:1,__:[9]},8,["icon"]),d(s,{command:"password",icon:m(U)},{default:c(()=>a[10]||(a[10]=[v("修改密码")])),_:1,__:[10]},8,["icon"])]),_:1})]),default:c(()=>[d(n,{type:"text",icon:m(T)},{default:c(()=>a[7]||(a[7]=[v(" 菜单 ")])),_:1,__:[7]},8,["icon"])]),_:1})):_("",!0),d(n,{type:"info",plain:"",onClick:ie},{default:c(()=>a[11]||(a[11]=[v("关于")])),_:1,__:[11]}),"admin"===oe.value?(u(),r(n,{key:2,type:"primary",plain:"",onClick:me},{default:c(()=>a[12]||(a[12]=[v("管理")])),_:1,__:[12]})):_("",!0),ae.value?(u(),r(l,{key:4,onCommand:pe,trigger:"click"},{dropdown:c(()=>[d(t,null,{default:c(()=>[d(s,{disabled:""},{default:c(()=>[i("div",W,[i("div",X,g(se.value),1),i("div",Y,g(te.value),1)])]),_:1}),d(s,{divided:"",command:"logout",icon:m(z)},{default:c(()=>a[14]||(a[14]=[v("退出登录")])),_:1,__:[14]},8,["icon"])]),_:1})]),default:c(()=>[i("div",N,[d(R,{size:32,src:"/110871356.jpg",style:{cursor:"pointer"}}),i("div",O,[i("div",Q,g(se.value),1),i("div",V,g(le.value),1)])])]),_:1})):(u(),r(n,{key:3,type:"primary",onClick:de},{default:c(()=>a[13]||(a[13]=[v("登录")])),_:1,__:[13]}))])])]),_:1}),d($,{class:"main-content"},{default:c(()=>[d(J,null,{default:c(({Component:e})=>[d(k,{name:"fade",mode:"out-in"},{default:c(()=>[(u(),r(f(e)))]),_:2},1024)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-477ea744"]]);export{$ as default};
