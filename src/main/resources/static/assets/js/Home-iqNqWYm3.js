import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";import"./el-collapse-transition-l0sNRNKZ.js";/* empty css                             *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                *//* empty css                     *//* empty css               *//* empty css                 */import{t as a,r as l,V as s,f as r,v as t,M as o,E as u,R as d,u as n,A as i,J as c,K as p,L as m,a9 as f,H as g,x as v,D as _}from"./vue-vendor-BNZdp1ez.js";import{s as x}from"./index-DrHwzDkJ.js";import{e as y,E as b,q as h,c as V,d as k,r as j,s as w,m as z,w as C,x as U,o as B,y as T,i as D,h as q,z as I,A,k as F,B as R,C as H,D as L,F as $,G as E,H as G}from"./element-plus-CgPdM7LF.js";import"./vendor-JtNx7una.js";const J={class:"page-container"},K={class:"card-header"},M={class:"form-button-group"},S={class:"card-header"},N={class:"load-config-wrapper"},O={class:"config-button-group"},P={key:0,class:"config-preview"},Q=e(a({__name:"Home",setup(e){const a=l(),Q=s({name:"",token:"",target:"",url:"",pass:""}),W=l(!1),X=l(!1),Y=l(!1),Z=l(!1),ee=l([]),ae=l(""),le=l(null),se=s({name:[{required:!0,message:"请输入配置名称",trigger:"blur"}],token:[{required:!0,message:"请输入 Bot Token",trigger:"blur"}],target:[{required:!0,message:"请输入 Chat ID",trigger:"blur"}]}),re=async()=>{Y.value=!0;try{const e=await x.get("/config/configs");1===e.data.code&&Array.isArray(e.data.data)?ee.value=e.data.data:b.error("获取配置列表失败")}catch(e){b.error("获取配置列表失败，请检查网络")}finally{Y.value=!1}},te=e=>{le.value=ee.value.find(a=>a.name===e)||null},oe=async()=>{a.value&&await a.value.validate(async e=>{var l,s,r;if(e){W.value=!0;try{const e=await x.post("/config",Q);1===e.data.code?(b.success(e.data.msg||"配置提交成功"),null==(l=a.value)||l.resetFields(),re()):b.error(e.data.msg||"提交失败")}catch(t){b.error((null==(r=null==(s=t.response)?void 0:s.data)?void 0:r.msg)||"提交失败，请检查网络")}finally{W.value=!1}}})},ue=()=>{var e;null==(e=a.value)||e.resetFields()},de=async()=>{if(ae.value){X.value=!0;try{const e=await x.get(`/config/${ae.value}`);1===e.data.code?b.success(e.data.msg||"配置加载成功"):b.error(e.data.msg||"加载配置失败")}catch(e){b.error("加载失败，请检查网络")}finally{X.value=!1}}else b.warning("请先选择一个配置")},ne=async()=>{var e,a;if(ae.value){try{await E.confirm(`确定要删除配置 "${ae.value}" 吗？此操作不可撤销。`,"确认删除",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"})}catch{return}Z.value=!0;try{const e=await x.delete(`/config/${ae.value}`);1===e.data.code?(b.success(e.data.msg||"配置删除成功"),ae.value="",le.value=null,re()):b.error(e.data.msg||"删除配置失败")}catch(l){b.error((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.msg)||"删除失败，请检查网络")}finally{Z.value=!1}}else b.warning("请先选择一个配置")};return r(()=>{re()}),(e,l)=>{const s=q,r=w,x=j,b=k,E=V,re=D,ie=h,ce=y,pe=G,me=A,fe=R,ge=L,ve=H,_e=F;return v(),t("div",J,[o(ce,{class:"content-card"},{header:u(()=>[i("div",K,[o(s,null,{default:u(()=>[o(n(I))]),_:1}),l[6]||(l[6]=i("span",null,"Bot 配置",-1))])]),default:u(()=>[o(ie,{ref_key:"ruleFormRef",ref:a,model:Q,rules:se,"label-position":"top",class:"config-form",onSubmit:d(oe,["prevent"])},{default:u(()=>[o(E,{gutter:20},{default:u(()=>[o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"配置名称",prop:"name"},{default:u(()=>[o(r,{modelValue:Q.name,"onUpdate:modelValue":l[0]||(l[0]=e=>Q.name=e),placeholder:"为您的配置命名","prefix-icon":n(z),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"Chat ID",prop:"target"},{default:u(()=>[o(r,{modelValue:Q.target,"onUpdate:modelValue":l[1]||(l[1]=e=>Q.target=e),placeholder:"请输入接收文件的频道/用户 ID","prefix-icon":n(C),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:24,lg:24,xl:24},{default:u(()=>[o(x,{label:"Bot Token",prop:"token"},{default:u(()=>[o(r,{modelValue:Q.token,"onUpdate:modelValue":l[2]||(l[2]=e=>Q.token=e),placeholder:"请输入 Telegram Bot Token","prefix-icon":n(U),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"自定义 URL (选填)",prop:"url"},{default:u(()=>[o(r,{modelValue:Q.url,"onUpdate:modelValue":l[3]||(l[3]=e=>Q.url=e),placeholder:"用于生成下载链接的域名","prefix-icon":n(B),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"访问密码 (选填)",prop:"pass"},{default:u(()=>[o(r,{modelValue:Q.pass,"onUpdate:modelValue":l[4]||(l[4]=e=>Q.pass=e),type:"password",placeholder:"为配置设置访问密码","show-password":"","prefix-icon":n(T),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1})]),_:1}),o(x,{class:"form-actions"},{default:u(()=>[i("div",M,[o(re,{type:"primary","native-type":"submit",loading:W.value,size:"large"},{default:u(()=>[c(p(W.value?"提交中...":"保存并提交"),1)]),_:1},8,["loading"]),o(re,{onClick:ue,size:"large"},{default:u(()=>l[7]||(l[7]=[c("重置表单",-1)])),_:1,__:[7]})])]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(ce,{class:"content-card"},{header:u(()=>[i("div",S,[o(s,null,{default:u(()=>[o(n($))]),_:1}),l[8]||(l[8]=i("span",null,"加载现有配置",-1))])]),default:u(()=>[i("div",N,[o(me,{modelValue:ae.value,"onUpdate:modelValue":l[5]||(l[5]=e=>ae.value=e),placeholder:"请选择一个配置文件进行加载",class:"config-select",size:"large",loading:Y.value,onChange:te,filterable:""},{default:u(()=>[(v(!0),t(m,null,f(ee.value,e=>(v(),_(pe,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),i("div",O,[o(re,{type:"success",onClick:de,loading:X.value,disabled:!ae.value,size:"large",plain:""},{default:u(()=>l[9]||(l[9]=[c(" 加载选中配置 ",-1)])),_:1,__:[9]},8,["loading","disabled"]),o(re,{type:"danger",onClick:ne,loading:Z.value,disabled:!ae.value,size:"large",plain:""},{default:u(()=>l[10]||(l[10]=[c(" 删除配置 ",-1)])),_:1,__:[10]},8,["loading","disabled"])])]),o(_e,null,{default:u(()=>[le.value?(v(),t("div",P,[o(fe),l[11]||(l[11]=i("h3",null,"配置预览",-1)),o(ve,{column:1,border:"",size:"small"},{default:u(()=>[o(ge,{label:"名称"},{default:u(()=>[c(p(le.value.name),1)]),_:1}),o(ge,{label:"Token"},{default:u(()=>[c(p(le.value.token),1)]),_:1}),o(ge,{label:"Chat ID"},{default:u(()=>[c(p(le.value.target),1)]),_:1}),o(ge,{label:"URL"},{default:u(()=>[c(p(le.value.url||"未设置"),1)]),_:1}),o(ge,{label:"密码"},{default:u(()=>[c(p(le.value.pass?"******":"未设置"),1)]),_:1})]),_:1})])):g("",!0)]),_:1})]),_:1})])}}}),[["__scopeId","data-v-ac58f282"]]);export{Q as default};
