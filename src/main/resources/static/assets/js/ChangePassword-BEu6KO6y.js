import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                *//* empty css                     *//* empty css                 */import{d as a,r as s,V as r,c as l,P as o,H as d,o as u,a as n,u as i,$ as t,R as p,O as m}from"./vue-vendor-B9yd_xiB.js";import{k as c,e as w,a3 as f,C as v,a8 as g,a as P,f as b,s as _,G as h,i as V,H as x}from"./element-plus-DF_olGcQ.js";import{s as y}from"./request-CHXRx1DF.js";import"./vendor-CVFNKsYv.js";const j={class:"page-container"},q={class:"card-header"},z=e(a({__name:"ChangePassword",setup(e){const a=s({username:"",oldPassword:"",newPassword:"",confirmPassword:""}),z=s(),k=s(!1),U=r({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:16,message:"密码长度应为 6 到 16 个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,s,r)=>{""===s?r(new Error("请再次输入新密码")):s!==a.value.newPassword?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]}),C=()=>{var e;null==(e=z.value)||e.validate(async e=>{var s;if(e){k.value=!0;try{const e=await y.post("/auth/change-password",{username:a.value.username,oldPassword:a.value.oldPassword,newPassword:a.value.newPassword});1===e.data.code?(P.success("密码修改成功"),null==(s=z.value)||s.resetFields()):P.error(e.data.msg||"密码修改失败")}catch(r){P.error("修改密码失败，请检查网络或联系管理员")}finally{k.value=!1}}})};return(e,s)=>{const r=b,P=_,y=h,E=V,F=x,H=c;return u(),l("div",j,[o(H,{class:"content-card"},{header:d(()=>[n("div",q,[o(r,null,{default:d(()=>[o(i(w))]),_:1}),s[4]||(s[4]=n("span",null,"修改密码",-1))])]),default:d(()=>[o(F,{model:a.value,rules:U,ref_key:"passwordFormRef",ref:z,"label-position":"top",onSubmit:t(C,["prevent"]),class:"password-form"},{default:d(()=>[o(y,{label:"用户名",prop:"username"},{default:d(()=>[o(P,{modelValue:a.value.username,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value.username=e),"prefix-icon":i(f),placeholder:"请输入您的用户名",size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(y,{label:"旧密码",prop:"oldPassword"},{default:d(()=>[o(P,{modelValue:a.value.oldPassword,"onUpdate:modelValue":s[1]||(s[1]=e=>a.value.oldPassword=e),"prefix-icon":i(v),type:"password",placeholder:"请输入您的当前密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(y,{label:"新密码",prop:"newPassword"},{default:d(()=>[o(P,{modelValue:a.value.newPassword,"onUpdate:modelValue":s[2]||(s[2]=e=>a.value.newPassword=e),"prefix-icon":i(v),type:"password",placeholder:"请输入 6-16 位的新密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(y,{label:"确认新密码",prop:"confirmPassword"},{default:d(()=>[o(P,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":s[3]||(s[3]=e=>a.value.confirmPassword=e),"prefix-icon":i(g),type:"password",placeholder:"请再次输入新密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(y,null,{default:d(()=>[o(E,{type:"primary",onClick:C,loading:k.value,class:"submit-button",size:"large",block:""},{default:d(()=>[p(m(k.value?"正在提交...":"确认修改"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}}),[["__scopeId","data-v-d5ec31db"]]);export{z as default};
