import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                   *//* empty css                   *//* empty css                *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                        *//* empty css               *//* empty css                 */import{d as l,j as a,r as i,w as o,G as t,H as s,o as n,a as u,P as r,u as c,R as d,c as v,O as p,K as f,I as m,M as g,n as y,f as w,y as h,Q as k,aa as _,ah as b,$ as C}from"./vue-vendor-B9yd_xiB.js";import{s as x}from"./request-CHXRx1DF.js";import{N as I,O as z,P as V,n as j,Q as U,f as $,R as B,i as T,S as N,a as L,k as M,T as R,U as F,V as P,W as S,v as D,X as E,q as H,d as K,F as q,s as G,l as O,M as Q,I as W,b as J,Y as X,Z as Y,w as Z,_ as A,$ as ee,J as le,a0 as ae,e as ie,m as oe,a1 as te}from"./element-plus-DF_olGcQ.js";import{H as se}from"./vendor-CVFNKsYv.js";const ne={class:"preview-container"},ue={key:0,class:"image-preview"},re={key:1,class:"video-preview"},ce=["src"],de={key:2,class:"audio-preview"},ve={class:"audio-info"},pe=["src"],fe={key:3,class:"pdf-preview"},me=["src"],ge=["href"],ye={key:4,class:"text-preview"},we={class:"text-content"},he={key:5,class:"office-preview"},ke={class:"office-viewer"},_e=["src"],be={key:6,class:"code-preview"},Ce=["innerHTML"],xe={key:7,class:"unsupported-preview"},Ie={class:"unsupported-content"},ze={key:8,"element-loading-text":"加载中...",class:"loading-overlay"},Ve={class:"dialog-footer"},je=e(l({__name:"FilePreview",props:{modelValue:{type:Boolean},fileInfo:{}},emits:["update:modelValue","download"],setup(e,{emit:l}){const w=e,h=l,k=a({get:()=>w.modelValue,set:e=>h("update:modelValue",e)}),_=i(!1),b=i(""),C=i(""),x=a(()=>{var e,l;return(null==(e=w.fileInfo)?void 0:e.fileName)&&(null==(l=w.fileInfo.fileName.split(".").pop())?void 0:l.toLowerCase())||""}),M=a(()=>["jpg","jpeg","png","gif","bmp","webp","svg"].includes(x.value)),R=a(()=>["mp4","avi","mov","wmv","flv","webm","mkv"].includes(x.value)),F=a(()=>["mp3","wav","flac","aac","ogg","m4a"].includes(x.value)),P=a(()=>"pdf"===x.value),S=a(()=>["txt","md","json","xml","csv","log"].includes(x.value)),D=a(()=>["doc","docx","xls","xlsx","ppt","pptx"].includes(x.value)),E=a(()=>["js","ts","vue","html","css","scss","less","java","py","cpp","c","go","rs","php","rb","swift","kt"].includes(x.value)),H=a(()=>{var e;return(null==(e=w.fileInfo)?void 0:e.downloadUrl)||""}),K=()=>({js:"javascript",ts:"typescript",vue:"vue",html:"html",css:"css",scss:"scss",less:"less",java:"java",py:"python",cpp:"cpp",c:"c",go:"go",rs:"rust",php:"php",rb:"ruby",swift:"swift",kt:"kotlin"}[x.value]||"plaintext"),q=e=>{const l="string"==typeof e?parseInt(e):e;if(0===l)return"0 B";const a=Math.floor(Math.log(l)/Math.log(1024));return parseFloat((l/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB","TB"][a]},G=async()=>{if(w.fileInfo&&(S.value||E.value)){_.value=!0;try{const e=await fetch(H.value),l=await e.text();if(E.value){const e=se.highlight(l,{language:K()});C.value=e.value}else b.value=l}catch(e){L.error("加载文件内容失败")}finally{_.value=!1}}},O=()=>{w.fileInfo&&h("download",w.fileInfo)},Q=()=>{k.value=!1,b.value="",C.value=""};return o(()=>w.fileInfo,async e=>{e&&k.value&&(await y(),(S.value||E.value)&&G())},{immediate:!0}),o(k,async e=>{e&&w.fileInfo&&(await y(),(S.value||E.value)&&G())}),(e,l)=>{var a;const i=U,o=$,y=B,w=T,h=I,x=N;return n(),t(h,{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=e=>k.value=e),title:(null==(a=e.fileInfo)?void 0:a.fileName)||"文件预览",width:"80%","before-close":Q,class:"file-preview-dialog"},{footer:s(()=>[u("div",Ve,[r(w,{onClick:O},{default:s(()=>[r(o,null,{default:s(()=>[r(c(z))]),_:1}),l[4]||(l[4]=d(" 下载 "))]),_:1}),r(w,{type:"primary",onClick:Q},{default:s(()=>l[5]||(l[5]=[d("关闭")])),_:1})])]),default:s(()=>{var a,t,h,k;return[u("div",ne,[M.value?(n(),v("div",ue,[r(i,{src:H.value,alt:null==(a=e.fileInfo)?void 0:a.fileName,fit:"contain",class:"preview-image","preview-src-list":[H.value],"initial-index":0,"preview-teleported":""},null,8,["src","alt","preview-src-list"])])):R.value?(n(),v("div",re,[u("video",{src:H.value,controls:"",class:"preview-video",preload:"metadata"}," 您的浏览器不支持视频播放 ",8,ce)])):F.value?(n(),v("div",de,[u("div",ve,[r(o,{size:"48",color:"#409EFF"},{default:s(()=>[r(c(V))]),_:1}),u("h3",null,p(null==(t=e.fileInfo)?void 0:t.fileName),1)]),u("audio",{src:H.value,controls:"",class:"preview-audio",preload:"metadata"}," 您的浏览器不支持音频播放 ",8,pe)])):P.value?(n(),v("div",fe,[u("iframe",{src:H.value,class:"preview-iframe",frameborder:"0"},[l[1]||(l[1]=d(" 您的浏览器不支持PDF预览，请")),u("a",{href:H.value,target:"_blank"},"点击下载",8,ge)],8,me)])):S.value?(n(),v("div",ye,[r(y,{height:"500px"},{default:s(()=>[u("pre",we,p(b.value),1)]),_:1})])):D.value?(n(),v("div",he,[u("div",ke,[u("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(H.value)}`,class:"preview-iframe",frameborder:"0"}," 文档预览加载中... ",8,_e)])])):E.value?(n(),v("div",be,[r(y,{height:"500px"},{default:s(()=>[u("pre",null,[u("code",{class:f(K()),innerHTML:C.value},null,10,Ce)])]),_:1})])):(n(),v("div",xe,[u("div",Ie,[r(o,{size:"64",color:"#909399"},{default:s(()=>[r(c(j))]),_:1}),l[3]||(l[3]=u("h3",null,"暂不支持此文件类型的预览",-1)),u("p",null,"文件名: "+p(null==(h=e.fileInfo)?void 0:h.fileName),1),u("p",null,"文件大小: "+p(q(null==(k=e.fileInfo)?void 0:k.size)),1),r(w,{type:"primary",onClick:O},{default:s(()=>[r(o,null,{default:s(()=>[r(c(z))]),_:1}),l[2]||(l[2]=d(" 下载文件 "))]),_:1})])])),_.value?m((n(),v("div",ze,null,512)),[[x,_.value]]):g("",!0)])]}),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-0f36186f"]]),Ue={class:"page-container"},$e={class:"card-header"},Be={class:"header-left"},Te={class:"header-right"},Ne={class:"search-filter-section"},Le={style:{display:"flex","align-items":"center",gap:"8px"}},Me={key:1,class:"text-gray-400"},Re={key:2},Fe=["onClick"],Pe={class:"file-info"},Se={class:"file-name-mobile"},De={class:"file-meta"},Ee={key:0,class:"file-category"},He={class:"file-actions"},Ke={class:"batch-actions"},qe={class:"dialog-footer"},Ge={class:"category-management"},Oe={class:"add-category"},Qe={class:"category-list"},We={class:"category-actions"},Je={key:0},Xe={class:"dialog-footer"},Ye=e(l({__name:"FileList",setup(e){const l=i([]),a=i(!1),o=i(1),y=i(10),V=i(0),U=i(!1),B=i([]),se=i(!1),ne=i(null),ue=i(!1),re=i(null),ce=i(""),de=i(""),ve=i(""),pe=i([]),fe=i(!1),me=i(""),ge=i(!1),ye=i(!1),we=i(null),he=i(""),ke=i(!1),_e=()=>{se.value=window.innerWidth<768},be=e=>B.value.some(l=>l.fileId===e.fileId),Ce=e=>{be(e)?B.value=B.value.filter(l=>l.fileId!==e.fileId):B.value.push(e)},xe=async()=>{var e,i;a.value=!0;try{let a=`/fileList?page=${o.value}&size=${y.value}`;ce.value&&(a+=`&search=${encodeURIComponent(ce.value)}`),de.value&&(a+=`&type=${de.value}`),ve.value&&(a+=`&categoryId=${ve.value}`);const t=await x.get(a);if(1===(null==(e=t.data)?void 0:e.code)){const e=t.data.data;l.value=e.records||[],V.value=e.total||0}else L.error((null==(i=t.data)?void 0:i.msg)||"获取文件列表失败")}catch(t){L.error("获取文件列表失败，请检查网络")}finally{a.value=!1}},Ie=e=>{B.value=e},ze=(e,l)=>{navigator.clipboard.writeText(e).then(()=>{L.success(l)}).catch(e=>{L.error("复制失败: "+e)})},Ve=()=>{const e=B.value.map(e=>`[${e.fileName}](${e.downloadUrl})`).join("\n");ze(e,`已批量复制 ${B.value.length} 个 Markdown 链接`)},Ye=()=>{const e=B.value.map(e=>e.downloadUrl).join("\n");ze(e,`已批量复制 ${B.value.length} 个下载链接`)},Ze=async()=>{var e,l;if(0!==B.value.length)try{await q.confirm(`确定要删除选中的 ${B.value.length} 个文件吗？此操作不可撤销。`,"批量删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"});const e=B.value.map(e=>x.delete(`/file/${e.fileId}`)),l=await Promise.allSettled(e);let a=0,i=0;l.forEach((e,l)=>{"fulfilled"===e.status&&1===e.value.data.code?a++:i++}),a>0&&L.success(`成功删除 ${a} 个文件`),i>0&&L.error(`${i} 个文件删除失败`),B.value=[],xe()}catch(a){"cancel"!==a&&L.error("批量删除失败: "+((null==(l=null==(e=a.response)?void 0:e.data)?void 0:l.msg)||a.message))}else L.warning("请先选择要删除的文件")},Ae=e=>new Date(1e3*e).toLocaleString("zh-CN",{hour12:!1}),el=()=>{U.value=!0},ll=async()=>{var e,l;U.value=!1;const a=L({message:"正在更新...",type:"info",duration:0});try{const a=await x.put("/file-url");1===(null==(e=a.data)?void 0:e.code)?(L.success("URL 更新成功"),xe()):L.error((null==(l=a.data)?void 0:l.msg)||"URL 更新失败")}catch(i){L.error("更新失败，请检查网络")}finally{a.close()}},al=e=>{o.value=e,B.value=[],xe(),se.value&&ne.value&&(ne.value.scrollTop=0)},il=e=>{y.value=e,o.value=1,B.value=[],xe()},ol=e=>{ze(`[${e.fileName}](${e.downloadUrl})`,"Markdown 格式已复制")},tl=e=>{ze(e.downloadUrl,"下载链接已复制")},sl=e=>{window.open(e,"_blank")},nl=e=>{re.value=e,ue.value=!0},ul=e=>{sl(e.downloadUrl)},rl=async e=>{var l,a;try{await q.confirm(`确定要删除文件 "${e.fileName}" 吗？此操作不可撤销。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"});const l=await x.delete(`/file/${e.fileId}`);1===l.data.code?(L.success("文件删除成功"),B.value=B.value.filter(l=>l.fileId!==e.fileId),xe()):L.error(l.data.msg||"删除失败")}catch(i){"cancel"!==i&&L.error("删除文件失败: "+((null==(a=null==(l=i.response)?void 0:l.data)?void 0:a.message)||i.message))}},cl=()=>{o.value=1,xe()},dl=()=>{o.value=1,xe()},vl=async()=>{var e;try{const l=await x.get("/categories");1===(null==(e=l.data)?void 0:e.code)&&(pe.value=l.data.data||[])}catch(l){}},pl=async()=>{var e,l;if(me.value.trim()){ge.value=!0;try{const a=await x.post("/categories",{name:me.value.trim()});1===(null==(e=a.data)?void 0:e.code)?(L.success("分类添加成功"),me.value="",vl()):L.error((null==(l=a.data)?void 0:l.msg)||"添加分类失败")}catch(a){L.error("添加分类失败")}finally{ge.value=!1}}else L.warning("请输入分类名称")},fl=()=>{me.value="",fe.value=!1},ml=e=>{we.value=e,he.value=e.categoryId||"",ye.value=!0},gl=async()=>{var e,l;if(we.value){ke.value=!0;try{const a=await x.put(`/files/${we.value.fileId}/category`,{categoryId:he.value||null});1===(null==(e=a.data)?void 0:e.code)?(L.success("文件分类更新成功"),ye.value=!1,xe()):L.error((null==(l=a.data)?void 0:l.msg)||"更新文件分类失败")}catch(a){L.error("更新文件分类失败")}finally{ke.value=!1}}},yl=e=>{const l=pe.value.find(l=>l.id===e);return l?l.name:"未知分类"};return w(()=>{_e(),window.addEventListener("resize",_e),xe(),vl()}),h(()=>{window.removeEventListener("resize",_e)}),(e,i)=>{const w=$,h=T,_e=G,ze=O,wl=Q,hl=W,kl=J,_l=X,bl=Y,Cl=Z,xl=A,Il=oe,zl=te,Vl=ee,jl=M,Ul=I,$l=le,Bl=N;return n(),v("div",Ue,[r(jl,{class:"content-card"},{header:s(()=>[u("div",$e,[u("div",Be,[r(w,null,{default:s(()=>[r(c(R))]),_:1}),i[15]||(i[15]=u("span",null,"文件列表",-1))]),u("div",Te,[r(h,{type:"primary",onClick:el,icon:c(F)},{default:s(()=>i[16]||(i[16]=[d("更新 URL 前缀")])),_:1},8,["icon"])])])]),default:s(()=>[u("div",Ne,[r(kl,{gutter:20},{default:s(()=>[r(ze,{xs:24,sm:12,md:8},{default:s(()=>[r(_e,{modelValue:ce.value,"onUpdate:modelValue":i[0]||(i[0]=e=>ce.value=e),placeholder:"搜索文件名...","prefix-icon":c(P),clearable:"",onInput:cl,size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),r(ze,{xs:24,sm:12,md:6},{default:s(()=>[r(hl,{modelValue:de.value,"onUpdate:modelValue":i[1]||(i[1]=e=>de.value=e),placeholder:"文件类型",clearable:"",onChange:dl,size:"large",style:{width:"100%"}},{default:s(()=>[r(wl,{label:"全部类型",value:""}),r(wl,{label:"图片",value:"image"}),r(wl,{label:"文档",value:"document"}),r(wl,{label:"视频",value:"video"}),r(wl,{label:"音频",value:"audio"}),r(wl,{label:"压缩包",value:"archive"}),r(wl,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),r(ze,{xs:24,sm:12,md:6},{default:s(()=>[r(hl,{modelValue:ve.value,"onUpdate:modelValue":i[2]||(i[2]=e=>ve.value=e),placeholder:"文件分类",clearable:"",onChange:dl,size:"large",style:{width:"100%"}},{default:s(()=>[r(wl,{label:"全部分类",value:""}),(n(!0),v(k,null,_(pe.value,e=>(n(),t(wl,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(ze,{xs:24,sm:12,md:4},{default:s(()=>[r(h,{type:"success",onClick:i[3]||(i[3]=e=>fe.value=!0),icon:c(S),size:"large",style:{width:"100%"}},{default:s(()=>i[17]||(i[17]=[d(" 管理分类 ")])),_:1},8,["icon"])]),_:1})]),_:1})]),se.value?g("",!0):m((n(),t(xl,{key:0,data:l.value,onSelectionChange:Ie,height:"calc(100vh - 280px)",style:{width:"100%"}},{default:s(()=>[r(_l,{type:"selection",width:"55",align:"center"}),r(_l,{prop:"fileName",label:"文件名","min-width":"200","show-overflow-tooltip":"",fixed:"left"},{default:s(e=>[u("div",Le,[r(w,null,{default:s(()=>[r(c(j))]),_:1}),u("span",null,p(e.row.fileName),1)])]),_:1}),r(_l,{prop:"size",label:"大小",width:"120",align:"center"}),r(_l,{prop:"uploadTime",label:"上传时间",width:"180",align:"center"},{default:s(e=>[d(p(Ae(e.row.uploadTime)),1)]),_:1}),r(_l,{label:"分类",width:"120",align:"center"},{default:s(e=>[e.row.categoryId?(n(),t(bl,{key:0,type:"info",size:"small"},{default:s(()=>[d(p(yl(e.row.categoryId)),1)]),_:2},1024)):(n(),v("span",Me,"未分类"))]),_:1}),r(_l,{label:"操作",width:"540",align:"center",fixed:"right"},{default:s(e=>[r(Cl,null,{default:s(()=>[r(h,{type:"info",size:"small",onClick:l=>nl(e.row),icon:c(D)},{default:s(()=>i[18]||(i[18]=[d("预览")])),_:2},1032,["onClick","icon"]),r(h,{type:"primary",size:"small",onClick:l=>ol(e.row),icon:c(E)},{default:s(()=>i[19]||(i[19]=[d("Markdown")])),_:2},1032,["onClick","icon"]),r(h,{type:"success",size:"small",onClick:l=>tl(e.row),icon:c(H)},{default:s(()=>i[20]||(i[20]=[d("链接")])),_:2},1032,["onClick","icon"]),r(h,{type:"warning",size:"small",onClick:l=>sl(e.row.downloadUrl),icon:c(z)},{default:s(()=>i[21]||(i[21]=[d("下载")])),_:2},1032,["onClick","icon"]),r(h,{type:"",size:"small",onClick:l=>ml(e.row),icon:c(R),plain:""},{default:s(()=>i[22]||(i[22]=[d("分类")])),_:2},1032,["onClick","icon"]),r(h,{type:"danger",size:"small",onClick:l=>rl(e.row),icon:c(K)},{default:s(()=>i[23]||(i[23]=[d("删除")])),_:2},1032,["onClick","icon"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Bl,a.value]]),se.value?(n(),v("div",{key:1,class:"mobile-file-list",ref_key:"mobileListRef",ref:ne},[0!==l.value.length||a.value?g("",!0):(n(),t(Il,{key:0,description:"暂无文件"})),a.value?(n(),t(zl,{key:1,rows:5,animated:""})):(n(),v("div",Re,[(n(!0),v(k,null,_(l.value,e=>(n(),v("div",{key:e.fileId,class:f(["mobile-file-item",{"is-selected":be(e)}]),onClick:l=>Ce(e)},[u("div",Pe,[r(c(ae),{"model-value":be(e),onChange:()=>Ce(e),onClick:i[4]||(i[4]=C(()=>{},["stop"])),size:"large",class:"mobile-checkbox"},null,8,["model-value","onChange"]),r(w,{class:"file-icon"},{default:s(()=>[r(c(j))]),_:1}),u("span",Se,p(e.fileName),1)]),u("div",De,[u("span",null,"大小: "+p(e.size),1),u("span",null,"上传时间: "+p(Ae(e.uploadTime)),1),e.categoryId?(n(),v("span",Ee,[i[24]||(i[24]=d(" 分类: ")),r(bl,{type:"info",size:"small"},{default:s(()=>[d(p(yl(e.categoryId)),1)]),_:2},1024)])):g("",!0)]),u("div",He,[r(Cl,null,{default:s(()=>[r(h,{type:"info",size:"small",onClick:C(l=>nl(e),["stop"]),icon:c(D),circle:""},null,8,["onClick","icon"]),r(h,{type:"primary",size:"small",onClick:C(l=>ol(e),["stop"]),icon:c(E),circle:""},null,8,["onClick","icon"]),r(h,{type:"success",size:"small",onClick:C(l=>tl(e),["stop"]),icon:c(H),circle:""},null,8,["onClick","icon"]),r(h,{type:"warning",size:"small",onClick:C(l=>sl(e.downloadUrl),["stop"]),icon:c(z),circle:""},null,8,["onClick","icon"]),r(h,{type:"",size:"small",onClick:C(l=>ml(e),["stop"]),icon:c(R),circle:"",plain:""},null,8,["onClick","icon"]),r(h,{type:"danger",size:"small",onClick:C(l=>rl(e),["stop"]),icon:c(K),circle:""},null,8,["onClick","icon"])]),_:2},1024)])],10,Fe))),128))]))],512)):g("",!0),u("div",{class:f(["footer-toolbar",{"is-mobile":se.value}])},[u("div",Ke,[r(h,{type:"primary",onClick:Ve,disabled:0===B.value.length,icon:c(E),plain:""},{default:s(()=>i[25]||(i[25]=[d(" 批量复制 (MD) ")])),_:1},8,["disabled","icon"]),r(h,{type:"success",onClick:Ye,disabled:0===B.value.length,icon:c(H),plain:""},{default:s(()=>i[26]||(i[26]=[d(" 批量复制 (链接) ")])),_:1},8,["disabled","icon"]),r(h,{type:"danger",onClick:Ze,disabled:0===B.value.length,icon:c(K),plain:""},{default:s(()=>[d(" 批量删除 ("+p(B.value.length)+") ",1)]),_:1},8,["disabled","icon"])]),V.value>0?(n(),t(Vl,{key:0,"current-page":o.value,"onUpdate:currentPage":i[5]||(i[5]=e=>o.value=e),"page-size":y.value,"onUpdate:pageSize":i[6]||(i[6]=e=>y.value=e),total:V.value,"page-sizes":[10,20,50,100],layout:se.value?"sizes, prev, pager, next":"total, sizes, prev, pager, next, jumper",onSizeChange:il,onCurrentChange:al,background:"",small:""},null,8,["current-page","page-size","total","layout"])):g("",!0)],2)]),_:1}),r(Ul,{modelValue:U.value,"onUpdate:modelValue":i[8]||(i[8]=e=>U.value=e),title:"更新 URL 前缀",width:"500px"},{footer:s(()=>[u("span",qe,[r(h,{onClick:i[7]||(i[7]=e=>U.value=!1)},{default:s(()=>i[27]||(i[27]=[d("取消")])),_:1}),r(h,{type:"primary",onClick:ll},{default:s(()=>i[28]||(i[28]=[d("确认更新")])),_:1})])]),default:s(()=>[i[29]||(i[29]=u("span",null," 此操作将根据服务器最新配置，更新所有文件的下载链接前缀。当您更换了域名或IP地址后，可以使用此功能。 ",-1))]),_:1},8,["modelValue"]),r(je,{modelValue:ue.value,"onUpdate:modelValue":i[9]||(i[9]=e=>ue.value=e),"file-info":re.value,onDownload:ul},null,8,["modelValue","file-info"]),r(Ul,{modelValue:fe.value,"onUpdate:modelValue":i[11]||(i[11]=e=>fe.value=e),title:"分类管理",width:"600px","before-close":fl},{default:s(()=>[u("div",Ge,[u("div",Oe,[r(_e,{modelValue:me.value,"onUpdate:modelValue":i[10]||(i[10]=e=>me.value=e),placeholder:"输入新分类名称",onKeyup:b(pl,["enter"]),style:{width:"300px","margin-right":"10px"}},null,8,["modelValue"]),r(h,{type:"primary",onClick:pl,loading:ge.value},{default:s(()=>i[30]||(i[30]=[d("添加分类")])),_:1},8,["loading"])]),r($l),u("div",Qe,[(n(!0),v(k,null,_(pe.value,e=>(n(),v("div",{key:e.id,class:"category-item"},[r(bl,{type:"info",size:"large"},{default:s(()=>[d(p(e.name),1)]),_:2},1024),u("div",We,[r(h,{size:"small",onClick:l=>(async e=>{var l,a;try{const{value:i}=await q.prompt("请输入新的分类名称","编辑分类",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:e.name,inputValidator:e=>!(!e||!e.trim())||"分类名称不能为空"}),o=await x.put(`/categories/${e.id}`,{name:i.trim()});1===(null==(l=o.data)?void 0:l.code)?(L.success("分类更新成功"),vl()):L.error((null==(a=o.data)?void 0:a.msg)||"更新分类失败")}catch(i){"cancel"!==i&&L.error("更新分类失败")}})(e),icon:c(ie)},{default:s(()=>i[31]||(i[31]=[d("编辑")])),_:2},1032,["onClick","icon"]),r(h,{size:"small",type:"danger",onClick:l=>(async e=>{var l,a;try{await q.confirm(`确定要删除分类 "${e.name}" 吗？删除后，该分类下的文件将变为未分类状态。`,"删除分类",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"});const i=await x.delete(`/categories/${e.id}`);1===(null==(l=i.data)?void 0:l.code)?(L.success("分类删除成功"),vl(),xe()):L.error((null==(a=i.data)?void 0:a.msg)||"删除分类失败")}catch(i){"cancel"!==i&&L.error("删除分类失败")}})(e),icon:c(K)},{default:s(()=>i[32]||(i[32]=[d("删除")])),_:2},1032,["onClick","icon"])])]))),128))])])]),_:1},8,["modelValue"]),r(Ul,{modelValue:ye.value,"onUpdate:modelValue":i[14]||(i[14]=e=>ye.value=e),title:"设置文件分类",width:"400px"},{footer:s(()=>[u("span",Xe,[r(h,{onClick:i[13]||(i[13]=e=>ye.value=!1)},{default:s(()=>i[35]||(i[35]=[d("取消")])),_:1}),r(h,{type:"primary",onClick:gl,loading:ke.value},{default:s(()=>i[36]||(i[36]=[d("确定")])),_:1},8,["loading"])])]),default:s(()=>[we.value?(n(),v("div",Je,[u("p",null,[i[33]||(i[33]=d("为文件 ")),u("strong",null,p(we.value.fileName),1),i[34]||(i[34]=d(" 设置分类："))]),r(hl,{modelValue:he.value,"onUpdate:modelValue":i[12]||(i[12]=e=>he.value=e),placeholder:"选择分类",clearable:"",style:{width:"100%"}},{default:s(()=>[r(wl,{label:"无分类",value:""}),(n(!0),v(k,null,_(pe.value,e=>(n(),t(wl,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):g("",!0)]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6785d850"]]);export{Ye as default};
