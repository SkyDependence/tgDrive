import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                 *//* empty css                *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                   */import{a as l,k as a,z as t,a2 as d,aB as o,aC as i,U as s,aD as n,aE as r,F as u,f as c,J as p,aF as m,G as b,s as f,M as v,I as g,aG as w,i as V,H as _,aA as x}from"./element-plus-BmgivntE.js";import{a as h}from"./vendor-BVvGM7bJ.js";import{d as y,r as D,V as A,j as W,f as j,c as U,P as k,H as C,G as M,M as P,o as S,a as q,u as z,R as B,O as R}from"./vue-vendor-B9yd_xiB.js";const F={class:"webdav-config-container"},T={class:"usage-content"},E={class:"webdav-url"},G=e(y({__name:"WebDavConfigPage",setup(e){const y=D(),G=D(!1),O=D(!1),$=A({enabled:!0,pathPrefix:"/webdav",requireAuth:!0,allowedRoles:"admin",maxUploadSize:100,allowMkdir:!0,allowDelete:!0,allowMove:!0,allowCopy:!0,description:"WebDAV服务配置"}),H={pathPrefix:[{required:!0,message:"请输入访问路径",trigger:"blur"},{pattern:/^\/.*/,message:"路径必须以/开头",trigger:"blur"}],allowedRoles:[{required:!0,message:"请选择允许的角色",trigger:"change"}],maxUploadSize:[{required:!0,message:"请输入最大上传大小",trigger:"blur"},{type:"number",min:1,max:1024,message:"大小必须在1-1024MB之间",trigger:"blur"}]},I=W(()=>`${window.location.protocol}//${window.location.host}${$.pathPrefix}`),J=async()=>{try{const e=await h.get("/api/webdav-config");1===e.data.code?Object.assign($,e.data.data):l.error(e.data.msg||"加载配置失败")}catch(e){l.error("加载配置失败")}},L=async()=>{if(y.value)try{await y.value.validate(),G.value=!0;const e=await h.put("/api/webdav-config",$);1===e.data.code?l.success("配置保存成功"):l.error(e.data.msg||"配置保存失败")}catch(e){l.error("配置保存失败")}finally{G.value=!1}},N=()=>{y.value&&(y.value.resetFields(),J())},K=async()=>{try{await u.confirm("确定要恢复默认配置吗？这将覆盖当前所有设置。","确认恢复默认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),O.value=!0;const e=await h.post("/api/webdav-config/reset");1===e.data.code?(l.success("已恢复默认配置"),await J()):l.error(e.data.msg||"恢复默认配置失败")}catch(e){"cancel"!==e&&l.error("恢复默认配置失败")}finally{O.value=!1}},Q=e=>{e||u.confirm("禁用WebDAV服务后，所有WebDAV客户端将无法访问。确定要禁用吗？","确认禁用",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>{$.enabled=!0})},X=async()=>{try{await navigator.clipboard.writeText(I.value),l.success("WebDAV地址已复制到剪贴板")}catch(e){l.error("复制失败")}};return j(()=>{J()}),(e,l)=>{const u=c,h=p,D=m,A=b,W=f,j=v,J=g,Y=w,Z=V,ee=_,le=a,ae=x;return S(),U("div",F,[k(le,{class:"config-card"},{header:C(()=>l[10]||(l[10]=[q("div",{class:"card-header"},[q("h2",null,"WebDAV配置"),q("p",{class:"subtitle"},"配置WebDAV服务的访问权限和功能设置")],-1)])),default:C(()=>[k(ee,{ref_key:"configFormRef",ref:y,model:$,rules:H,"label-width":"140px",class:"config-form"},{default:C(()=>[k(h,{"content-position":"left"},{default:C(()=>[k(u,null,{default:C(()=>[k(z(t))]),_:1}),l[11]||(l[11]=B(" 基础设置 "))]),_:1}),k(A,{label:"启用WebDAV",prop:"enabled"},{default:C(()=>[k(D,{modelValue:$.enabled,"onUpdate:modelValue":l[0]||(l[0]=e=>$.enabled=e),"active-text":"启用","inactive-text":"禁用",onChange:Q},null,8,["modelValue"]),l[12]||(l[12]=q("div",{class:"form-tip"},"启用后可通过WebDAV协议访问文件",-1))]),_:1}),k(A,{label:"访问路径",prop:"pathPrefix"},{default:C(()=>[k(W,{modelValue:$.pathPrefix,"onUpdate:modelValue":l[1]||(l[1]=e=>$.pathPrefix=e),placeholder:"/webdav",disabled:!$.enabled},null,8,["modelValue","disabled"]),l[13]||(l[13]=q("div",{class:"form-tip"},"WebDAV服务的访问路径前缀",-1))]),_:1}),k(A,{label:"需要认证",prop:"requireAuth"},{default:C(()=>[k(D,{modelValue:$.requireAuth,"onUpdate:modelValue":l[2]||(l[2]=e=>$.requireAuth=e),"active-text":"需要","inactive-text":"不需要",disabled:!$.enabled},null,8,["modelValue","disabled"]),l[14]||(l[14]=q("div",{class:"form-tip"},"是否需要用户名密码认证",-1))]),_:1}),k(h,{"content-position":"left"},{default:C(()=>[k(u,null,{default:C(()=>[k(z(d))]),_:1}),l[15]||(l[15]=B(" 权限设置 "))]),_:1}),k(A,{label:"允许的角色",prop:"allowedRoles"},{default:C(()=>[k(J,{modelValue:$.allowedRoles,"onUpdate:modelValue":l[3]||(l[3]=e=>$.allowedRoles=e),placeholder:"请选择允许访问的用户角色",disabled:!$.enabled},{default:C(()=>[k(j,{label:"仅管理员",value:"admin"}),k(j,{label:"访客用户",value:"visitor"}),k(j,{label:"所有用户",value:"all"})]),_:1},8,["modelValue","disabled"]),l[16]||(l[16]=q("div",{class:"form-tip"},"设置哪些角色的用户可以访问WebDAV",-1))]),_:1}),k(h,{"content-position":"left"},{default:C(()=>[k(u,null,{default:C(()=>[k(z(o))]),_:1}),l[17]||(l[17]=B(" 功能设置 "))]),_:1}),k(A,{label:"最大上传大小",prop:"maxUploadSize"},{default:C(()=>[k(Y,{modelValue:$.maxUploadSize,"onUpdate:modelValue":l[4]||(l[4]=e=>$.maxUploadSize=e),min:1,max:1024,step:10,disabled:!$.enabled},null,8,["modelValue","disabled"]),l[18]||(l[18]=q("span",{class:"unit"},"MB",-1)),l[19]||(l[19]=q("div",{class:"form-tip"},"单个文件的最大上传大小限制",-1))]),_:1}),k(A,{label:"允许创建目录",prop:"allowMkdir"},{default:C(()=>[k(D,{modelValue:$.allowMkdir,"onUpdate:modelValue":l[5]||(l[5]=e=>$.allowMkdir=e),"active-text":"允许","inactive-text":"禁止",disabled:!$.enabled},null,8,["modelValue","disabled"])]),_:1}),k(A,{label:"允许删除文件",prop:"allowDelete"},{default:C(()=>[k(D,{modelValue:$.allowDelete,"onUpdate:modelValue":l[6]||(l[6]=e=>$.allowDelete=e),"active-text":"允许","inactive-text":"禁止",disabled:!$.enabled},null,8,["modelValue","disabled"])]),_:1}),k(A,{label:"允许移动文件",prop:"allowMove"},{default:C(()=>[k(D,{modelValue:$.allowMove,"onUpdate:modelValue":l[7]||(l[7]=e=>$.allowMove=e),"active-text":"允许","inactive-text":"禁止",disabled:!$.enabled},null,8,["modelValue","disabled"])]),_:1}),k(A,{label:"允许复制文件",prop:"allowCopy"},{default:C(()=>[k(D,{modelValue:$.allowCopy,"onUpdate:modelValue":l[8]||(l[8]=e=>$.allowCopy=e),"active-text":"允许","inactive-text":"禁止",disabled:!$.enabled},null,8,["modelValue","disabled"])]),_:1}),k(A,{label:"配置描述",prop:"description"},{default:C(()=>[k(W,{modelValue:$.description,"onUpdate:modelValue":l[9]||(l[9]=e=>$.description=e),type:"textarea",rows:3,placeholder:"请输入配置描述",disabled:!$.enabled},null,8,["modelValue","disabled"])]),_:1}),k(A,null,{default:C(()=>[k(Z,{type:"primary",onClick:L,loading:G.value},{default:C(()=>[k(u,null,{default:C(()=>[k(z(i))]),_:1}),l[20]||(l[20]=B(" 保存配置 "))]),_:1},8,["loading"]),k(Z,{onClick:N},{default:C(()=>[k(u,null,{default:C(()=>[k(z(s))]),_:1}),l[21]||(l[21]=B(" 重置 "))]),_:1}),k(Z,{onClick:K,loading:O.value},{default:C(()=>[k(u,null,{default:C(()=>[k(z(n))]),_:1}),l[22]||(l[22]=B(" 恢复默认 "))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),$.enabled?(S(),M(le,{key:0,class:"usage-card"},{header:C(()=>l[23]||(l[23]=[q("div",{class:"card-header"},[q("h3",null,"WebDAV使用说明")],-1)])),default:C(()=>[q("div",T,[k(ae,{title:"WebDAV访问地址",type:"info",closable:!1,"show-icon":""},{default:C(()=>[q("div",E,[q("code",null,R(I.value),1),k(Z,{size:"small",type:"primary",link:"",onClick:X},{default:C(()=>[k(u,null,{default:C(()=>[k(z(r))]),_:1}),l[24]||(l[24]=B(" 复制 "))]),_:1})])]),_:1}),l[25]||(l[25]=q("div",{class:"usage-steps"},[q("h4",null,"使用步骤："),q("ol",null,[q("li",null,"在支持WebDAV的客户端中添加网络位置"),q("li",null,"输入上述WebDAV访问地址"),q("li",null,"使用您的用户名和密码进行认证"),q("li",null,"即可像本地文件夹一样操作远程文件")])],-1)),l[26]||(l[26]=q("div",{class:"client-recommendations"},[q("h4",null,"推荐客户端："),q("ul",null,[q("li",null,[q("strong",null,"Windows:"),B(" 文件资源管理器、WinSCP")]),q("li",null,[q("strong",null,"macOS:"),B(" Finder、Cyberduck")]),q("li",null,[q("strong",null,"Linux:"),B(" Nautilus、Dolphin")]),q("li",null,[q("strong",null,"移动端:"),B(" ES文件浏览器、FE文件管理器")])])],-1))])]),_:1})):P("",!0)])}}}),[["__scopeId","data-v-2df4ceed"]]);export{G as default};
