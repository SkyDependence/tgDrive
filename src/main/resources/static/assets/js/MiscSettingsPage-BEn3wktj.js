import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                *//* empty css                     *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  */import{s as a}from"./request-B41dlSwZ.js";import{i as l,a as t,y as o,U as s,A as d,z as n,aF as r,aG as i,aH as u,f as c,B as m,aI as p,aJ as g}from"./element-plus-C0Di9U4-.js";import{d as f,b as v,W as y,f as b,c as h,Q as _,I as V,o as k,a as w,H as U,S as x,L as j,O,P as S}from"./vue-vendor-uyOI1CZy.js";import"./vendor-CE_fW1yV.js";const I={class:"misc-settings-container"},E={class:"background-settings"},B={class:"image-input-section"},C={key:0,class:"image-preview-container"},G=["src"],P={key:0},T={key:1},z={key:2},L={class:"opacity-value"},q={class:"seo-settings"},R=e(f({__name:"MiscSettingsPage",setup(e){const f=v("background"),R=v(!1),W=v(""),$=y({enabled:!1,imageUrl:"",mode:"cover",opacity:80}),A=y({title:"",description:"",keywords:"",author:"",favicon:"",ogImage:""}),F=()=>{if(!$.imageUrl)return void(W.value="");if(!/^https?:\/\/.+\.(jpg|jpeg|png|gif|webp)(\?.*)?$/i.test($.imageUrl))return t.warning("请输入有效的图片链接"),void(W.value="error");W.value="loading"},H=()=>{W.value="success"},J=()=>{W.value="error",t.error("图片加载失败，请检查链接是否有效")},N=async()=>{R.value=!0;try{const e=await a.post("/misc/background",$);1===e.data.code?(t.success("背景设置保存成功"),K()):t.error(e.data.msg||"保存失败")}catch(e){t.error("保存失败")}finally{R.value=!1}},M=async()=>{R.value=!0;try{const e=await a.post("/misc/seo",A);1===e.data.code?t.success("SEO设置保存成功"):t.error(e.data.msg||"保存失败")}catch(e){t.error("保存失败")}finally{R.value=!1}},Q=()=>{o.confirm("确定要重置背景设置吗？","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{$.enabled=!1,$.imageUrl="",$.mode="cover",$.opacity=80,t.success("背景设置已重置")})},D=()=>{o.confirm("确定要重置SEO设置吗？","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{A.title="",A.description="",A.keywords="",A.author="",A.favicon="",A.ogImage="",t.success("SEO设置已重置")})},K=()=>{const e=document.body;if($.enabled&&$.imageUrl){e.style.backgroundImage=`url(${$.imageUrl})`,e.style.backgroundSize=$.mode,e.style.backgroundRepeat="repeat"===$.mode?"repeat":"no-repeat",e.style.backgroundPosition="center",e.style.backgroundAttachment="fixed"===$.mode?"fixed":"scroll";const a=document.querySelector(".background-overlay");if(a)a.style.opacity=""+(100-$.opacity)/100;else{const a=document.createElement("div");a.className="background-overlay",a.style.cssText=`\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: var(--el-bg-color);\n        opacity: ${(100-$.opacity)/100};\n        pointer-events: none;\n        z-index: -1;\n      `,e.appendChild(a)}}else{e.style.backgroundImage="";const a=document.querySelector(".background-overlay");a&&a.remove()}};return b(()=>{(async()=>{try{const e=await a.get("/misc/settings");if(1===e.data.code){const{background:a,seo:l}=e.data.data;a&&(Object.assign($,a),$.imageUrl&&$.imageUrl.startsWith("/")&&($.imageUrl=window.location.origin+$.imageUrl)),l&&Object.assign(A,l)}}catch(e){}})()}),(e,a)=>{const t=s,o=d,v=n,y=r,b=i,K=u,X=c,Y=m,Z=p,ee=g,ae=l;return k(),h("div",I,[_(ae,{class:"settings-card"},{header:V(()=>a[11]||(a[11]=[w("div",{class:"card-header"},[w("h2",null,"杂项管理"),w("p",null,"管理网站背景图片和SEO设置")],-1)])),default:V(()=>[_(ee,{modelValue:f.value,"onUpdate:modelValue":a[10]||(a[10]=e=>f.value=e),class:"settings-tabs"},{default:V(()=>[_(Z,{label:"背景图片",name:"background"},{default:V(()=>[w("div",E,[_(Y,{model:$,"label-width":"120px"},{default:V(()=>[_(o,{label:"启用背景图"},{default:V(()=>[_(t,{modelValue:$.enabled,"onUpdate:modelValue":a[0]||(a[0]=e=>$.enabled=e)},null,8,["modelValue"])]),_:1}),$.enabled?(k(),U(o,{key:0,label:"背景图片"},{default:V(()=>[w("div",B,[_(v,{modelValue:$.imageUrl,"onUpdate:modelValue":a[1]||(a[1]=e=>$.imageUrl=e),placeholder:"请输入图片链接 (支持 http:// 或 https://)",clearable:"",onBlur:F},{prepend:V(()=>a[12]||(a[12]=[x("图片链接")])),_:1},8,["modelValue"]),$.imageUrl?(k(),h("div",C,[w("img",{src:$.imageUrl,class:"background-preview",onLoad:H,onError:J},null,40,G),w("div",{class:j(["image-status",W.value])},["loading"===W.value?(k(),h("span",P,"加载中...")):"success"===W.value?(k(),h("span",T,"✓ 图片加载成功")):"error"===W.value?(k(),h("span",z,"✗ 图片加载失败")):O("",!0)],2)])):O("",!0),a[13]||(a[13]=w("div",{class:"image-tips"},[w("p",null,"• 请输入有效的图片链接 (http:// 或 https://)"),w("p",null,"• 建议尺寸：1920x1080 或更高"),w("p",null,"• 支持格式：JPG、PNG、WebP、GIF")],-1))])]),_:1})):O("",!0),$.enabled?(k(),U(o,{key:1,label:"背景模式"},{default:V(()=>[_(b,{modelValue:$.mode,"onUpdate:modelValue":a[2]||(a[2]=e=>$.mode=e)},{default:V(()=>[_(y,{value:"cover"},{default:V(()=>a[14]||(a[14]=[x("覆盖")])),_:1}),_(y,{value:"contain"},{default:V(()=>a[15]||(a[15]=[x("包含")])),_:1}),_(y,{value:"repeat"},{default:V(()=>a[16]||(a[16]=[x("重复")])),_:1}),_(y,{value:"fixed"},{default:V(()=>a[17]||(a[17]=[x("固定")])),_:1})]),_:1},8,["modelValue"])]),_:1})):O("",!0),$.enabled?(k(),U(o,{key:2,label:"透明度"},{default:V(()=>[_(K,{modelValue:$.opacity,"onUpdate:modelValue":a[3]||(a[3]=e=>$.opacity=e),min:10,max:100,step:5,"show-stops":""},null,8,["modelValue"]),w("span",L,S($.opacity)+"%",1)]),_:1})):O("",!0),_(o,null,{default:V(()=>[_(X,{type:"primary",onClick:N,loading:R.value},{default:V(()=>a[18]||(a[18]=[x("保存背景设置")])),_:1},8,["loading"]),_(X,{onClick:Q},{default:V(()=>a[19]||(a[19]=[x("重置")])),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),_(Z,{label:"SEO设置",name:"seo"},{default:V(()=>[w("div",q,[_(Y,{model:A,"label-width":"120px"},{default:V(()=>[_(o,{label:"网站标题"},{default:V(()=>[_(v,{modelValue:A.title,"onUpdate:modelValue":a[4]||(a[4]=e=>A.title=e),placeholder:"请输入网站标题",maxlength:"60","show-word-limit":""},null,8,["modelValue"])]),_:1}),_(o,{label:"网站描述"},{default:V(()=>[_(v,{modelValue:A.description,"onUpdate:modelValue":a[5]||(a[5]=e=>A.description=e),type:"textarea",rows:3,placeholder:"请输入网站描述",maxlength:"160","show-word-limit":""},null,8,["modelValue"])]),_:1}),_(o,{label:"关键词"},{default:V(()=>[_(v,{modelValue:A.keywords,"onUpdate:modelValue":a[6]||(a[6]=e=>A.keywords=e),type:"textarea",rows:2,placeholder:"请输入关键词，用英文逗号分隔",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),_(o,{label:"作者"},{default:V(()=>[_(v,{modelValue:A.author,"onUpdate:modelValue":a[7]||(a[7]=e=>A.author=e),placeholder:"请输入作者信息",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),_(o,{label:"网站图标"},{default:V(()=>[_(v,{modelValue:A.favicon,"onUpdate:modelValue":a[8]||(a[8]=e=>A.favicon=e),placeholder:"请输入网站图标URL"},null,8,["modelValue"])]),_:1}),_(o,{label:"OG图片"},{default:V(()=>[_(v,{modelValue:A.ogImage,"onUpdate:modelValue":a[9]||(a[9]=e=>A.ogImage=e),placeholder:"请输入Open Graph图片URL"},null,8,["modelValue"])]),_:1}),_(o,null,{default:V(()=>[_(X,{type:"primary",onClick:M,loading:R.value},{default:V(()=>a[20]||(a[20]=[x("保存SEO设置")])),_:1},8,["loading"]),_(X,{onClick:D},{default:V(()=>a[21]||(a[21]=[x("重置")])),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}}),[["__scopeId","data-v-329c6122"]]);export{R as default};
