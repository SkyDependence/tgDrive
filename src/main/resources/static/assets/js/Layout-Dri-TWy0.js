import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";import{u as a}from"./useSEO-3LZaHzlG.js";/* empty css                        *//* empty css                  *//* empty css                     */import{d as t,r as o,j as n,f as s,y as l,G as c,H as r,au as d,ac as i,o as u,P as m,a as p,u as g,R as f,L as y,T as v}from"./vue-vendor-B9yd_xiB.js";import{a8 as h,_ as k,a9 as _,aa as b,ab as w,ac as j,y as x,a as S,d as I,ad as L,ae as C,af as E,f as T,ag as z,ah as q,ai as B}from"./element-plus-B6Syq966.js";import{s as M}from"./request-BlLXdTX7.js";import"./vendor-DO3eE842.js";const G={class:"header-content"},P={class:"logo"},R={class:"actions"},U={class:"el-dropdown-link",style:{outline:"none",cursor:"pointer"}},$=e(t({__name:"Layout",setup(e){const t=d(),$=o("auto");a();const A=n(()=>!!localStorage.getItem("token")),D=n(()=>"light"===$.value?_:"dark"===$.value?b:w),H=()=>{if("auto"===$.value){const e=window.matchMedia("(prefers-color-scheme: dark)");document.documentElement.classList.toggle("dark",e.matches)}else document.documentElement.classList.toggle("dark","dark"===$.value)},N=e=>{$.value=e,localStorage.setItem("theme",e),H()},O=e=>{"auto"===$.value&&document.documentElement.classList.toggle("dark",e.matches)},F=e=>{const a=document.body;if(e.enabled&&e.imageUrl){a.style.backgroundImage=`url(${e.imageUrl})`,a.style.backgroundSize=e.mode||"cover",a.style.backgroundRepeat="repeat"===e.mode?"repeat":"no-repeat",a.style.backgroundPosition="center",a.style.backgroundAttachment="fixed"===e.mode?"fixed":"scroll";let t=document.querySelector(".background-overlay");if(t)t.style.opacity=""+(100-(e.opacity||80))/100;else{const t=document.createElement("div");t.className="background-overlay",t.style.cssText=`\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: var(--el-bg-color);\n        opacity: ${(100-(e.opacity||80))/100};\n        pointer-events: none;\n        z-index: -1;\n      `,a.appendChild(t)}}else{a.style.backgroundImage="";const e=document.querySelector(".background-overlay");e&&e.remove()}};s(()=>{const e=localStorage.getItem("theme");$.value=e||"auto",H(),(async()=>{try{const e=await M.get("/misc/background");if(1===e.data.code){const a=e.data.data;F(a)}}catch(e){}})(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",O)}),l(()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",O)});const J=()=>{t.push("/login")},K=()=>{t.push("/about")},Q=()=>{const e=localStorage.getItem("token"),a=localStorage.getItem("role");e&&"visitor"!==a?t.push("/home"):x.alert("您当前是访客，请使用管理员账号登录！","权限提示",{confirmButtonText:"确定",type:"warning"})},V=e=>{"logout"===e&&W()},W=()=>{x.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{localStorage.removeItem("token"),localStorage.removeItem("role"),S.success("已退出登录"),t.push("/login")}).catch(()=>{})};return(e,a)=>{const t=I,o=L,n=C,s=E,l=T,d=z,x=q,S=i("router-view"),M=B,$=h;return u(),c($,{class:"layout-container"},{default:r(()=>[m(x,{class:"header"},{default:r(()=>[p("div",G,[p("div",P,[m(t,{class:"logo-icon"},{default:r(()=>[m(g(k))]),_:1}),a[0]||(a[0]=p("div",{class:"logo-text"},[p("span",{class:"main-title"},"TG-Drive"),p("span",{class:"sub-title"},"Stanley_Legend")],-1))]),p("div",R,[m(s,{onCommand:N,trigger:"click"},{dropdown:r(()=>[m(n,null,{default:r(()=>[m(o,{command:"light",icon:g(_)},{default:r(()=>a[1]||(a[1]=[f("亮色模式")])),_:1},8,["icon"]),m(o,{command:"dark",icon:g(b)},{default:r(()=>a[2]||(a[2]=[f("暗色模式")])),_:1},8,["icon"]),m(o,{command:"auto",icon:g(w)},{default:r(()=>a[3]||(a[3]=[f("跟随系统")])),_:1},8,["icon"])]),_:1})]),default:r(()=>[p("span",U,[m(t,{size:20},{default:r(()=>[(u(),c(y(D.value)))]),_:1})])]),_:1}),m(l,{type:"info",plain:"",onClick:K},{default:r(()=>a[4]||(a[4]=[f("关于")])),_:1}),m(l,{type:"primary",plain:"",onClick:Q},{default:r(()=>a[5]||(a[5]=[f("管理")])),_:1}),A.value?(u(),c(s,{key:1,onCommand:V,trigger:"click"},{dropdown:r(()=>[m(n,null,{default:r(()=>[m(o,{command:"logout",icon:g(j)},{default:r(()=>a[7]||(a[7]=[f("退出登录")])),_:1},8,["icon"])]),_:1})]),default:r(()=>[m(d,{size:32,src:"/110871356.jpg",style:{cursor:"pointer"}})]),_:1})):(u(),c(l,{key:0,type:"primary",onClick:J},{default:r(()=>a[6]||(a[6]=[f("登录")])),_:1}))])])]),_:1}),m(M,{class:"main-content"},{default:r(()=>[m(S,null,{default:r(({Component:e})=>[m(v,{name:"fade",mode:"out-in"},{default:r(()=>[(u(),c(y(e)))]),_:2},1024)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-05114d06"]]);export{$ as default};
