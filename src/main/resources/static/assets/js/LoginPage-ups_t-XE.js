import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                     *//* empty css                    *//* empty css                 */import{d as a,r as s,l,c as r,a as o,M as t,E as u,J as i,ah as n,o as m,u as d,K as p,ab as c,av as g}from"./vue-vendor-CxLOoai_.js";import{f as v,q as f,Z as _,r as b,s as h,_ as y,y as w,Y as x,$ as j,h as k,b as V,G as I}from"./element-plus-DQjCWvVU.js";import{s as U}from"./request-DvzUJvtB.js";import{u as z}from"./user-CWlPWJjU.js";import"./vendor-CPGCUlN1.js";import"./index-CLLrkTrC.js";const q={class:"login-page-container"},S={class:"login-card"},C={class:"login-header"},K={class:"login-options"},A={class:"register-prompt"},B=e(a({__name:"LoginPage",setup(e){const a=g(),B=z(),E=s({username:"",password:""}),F=s(),G=s(!1),J=s(!1),L={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名长度至少为3个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6个字符",trigger:"blur"}]},M=()=>{var e;G.value||null==(e=F.value)||e.validate(async e=>{if(e){G.value=!0;try{const e=await U.post("/auth/login",{username:E.value.username,password:E.value.password});if(1===e.data.code){const s=e.data.data;B.setUserInfo({token:s.token,role:s.role,userId:s.UserId,username:s.username,email:s.email}),J.value?localStorage.setItem("rememberedUsername",E.value.username):localStorage.removeItem("rememberedUsername"),V.success(e.data.msg||"登录成功"),"admin"===s.role?a.push("/home"):"user"===s.role?a.push("/user/home"):a.push("/")}else V.error(e.data.msg||"登录失败")}catch(s){V.error("登录失败，请检查网络或联系管理员")}finally{G.value=!1}}})},P=()=>{I.alert("请联系管理员重置您的密码。","忘记密码",{confirmButtonText:"好的"})};return l(()=>{const e=localStorage.getItem("username");e&&(E.value.username=e,J.value=!0)}),(e,a)=>{const s=v,l=h,g=b,V=x,I=j,U=k,z=c("router-link"),B=f;return m(),r("div",q,[o("div",S,[o("div",C,[t(s,{size:28,color:"var(--el-color-primary)"},{default:u(()=>[t(d(_))]),_:1}),a[3]||(a[3]=o("h2",{class:"login-title"},"欢迎回来",-1)),a[4]||(a[4]=o("p",{class:"login-subtitle"},"请使用访客账户登录",-1)),a[5]||(a[5]=o("div",{class:"account-info"},[o("p",null,[o("strong",null,"访客账户:"),i(" visitor / 111111")])],-1))]),t(B,{model:E.value,rules:L,ref_key:"loginFormRef",ref:F,"label-position":"top",onKeyup:n(M,["enter"]),class:"login-form"},{default:u(()=>[t(g,{label:"用户名",prop:"username"},{default:u(()=>[t(l,{modelValue:E.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value.username=e),"prefix-icon":d(y),placeholder:"请输入用户名或邮箱",size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),t(g,{label:"密码",prop:"password"},{default:u(()=>[t(l,{modelValue:E.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>E.value.password=e),"prefix-icon":d(w),type:"password",placeholder:"请输入密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),t(g,null,{default:u(()=>[o("div",K,[t(V,{modelValue:J.value,"onUpdate:modelValue":a[2]||(a[2]=e=>J.value=e)},{default:u(()=>a[6]||(a[6]=[i("记住我")])),_:1,__:[6]},8,["modelValue"]),t(I,{type:"primary",onClick:P},{default:u(()=>a[7]||(a[7]=[i("忘记密码？")])),_:1,__:[7]})])]),_:1}),t(g,null,{default:u(()=>[t(U,{type:"primary",onClick:M,loading:G.value,class:"login-button",size:"large",block:""},{default:u(()=>[i(p(G.value?"登录中...":"登 录"),1)]),_:1},8,["loading"])]),_:1}),t(g,{class:"register-link"},{default:u(()=>[o("div",A,[a[9]||(a[9]=o("span",{class:"prompt-text"},"没有账户？",-1)),t(z,{to:"/register",class:"register-btn"},{default:u(()=>[t(U,{type:"primary",plain:"",size:"small"},{default:u(()=>a[8]||(a[8]=[i(" 立即注册 ")])),_:1,__:[8]})]),_:1})])]),_:1})]),_:1},8,["model"])])])}}}),[["__scopeId","data-v-ded8101f"]]);export{B as default};
