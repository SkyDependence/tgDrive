import{_ as a}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                *//* empty css                             *//* empty css               *//* empty css                   *//* empty css                 */import{d as e,b as t,aD as s,B as l,h as i,a6 as o,aE as n,aF as c,C as r,D as d,a7 as u,f as p,aA as v,G as m}from"./element-plus-D6es4l3D.js";import{a as _}from"./vendor-CdKXy6i5.js";import{d as f,r as g,b as y,l as b,c as h,M as w,E as j,o as k,a as z,u as x,J as B,K as T}from"./vue-vendor-Cc5FuWtX.js";const C={class:"page-container"},D={class:"card-header"},A={class:"action-section"},E={class:"status-section"},G={class:"action-item"},K={class:"send-button-container"},F={class:"action-item"},I={class:"task-controls"},J={class:"action-item"},L={class:"config-info"},M=a(f({__name:"BotKeepAlivePage",setup(a){const f=g(!1),M=g(!1),N=g(!1),P=g(!1),S=g(""),q=y(()=>f.value?"保活任务运行中":"保活任务已停止"),H=y(()=>f.value?"success":"warning"),O=y(()=>f.value?"定时保活任务正在运行，将在每天凌晨2点自动发送保活消息，确保机器人保持活跃状态。":"定时保活任务已停止，机器人可能会因长时间不活跃而被Telegram限制。建议启动定时任务。"),Q=()=>{S.value=(new Date).toLocaleString("zh-CN")},R=async()=>{try{const a=await _.get("/api/bot/keep-alive/status");1===a.data.code&&(f.value="运行中"===a.data.data,Q())}catch(a){t.error("获取任务状态失败")}},U=async()=>{M.value=!0;try{const a=await _.post("/api/bot/keep-alive/send");1===a.data.code?(t.success("保活消息发送成功"),Q()):t.error(a.data.msg||"发送失败")}catch(a){t.error("发送保活消息失败")}finally{M.value=!1}},V=async()=>{try{await m.confirm("确定要启动定时保活任务吗？任务将在每天凌晨2点自动发送保活消息。","确认启动",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),N.value=!0;const a=await _.post("/api/bot/keep-alive/start");1===a.data.code?(t.success("定时保活任务启动成功"),await R()):t.error(a.data.msg||"启动失败")}catch(a){"cancel"!==a&&t.error("启动定时任务失败")}finally{N.value=!1}},W=async()=>{try{await m.confirm("确定要停止定时保活任务吗？停止后机器人可能会因长时间不活跃而被限制。","确认停止",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),P.value=!0;const a=await _.post("/api/bot/keep-alive/stop");1===a.data.code?(t.success("定时保活任务停止成功"),await R()):t.error(a.data.msg||"停止失败")}catch(a){"cancel"!==a&&t.error("停止定时任务失败")}finally{P.value=!1}};return b(()=>{R()}),(a,t)=>{const m=p,_=s,g=l,y=i,b=d,Q=u,R=r,X=e;return k(),h("div",C,[w(X,{class:"content-card"},{header:j(()=>[z("div",D,[w(m,null,{default:j(()=>[w(x(v))]),_:1}),t[0]||(t[0]=z("span",null,"机器人保活管理",-1))])]),default:j(()=>[z("div",A,[z("div",E,[w(_,{title:q.value,type:H.value,description:O.value,"show-icon":"",closable:!1},null,8,["title","type","description"])]),w(g,{direction:"horizontal"}),z("div",G,[t[2]||(t[2]=z("h3",null,"手动发送保活消息",-1)),t[3]||(t[3]=z("p",null,"立即发送一条保活消息到Telegram，用于测试机器人连接状态。",-1)),z("div",K,[w(y,{type:"primary",onClick:U,loading:M.value,icon:x(o),size:"large"},{default:j(()=>t[1]||(t[1]=[B(" 发送保活消息 ",-1)])),_:1,__:[1]},8,["loading","icon"])])]),w(g,{direction:"horizontal"}),z("div",F,[t[6]||(t[6]=z("h3",null,"定时保活任务",-1)),t[7]||(t[7]=z("p",null,"控制自动保活任务的启动和停止。任务将在每天凌晨2点自动发送保活消息。",-1)),z("div",I,[w(y,{type:"success",onClick:V,loading:N.value,disabled:f.value,icon:x(n),size:"large"},{default:j(()=>t[4]||(t[4]=[B(" 启动定时任务 ",-1)])),_:1,__:[4]},8,["loading","disabled","icon"]),w(y,{type:"warning",onClick:W,loading:P.value,disabled:!f.value,icon:x(c),size:"large",plain:""},{default:j(()=>t[5]||(t[5]=[B(" 停止定时任务 ",-1)])),_:1,__:[5]},8,["loading","disabled","icon"])])]),w(g,{direction:"horizontal"}),z("div",J,[t[10]||(t[10]=z("h3",null,"保活配置",-1)),z("div",L,[w(R,{column:1,border:""},{default:j(()=>[w(b,{label:"发送时间"},{default:j(()=>t[8]||(t[8]=[B("每天凌晨2点",-1)])),_:1,__:[8]}),w(b,{label:"发送间隔"},{default:j(()=>t[9]||(t[9]=[B("24小时",-1)])),_:1,__:[9]}),w(b,{label:"任务状态"},{default:j(()=>[w(Q,{type:f.value?"success":"danger"},{default:j(()=>[B(T(f.value?"运行中":"已停止"),1)]),_:1},8,["type"])]),_:1}),w(b,{label:"最后更新"},{default:j(()=>[B(T(S.value),1)]),_:1})]),_:1})])])])]),_:1})])}}}),[["__scopeId","data-v-91eb5584"]]);export{M as default};
