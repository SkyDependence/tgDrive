import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";/* empty css                   *//* empty css                   *//* empty css                *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                        *//* empty css               *//* empty css                 */import{d as l,j as a,r as i,w as t,G as s,H as o,o as n,a as r,P as c,u,R as d,c as v,O as p,K as f,I as m,M as g,n as y,f as w,y as h,ah as k,Q as _,aa as x,$ as b}from"./vue-vendor-B9yd_xiB.js";import{s as C}from"./request-CHXRx1DF.js";import{N as I,O as z,P as j,n as V,Q as N,f as S,R as U,i as B,S as $,a as T,k as L,T as M,U as O,V as J,W as F,v as R,X as P,q as E,d as D,F as H,s as K,l as q,M as G,I as Q,b as W,Y as X,Z as Y,w as Z,_ as A,$ as ee,J as le,a0 as ae,e as ie,m as te,a1 as se}from"./element-plus-DF_olGcQ.js";import{H as oe}from"./vendor-CVFNKsYv.js";const ne={class:"preview-container"},re={key:0,class:"image-preview"},ce={key:1,class:"video-preview"},ue=["src"],de={key:2,class:"audio-preview"},ve={class:"audio-info"},pe=["src"],fe={key:3,class:"pdf-preview"},me=["src"],ge=["href"],ye={key:4,class:"text-preview"},we={class:"text-content"},he={key:5,class:"office-preview"},ke={class:"office-viewer"},_e=["src"],xe={key:6,class:"code-preview"},be=["innerHTML"],Ce={key:7,class:"unsupported-preview"},Ie={class:"unsupported-content"},ze={key:8,"element-loading-text":"加载中...",class:"loading-overlay"},je={class:"dialog-footer"},Ve=e(l({__name:"FilePreview",props:{modelValue:{type:Boolean},fileInfo:{}},emits:["update:modelValue","download"],setup(e,{emit:l}){const w=e,h=l,k=a({get:()=>w.modelValue,set:e=>h("update:modelValue",e)}),_=i(!1),x=i(""),b=i(""),C=a(()=>{var e,l;return(null==(e=w.fileInfo)?void 0:e.fileName)&&(null==(l=w.fileInfo.fileName.split(".").pop())?void 0:l.toLowerCase())||""}),L=a(()=>["jpg","jpeg","png","gif","bmp","webp","svg"].includes(C.value)),M=a(()=>["mp4","avi","mov","wmv","flv","webm","mkv"].includes(C.value)),O=a(()=>["mp3","wav","flac","aac","ogg","m4a"].includes(C.value)),J=a(()=>"pdf"===C.value),F=a(()=>["txt","md","json","xml","csv","log"].includes(C.value)),R=a(()=>["doc","docx","xls","xlsx","ppt","pptx"].includes(C.value)),P=a(()=>["js","ts","vue","html","css","scss","less","java","py","cpp","c","go","rs","php","rb","swift","kt"].includes(C.value)),E=a(()=>{var e;return(null==(e=w.fileInfo)?void 0:e.downloadUrl)||""}),D=()=>({js:"javascript",ts:"typescript",vue:"vue",html:"html",css:"css",scss:"scss",less:"less",java:"java",py:"python",cpp:"cpp",c:"c",go:"go",rs:"rust",php:"php",rb:"ruby",swift:"swift",kt:"kotlin"}[C.value]||"plaintext"),H=e=>{const l="string"==typeof e?parseInt(e):e;if(0===l)return"0 B";const a=Math.floor(Math.log(l)/Math.log(1024));return parseFloat((l/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB","TB"][a]},K=async()=>{if(w.fileInfo&&(F.value||P.value)){_.value=!0;try{const e=await fetch(E.value),l=await e.text();if(P.value){const e=oe.highlight(l,{language:D()});b.value=e.value}else x.value=l}catch(e){T.error("加载文件内容失败")}finally{_.value=!1}}},q=()=>{w.fileInfo&&h("download",w.fileInfo)},G=()=>{k.value=!1,x.value="",b.value=""};return t(()=>w.fileInfo,async e=>{e&&k.value&&(await y(),(F.value||P.value)&&K())},{immediate:!0}),t(k,async e=>{e&&w.fileInfo&&(await y(),(F.value||P.value)&&K())}),(e,l)=>{var a;const i=N,t=S,y=U,w=B,h=I,C=$;return n(),s(h,{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=e=>k.value=e),title:(null==(a=e.fileInfo)?void 0:a.fileName)||"文件预览",width:"80%","before-close":G,class:"file-preview-dialog"},{footer:o(()=>[r("div",je,[c(w,{onClick:q},{default:o(()=>[c(t,null,{default:o(()=>[c(u(z))]),_:1}),l[4]||(l[4]=d(" 下载 "))]),_:1}),c(w,{type:"primary",onClick:G},{default:o(()=>l[5]||(l[5]=[d("关闭")])),_:1})])]),default:o(()=>{var a,s,h,k;return[r("div",ne,[L.value?(n(),v("div",re,[c(i,{src:E.value,alt:null==(a=e.fileInfo)?void 0:a.fileName,fit:"contain",class:"preview-image","preview-src-list":[E.value],"initial-index":0,"preview-teleported":""},null,8,["src","alt","preview-src-list"])])):M.value?(n(),v("div",ce,[r("video",{src:E.value,controls:"",class:"preview-video",preload:"metadata"}," 您的浏览器不支持视频播放 ",8,ue)])):O.value?(n(),v("div",de,[r("div",ve,[c(t,{size:"48",color:"#409EFF"},{default:o(()=>[c(u(j))]),_:1}),r("h3",null,p(null==(s=e.fileInfo)?void 0:s.fileName),1)]),r("audio",{src:E.value,controls:"",class:"preview-audio",preload:"metadata"}," 您的浏览器不支持音频播放 ",8,pe)])):J.value?(n(),v("div",fe,[r("iframe",{src:E.value,class:"preview-iframe",frameborder:"0"},[l[1]||(l[1]=d(" 您的浏览器不支持PDF预览，请")),r("a",{href:E.value,target:"_blank"},"点击下载",8,ge)],8,me)])):F.value?(n(),v("div",ye,[c(y,{height:"500px"},{default:o(()=>[r("pre",we,p(x.value),1)]),_:1})])):R.value?(n(),v("div",he,[r("div",ke,[r("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(E.value)}`,class:"preview-iframe",frameborder:"0"}," 文档预览加载中... ",8,_e)])])):P.value?(n(),v("div",xe,[c(y,{height:"500px"},{default:o(()=>[r("pre",null,[r("code",{class:f(D()),innerHTML:b.value},null,10,be)])]),_:1})])):(n(),v("div",Ce,[r("div",Ie,[c(t,{size:"64",color:"#909399"},{default:o(()=>[c(u(V))]),_:1}),l[3]||(l[3]=r("h3",null,"暂不支持此文件类型的预览",-1)),r("p",null,"文件名: "+p(null==(h=e.fileInfo)?void 0:h.fileName),1),r("p",null,"文件大小: "+p(H(null==(k=e.fileInfo)?void 0:k.size)),1),c(w,{type:"primary",onClick:q},{default:o(()=>[c(t,null,{default:o(()=>[c(u(z))]),_:1}),l[2]||(l[2]=d(" 下载文件 "))]),_:1})])])),_.value?m((n(),v("div",ze,null,512)),[[C,_.value]]):g("",!0)])]}),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-0f36186f"]]),Ne={class:"page-container"},Se={class:"card-header"},Ue={class:"header-left"},Be={class:"header-right"},$e={class:"search-filter-section"},Te={style:{display:"flex","align-items":"center",gap:"8px"}},Le={key:1,class:"text-gray-400"},Me={key:2},Oe=["onClick"],Je={class:"file-info"},Fe={class:"file-name-mobile"},Re={class:"file-meta"},Pe={key:0,class:"file-category"},Ee={class:"file-actions"},De={class:"batch-actions"},He={class:"dialog-footer"},Ke={class:"category-management"},qe={class:"add-category"},Ge={class:"category-list"},Qe={class:"category-actions"},We=e(l({__name:"FileList",setup(e){const l=i([]),a=i(!1),t=i(1),y=i(10),j=i(0),N=i(!1),U=i([]),oe=i(!1),ne=i(null),re=i(!1),ce=i(null),ue=i(""),de=i(""),ve=i([]),pe=i(!1),fe=i(""),me=i(!1),ge=()=>{oe.value=window.innerWidth<768},ye=e=>U.value.some(l=>l.fileId===e.fileId),we=e=>{ye(e)?U.value=U.value.filter(l=>l.fileId!==e.fileId):U.value.push(e)},he=async()=>{var e,i;a.value=!0;try{let a=`/fileList?page=${t.value}&size=${y.value}`;const s=await C.get(a);if(1===(null==(e=s.data)?void 0:e.code)){let e=s.data.data.records||[];const a=JSON.parse(localStorage.getItem("file-category-mapping")||"{}");e.forEach(e=>{var l;if(!a[e.fileId]){const i=null==(l=e.fileName.split(".").pop())?void 0:l.toLowerCase();let t="9";["pdf","doc","docx","txt","rtf","xls","xlsx","ppt","pptx","md","csv"].includes(i)?t="1":["jpg","jpeg","png","gif","bmp","webp","svg","ico","tiff"].includes(i)?t="2":["mp4","avi","mov","wmv","flv","webm","mkv","3gp","f4v"].includes(i)?t="3":["mp3","wav","flac","aac","ogg","wma","m4a","opus"].includes(i)?t="4":["zip","rar","7z","tar","gz","bz2","xz","tar.gz","tar.bz2"].includes(i)?t="5":["js","ts","jsx","tsx","vue","html","css","scss","sass","less","java","py","cpp","c","h","php","rb","go","rs","swift","kt","cs","vb","sql","json","xml","yaml","yml"].includes(i)?t="6":["ttf","otf","woff","woff2","eot"].includes(i)?t="7":["exe","msi","dmg","pkg","deb","rpm","apk","ipa"].includes(i)&&(t="8"),a[e.fileId]=t}}),localStorage.setItem("file-category-mapping",JSON.stringify(a)),e=e.map(e=>({...e,categoryId:a[e.fileId]||null})),ue.value&&(e=e.filter(e=>e.fileName.toLowerCase().includes(ue.value.toLowerCase()))),de.value&&(e=e.filter(e=>e.categoryId===de.value)),l.value=e,j.value=e.length}else T.error((null==(i=s.data)?void 0:i.msg)||"获取文件列表失败")}catch(s){T.error("获取文件列表失败，请检查网络")}finally{a.value=!1}},ke=e=>{U.value=e},_e=(e,l)=>{navigator.clipboard.writeText(e).then(()=>{T.success(l)}).catch(e=>{T.error("复制失败: "+e)})},xe=()=>{const e=U.value.map(e=>`[${e.fileName}](${e.downloadUrl})`).join("\n");_e(e,`已批量复制 ${U.value.length} 个 Markdown 链接`)},be=()=>{const e=U.value.map(e=>e.downloadUrl).join("\n");_e(e,`已批量复制 ${U.value.length} 个下载链接`)},Ce=async()=>{var e,l;if(0!==U.value.length)try{await H.confirm(`确定要删除选中的 ${U.value.length} 个文件吗？此操作不可撤销。`,"批量删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"});const e=U.value.map(e=>C.delete(`/file/${e.fileId}`)),l=await Promise.allSettled(e);let a=0,i=0;l.forEach((e,l)=>{"fulfilled"===e.status&&1===e.value.data.code?a++:i++}),a>0&&T.success(`成功删除 ${a} 个文件`),i>0&&T.error(`${i} 个文件删除失败`),U.value=[],he()}catch(a){"cancel"!==a&&T.error("批量删除失败: "+((null==(l=null==(e=a.response)?void 0:e.data)?void 0:l.msg)||a.message))}else T.warning("请先选择要删除的文件")},Ie=e=>new Date(1e3*e).toLocaleString("zh-CN",{hour12:!1}),ze=()=>{N.value=!0},je=async()=>{var e,l;N.value=!1;const a=T({message:"正在更新...",type:"info",duration:0});try{const a=await C.put("/file-url");1===(null==(e=a.data)?void 0:e.code)?(T.success("URL 更新成功"),he()):T.error((null==(l=a.data)?void 0:l.msg)||"URL 更新失败")}catch(i){T.error("更新失败，请检查网络")}finally{a.close()}},We=e=>{t.value=e,U.value=[],he(),oe.value&&ne.value&&(ne.value.scrollTop=0)},Xe=e=>{y.value=e,t.value=1,U.value=[],he()},Ye=e=>{_e(`[${e.fileName}](${e.downloadUrl})`,"Markdown 格式已复制")},Ze=e=>{_e(e.downloadUrl,"下载链接已复制")},Ae=e=>{window.open(e,"_blank")},el=e=>{ce.value=e,re.value=!0},ll=e=>{Ae(e.downloadUrl)},al=async e=>{var l,a;try{await H.confirm(`确定要删除文件 "${e.fileName}" 吗？此操作不可撤销。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"});const l=await C.delete(`/file/${e.fileId}`);1===l.data.code?(T.success("文件删除成功"),U.value=U.value.filter(l=>l.fileId!==e.fileId),he()):T.error(l.data.msg||"删除失败")}catch(i){"cancel"!==i&&T.error("删除文件失败: "+((null==(a=null==(l=i.response)?void 0:l.data)?void 0:a.message)||i.message))}},il=()=>{t.value=1,he()},tl=()=>{t.value=1,he()},sl=async()=>{if(fe.value.trim()){me.value=!0;try{if(ve.value.find(e=>e.name===fe.value.trim()))return void T.warning("分类名称已存在");const e={id:Date.now().toString(),name:fe.value.trim()};ve.value.push(e),localStorage.setItem("file-categories",JSON.stringify(ve.value)),T.success("分类添加成功"),fe.value=""}catch(e){T.error("添加分类失败")}finally{me.value=!1}}else T.warning("请输入分类名称")},ol=()=>{fe.value="",pe.value=!1},nl=e=>{const l=ve.value.find(l=>l.id===e);return l?l.name:"未知分类"};return w(()=>{ge(),window.addEventListener("resize",ge),he(),(async()=>{try{const e=localStorage.getItem("file-categories");e?ve.value=JSON.parse(e):(ve.value=[{id:"1",name:"文档"},{id:"2",name:"图片"},{id:"3",name:"视频"},{id:"4",name:"音频"},{id:"5",name:"压缩包"},{id:"6",name:"代码"},{id:"7",name:"字体"},{id:"8",name:"安装包"},{id:"9",name:"杂物"}],localStorage.setItem("file-categories",JSON.stringify(ve.value)))}catch(e){}})()}),h(()=>{window.removeEventListener("resize",ge)}),(e,i)=>{const w=S,h=B,C=K,ge=q,_e=G,rl=Q,cl=W,ul=X,dl=Y,vl=Z,pl=A,fl=te,ml=se,gl=ee,yl=L,wl=I,hl=le,kl=$;return n(),v("div",Ne,[c(yl,{class:"content-card"},{header:o(()=>[r("div",Se,[r("div",Ue,[c(w,null,{default:o(()=>[c(u(M))]),_:1}),i[11]||(i[11]=r("span",null,"文件列表",-1))]),r("div",Be,[c(h,{type:"primary",onClick:ze,icon:u(O)},{default:o(()=>i[12]||(i[12]=[d("更新 URL 前缀")])),_:1},8,["icon"])])])]),default:o(()=>[r("div",$e,[c(cl,{gutter:20},{default:o(()=>[c(ge,{xs:24,sm:16,md:14},{default:o(()=>[c(C,{modelValue:ue.value,"onUpdate:modelValue":i[0]||(i[0]=e=>ue.value=e),placeholder:"搜索文件名...","prefix-icon":u(J),clearable:"",onInput:il,onKeyup:k(il,["enter"]),size:"large"},{append:o(()=>[c(h,{onClick:il,icon:u(J)},{default:o(()=>i[13]||(i[13]=[d("搜索")])),_:1},8,["icon"])]),_:1},8,["modelValue","prefix-icon"])]),_:1}),c(ge,{xs:24,sm:8,md:4},{default:o(()=>[c(rl,{modelValue:de.value,"onUpdate:modelValue":i[1]||(i[1]=e=>de.value=e),placeholder:"文件分类",clearable:"",onChange:tl,size:"large",style:{width:"100%"}},{default:o(()=>[c(_e,{label:"全部分类",value:""}),(n(!0),v(_,null,x(ve.value,e=>(n(),s(_e,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),c(ge,{xs:24,sm:12,md:4},{default:o(()=>[c(h,{type:"success",onClick:i[2]||(i[2]=e=>pe.value=!0),icon:u(F),size:"large",style:{width:"100%"}},{default:o(()=>i[14]||(i[14]=[d(" 管理分类 ")])),_:1},8,["icon"])]),_:1})]),_:1})]),oe.value?g("",!0):m((n(),s(pl,{key:0,data:l.value,onSelectionChange:ke,height:"calc(100vh - 280px)",style:{width:"100%"}},{default:o(()=>[c(ul,{type:"selection",width:"55",align:"center"}),c(ul,{prop:"fileName",label:"文件名","min-width":"200","show-overflow-tooltip":"",fixed:"left"},{default:o(e=>[r("div",Te,[c(w,null,{default:o(()=>[c(u(V))]),_:1}),r("span",null,p(e.row.fileName),1)])]),_:1}),c(ul,{prop:"size",label:"大小",width:"120",align:"center"}),c(ul,{prop:"uploadTime",label:"上传时间",width:"180",align:"center"},{default:o(e=>[d(p(Ie(e.row.uploadTime)),1)]),_:1}),c(ul,{label:"分类",width:"120",align:"center"},{default:o(e=>[e.row.categoryId?(n(),s(dl,{key:0,type:"info",size:"small"},{default:o(()=>[d(p(nl(e.row.categoryId)),1)]),_:2},1024)):(n(),v("span",Le,"未分类"))]),_:1}),c(ul,{label:"操作",width:"540",align:"center",fixed:"right"},{default:o(e=>[c(vl,null,{default:o(()=>[c(h,{type:"info",size:"small",onClick:l=>el(e.row),icon:u(R)},{default:o(()=>i[15]||(i[15]=[d("预览")])),_:2},1032,["onClick","icon"]),c(h,{type:"primary",size:"small",onClick:l=>Ye(e.row),icon:u(P)},{default:o(()=>i[16]||(i[16]=[d("Markdown")])),_:2},1032,["onClick","icon"]),c(h,{type:"success",size:"small",onClick:l=>Ze(e.row),icon:u(E)},{default:o(()=>i[17]||(i[17]=[d("链接")])),_:2},1032,["onClick","icon"]),c(h,{type:"warning",size:"small",onClick:l=>Ae(e.row.downloadUrl),icon:u(z)},{default:o(()=>i[18]||(i[18]=[d("下载")])),_:2},1032,["onClick","icon"]),c(h,{type:"danger",size:"small",onClick:l=>al(e.row),icon:u(D)},{default:o(()=>i[19]||(i[19]=[d("删除")])),_:2},1032,["onClick","icon"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[kl,a.value]]),oe.value?(n(),v("div",{key:1,class:"mobile-file-list",ref_key:"mobileListRef",ref:ne},[0!==l.value.length||a.value?g("",!0):(n(),s(fl,{key:0,description:"暂无文件"})),a.value?(n(),s(ml,{key:1,rows:5,animated:""})):(n(),v("div",Me,[(n(!0),v(_,null,x(l.value,e=>(n(),v("div",{key:e.fileId,class:f(["mobile-file-item",{"is-selected":ye(e)}]),onClick:l=>we(e)},[r("div",Je,[c(u(ae),{"model-value":ye(e),onChange:()=>we(e),onClick:i[3]||(i[3]=b(()=>{},["stop"])),size:"large",class:"mobile-checkbox"},null,8,["model-value","onChange"]),c(w,{class:"file-icon"},{default:o(()=>[c(u(V))]),_:1}),r("span",Fe,p(e.fileName),1)]),r("div",Re,[r("span",null,"大小: "+p(e.size),1),r("span",null,"上传时间: "+p(Ie(e.uploadTime)),1),e.categoryId?(n(),v("span",Pe,[i[20]||(i[20]=d(" 分类: ")),c(dl,{type:"info",size:"small"},{default:o(()=>[d(p(nl(e.categoryId)),1)]),_:2},1024)])):g("",!0)]),r("div",Ee,[c(vl,null,{default:o(()=>[c(h,{type:"info",size:"small",onClick:b(l=>el(e),["stop"]),icon:u(R),circle:""},null,8,["onClick","icon"]),c(h,{type:"primary",size:"small",onClick:b(l=>Ye(e),["stop"]),icon:u(P),circle:""},null,8,["onClick","icon"]),c(h,{type:"success",size:"small",onClick:b(l=>Ze(e),["stop"]),icon:u(E),circle:""},null,8,["onClick","icon"]),c(h,{type:"warning",size:"small",onClick:b(l=>Ae(e.downloadUrl),["stop"]),icon:u(z),circle:""},null,8,["onClick","icon"]),c(h,{type:"danger",size:"small",onClick:b(l=>al(e),["stop"]),icon:u(D),circle:""},null,8,["onClick","icon"])]),_:2},1024)])],10,Oe))),128))]))],512)):g("",!0),r("div",{class:f(["footer-toolbar",{"is-mobile":oe.value}])},[r("div",De,[c(h,{type:"primary",onClick:xe,disabled:0===U.value.length,icon:u(P),plain:""},{default:o(()=>i[21]||(i[21]=[d(" 批量复制 (MD) ")])),_:1},8,["disabled","icon"]),c(h,{type:"success",onClick:be,disabled:0===U.value.length,icon:u(E),plain:""},{default:o(()=>i[22]||(i[22]=[d(" 批量复制 (链接) ")])),_:1},8,["disabled","icon"]),c(h,{type:"danger",onClick:Ce,disabled:0===U.value.length,icon:u(D),plain:""},{default:o(()=>[d(" 批量删除 ("+p(U.value.length)+") ",1)]),_:1},8,["disabled","icon"])]),j.value>0?(n(),s(gl,{key:0,"current-page":t.value,"onUpdate:currentPage":i[4]||(i[4]=e=>t.value=e),"page-size":y.value,"onUpdate:pageSize":i[5]||(i[5]=e=>y.value=e),total:j.value,"page-sizes":[10,20,50,100],layout:oe.value?"sizes, prev, pager, next":"total, sizes, prev, pager, next, jumper",onSizeChange:Xe,onCurrentChange:We,background:"",small:""},null,8,["current-page","page-size","total","layout"])):g("",!0)],2)]),_:1}),c(wl,{modelValue:N.value,"onUpdate:modelValue":i[7]||(i[7]=e=>N.value=e),title:"更新 URL 前缀",width:"500px"},{footer:o(()=>[r("span",He,[c(h,{onClick:i[6]||(i[6]=e=>N.value=!1)},{default:o(()=>i[23]||(i[23]=[d("取消")])),_:1}),c(h,{type:"primary",onClick:je},{default:o(()=>i[24]||(i[24]=[d("确认更新")])),_:1})])]),default:o(()=>[i[25]||(i[25]=r("span",null," 此操作将根据服务器最新配置，更新所有文件的下载链接前缀。当您更换了域名或IP地址后，可以使用此功能。 ",-1))]),_:1},8,["modelValue"]),c(Ve,{modelValue:re.value,"onUpdate:modelValue":i[8]||(i[8]=e=>re.value=e),"file-info":ce.value,onDownload:ll},null,8,["modelValue","file-info"]),c(wl,{modelValue:pe.value,"onUpdate:modelValue":i[10]||(i[10]=e=>pe.value=e),title:"分类管理",width:"600px","before-close":ol},{default:o(()=>[r("div",Ke,[r("div",qe,[c(C,{modelValue:fe.value,"onUpdate:modelValue":i[9]||(i[9]=e=>fe.value=e),placeholder:"输入新分类名称",onKeyup:k(sl,["enter"]),style:{width:"300px","margin-right":"10px"}},null,8,["modelValue"]),c(h,{type:"primary",onClick:sl,loading:me.value},{default:o(()=>i[26]||(i[26]=[d("添加分类")])),_:1},8,["loading"])]),c(hl),r("div",Ge,[(n(!0),v(_,null,x(ve.value,e=>(n(),v("div",{key:e.id,class:"category-item"},[c(dl,{type:"info",size:"large"},{default:o(()=>[d(p(e.name),1)]),_:2},1024),r("div",Qe,[c(h,{size:"small",onClick:l=>(async e=>{try{const{value:l}=await H.prompt("请输入新的分类名称","编辑分类",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:e.name,inputValidator:l=>l&&l.trim()?!ve.value.find(a=>a.id!==e.id&&a.name===l.trim())||"分类名称已存在":"分类名称不能为空"}),a=ve.value.findIndex(l=>l.id===e.id);-1!==a&&(ve.value[a].name=l.trim(),localStorage.setItem("file-categories",JSON.stringify(ve.value)),T.success("分类更新成功"))}catch(l){"cancel"!==l&&T.error("更新分类失败")}})(e),icon:u(ie)},{default:o(()=>i[27]||(i[27]=[d("编辑")])),_:2},1032,["onClick","icon"]),c(h,{size:"small",type:"danger",onClick:l=>(async e=>{try{await H.confirm(`确定要删除分类 "${e.name}" 吗？删除后，该分类下的文件将变为未分类状态。`,"删除分类",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),ve.value=ve.value.filter(l=>l.id!==e.id),localStorage.setItem("file-categories",JSON.stringify(ve.value));const l=JSON.parse(localStorage.getItem("file-category-mapping")||"{}");Object.keys(l).forEach(a=>{l[a]===e.id&&delete l[a]}),localStorage.setItem("file-category-mapping",JSON.stringify(l)),T.success("分类删除成功"),he()}catch(l){"cancel"!==l&&T.error("删除分类失败")}})(e),icon:u(D)},{default:o(()=>i[28]||(i[28]=[d("删除")])),_:2},1032,["onClick","icon"])])]))),128))])])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-75be0b4c"]]);export{We as default};
