import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";import"./el-collapse-transition-l0sNRNKZ.js";/* empty css                             *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                *//* empty css                     *//* empty css               *//* empty css                 */import{d as a,r as l,V as s,f as r,c as t,P as o,H as u,o as d,a as n,u as i,$ as c,R as p,O as m,Q as f,aa as g,M as v,G as _}from"./vue-vendor-B9yd_xiB.js";import{s as b}from"./request-DnKA1yHd.js";import{a as y,k as x,z as h,n as V,A as j,B as k,q as w,C as z,D as C,F as U,f as B,s as T,G as q,l as I,b as D,i as F,H as R,I as $,J as A,K as H,L,j as G,M}from"./element-plus-BmgivntE.js";import"./vendor-BVvGM7bJ.js";const J={class:"page-container"},K={class:"card-header"},O={class:"card-header"},P={class:"load-config-wrapper"},Q={key:0,class:"config-preview"},S=e(a({__name:"Home",setup(e){const a=l(),S=s({name:"",token:"",target:"",url:"",pass:""}),E=l(!1),N=l(!1),W=l(!1),X=l(!1),Y=l([]),Z=l(""),ee=l(null),ae=s({name:[{required:!0,message:"请输入配置名称",trigger:"blur"}],token:[{required:!0,message:"请输入 Bot Token",trigger:"blur"}],target:[{required:!0,message:"请输入 Chat ID",trigger:"blur"}]}),le=async()=>{W.value=!0;try{const e=await b.get("/config/configs");1===e.data.code&&Array.isArray(e.data.data)?Y.value=e.data.data:y.error("获取配置列表失败")}catch(e){y.error("获取配置列表失败，请检查网络")}finally{W.value=!1}},se=e=>{ee.value=Y.value.find(a=>a.name===e)||null},re=async()=>{a.value&&await a.value.validate(async e=>{var l,s,r;if(e){E.value=!0;try{const e=await b.post("/config",S);1===e.data.code?(y.success(e.data.msg||"配置提交成功"),null==(l=a.value)||l.resetFields(),le()):y.error(e.data.msg||"提交失败")}catch(t){y.error((null==(r=null==(s=t.response)?void 0:s.data)?void 0:r.msg)||"提交失败，请检查网络")}finally{E.value=!1}}})},te=()=>{var e;null==(e=a.value)||e.resetFields()},oe=async()=>{if(Z.value){N.value=!0;try{const e=await b.get(`/config/${Z.value}`);1===e.data.code?y.success(e.data.msg||"配置加载成功"):y.error(e.data.msg||"加载配置失败")}catch(e){y.error("加载失败，请检查网络")}finally{N.value=!1}}else y.warning("请先选择一个配置")},ue=async()=>{var e,a;if(Z.value){try{await U.confirm(`确定要删除配置 "${Z.value}" 吗？此操作不可撤销。`,"确认删除",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"})}catch{return}X.value=!0;try{const e=await b.delete(`/config/${Z.value}`);1===e.data.code?(y.success(e.data.msg||"配置删除成功"),Z.value="",ee.value=null,le()):y.error(e.data.msg||"删除配置失败")}catch(l){y.error((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.msg)||"删除失败，请检查网络")}finally{X.value=!1}}else y.warning("请先选择一个配置")};return r(()=>{le()}),(e,l)=>{const s=B,r=T,b=q,y=I,U=D,le=F,de=R,ne=x,ie=M,ce=$,pe=A,me=H,fe=L,ge=G;return d(),t("div",J,[o(ne,{class:"content-card"},{header:u(()=>[n("div",K,[o(s,null,{default:u(()=>[o(i(h))]),_:1}),l[6]||(l[6]=n("span",null,"Bot 配置",-1))])]),default:u(()=>[o(de,{ref_key:"ruleFormRef",ref:a,model:S,rules:ae,"label-position":"top",class:"config-form",onSubmit:c(re,["prevent"])},{default:u(()=>[o(U,{gutter:20},{default:u(()=>[o(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(b,{label:"配置名称",prop:"name"},{default:u(()=>[o(r,{modelValue:S.name,"onUpdate:modelValue":l[0]||(l[0]=e=>S.name=e),placeholder:"为您的配置命名","prefix-icon":i(V),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(b,{label:"Chat ID",prop:"target"},{default:u(()=>[o(r,{modelValue:S.target,"onUpdate:modelValue":l[1]||(l[1]=e=>S.target=e),placeholder:"请输入接收文件的频道/用户 ID","prefix-icon":i(j),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(y,{xs:24,sm:24,md:24,lg:24,xl:24},{default:u(()=>[o(b,{label:"Bot Token",prop:"token"},{default:u(()=>[o(r,{modelValue:S.token,"onUpdate:modelValue":l[2]||(l[2]=e=>S.token=e),placeholder:"请输入 Telegram Bot Token","prefix-icon":i(k),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(b,{label:"自定义 URL (选填)",prop:"url"},{default:u(()=>[o(r,{modelValue:S.url,"onUpdate:modelValue":l[3]||(l[3]=e=>S.url=e),placeholder:"用于生成下载链接的域名","prefix-icon":i(w),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(y,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(b,{label:"访问密码 (选填)",prop:"pass"},{default:u(()=>[o(r,{modelValue:S.pass,"onUpdate:modelValue":l[4]||(l[4]=e=>S.pass=e),type:"password",placeholder:"为配置设置访问密码","show-password":"","prefix-icon":i(z),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1})]),_:1}),o(b,{class:"form-actions"},{default:u(()=>[o(le,{type:"primary","native-type":"submit",loading:E.value,size:"large"},{default:u(()=>[p(m(E.value?"提交中...":"保存并提交"),1)]),_:1},8,["loading"]),o(le,{onClick:te,size:"large"},{default:u(()=>l[7]||(l[7]=[p("重置表单")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(ne,{class:"content-card"},{header:u(()=>[n("div",O,[o(s,null,{default:u(()=>[o(i(C))]),_:1}),l[8]||(l[8]=n("span",null,"加载现有配置",-1))])]),default:u(()=>[n("div",P,[o(ce,{modelValue:Z.value,"onUpdate:modelValue":l[5]||(l[5]=e=>Z.value=e),placeholder:"请选择一个配置文件进行加载",class:"config-select",size:"large",loading:W.value,onChange:se,filterable:""},{default:u(()=>[(d(!0),t(f,null,g(Y.value,e=>(d(),_(ie,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),o(le,{type:"success",onClick:oe,loading:N.value,disabled:!Z.value,size:"large",plain:""},{default:u(()=>l[9]||(l[9]=[p(" 加载选中配置 ")])),_:1},8,["loading","disabled"]),o(le,{type:"danger",onClick:ue,loading:X.value,disabled:!Z.value,size:"large",plain:""},{default:u(()=>l[10]||(l[10]=[p(" 删除配置 ")])),_:1},8,["loading","disabled"])]),o(ge,null,{default:u(()=>[ee.value?(d(),t("div",Q,[o(pe),l[11]||(l[11]=n("h3",null,"配置预览",-1)),o(fe,{column:1,border:"",size:"small"},{default:u(()=>[o(me,{label:"名称"},{default:u(()=>[p(m(ee.value.name),1)]),_:1}),o(me,{label:"Token"},{default:u(()=>[p(m(ee.value.token),1)]),_:1}),o(me,{label:"Chat ID"},{default:u(()=>[p(m(ee.value.target),1)]),_:1}),o(me,{label:"URL"},{default:u(()=>[p(m(ee.value.url||"未设置"),1)]),_:1}),o(me,{label:"密码"},{default:u(()=>[p(m(ee.value.pass?"******":"未设置"),1)]),_:1})]),_:1})])):v("",!0)]),_:1})]),_:1})])}}}),[["__scopeId","data-v-8a5d5fcf"]]);export{S as default};
