import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                         *//* empty css                   *//* empty css                        *//* empty css                  *//* empty css                     */import{t as a,r as t,c as o,av as s,f as l,U as n,D as i,E as c,M as r,A as d,u,v as m,H as p,I as _,J as f,K as v,ab as g,T as h,x as k}from"./vue-vendor-BNZdp1ez.js";import{ae as y,af as w,ag as b,ah as x,h as C,Z as j,ai as L,aj as T,ak as I,i as E,al as S,am as B,j as D,y as M,an as G,ao as U,ap as q,aq as z,B as A,ar as R,G as H,E as J}from"./element-plus-CgPdM7LF.js";import{u as K}from"./index-DrHwzDkJ.js";import"./vendor-JtNx7una.js";const P={class:"header-content"},Z={class:"logo"},F={class:"actions"},N={class:"el-dropdown-link",style:{outline:"none",cursor:"pointer"}},O={key:0,class:"user-nav-desktop"},Q={class:"user-info"},V={class:"user-details"},W={class:"username"},X={class:"user-role"},Y={class:"dropdown-user-info"},$={class:"dropdown-username"},ee={class:"dropdown-email"},ae={class:"footer-content"},te={class:"footer-links"},oe=e(a({__name:"Layout",setup(e){const a=s(),oe=t("auto"),se=K(),le=o(()=>se.isLoggedIn),ne=o(()=>se.role),ie=o(()=>se.username||"用户"),ce=o(()=>se.email||""),re=o(()=>se.userRoleText);o(()=>a.currentRoute.value.path);const de=o(()=>"light"===oe.value?y:"dark"===oe.value?w:b),ue=()=>{document.body.classList.add("theme-switching"),setTimeout(()=>{if("auto"===oe.value){const e=window.matchMedia("(prefers-color-scheme: dark)");document.documentElement.classList.toggle("dark",e.matches)}else document.documentElement.classList.toggle("dark","dark"===oe.value)},80),setTimeout(()=>{document.body.classList.remove("theme-switching")},600)},me=e=>{oe.value=e,localStorage.setItem("theme",e),"vibrate"in navigator&&navigator.vibrate(50),ue()},pe=e=>{"auto"===oe.value&&(document.body.classList.add("theme-switching"),setTimeout(()=>{document.documentElement.classList.toggle("dark",e.matches)},80),setTimeout(()=>{document.body.classList.remove("theme-switching")},600))};l(()=>{se.initUserInfo();const e=localStorage.getItem("theme");oe.value=e||"auto",ue(),(()=>{const e=document.body;e.style.backgroundImage="",e.style.backgroundColor="#ffffff";const a=document.querySelector(".background-overlay");a&&a.remove()})(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",pe)}),n(()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",pe)});const _e=()=>{a.push("/login")},fe=()=>{a.push("/about")},ve=()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("role");e&&"visitor"!==t?a.push("/home"):H.alert("您当前是访客，请使用管理员账号登录！","权限提示",{confirmButtonText:"确定",type:"warning"})},ge=e=>{"logout"===e&&Ce()},he=()=>{a.push("/user/home")},ke=()=>{a.push("/user/upload")},ye=()=>{a.push("/user/changePassword")},we=()=>{a.push("/agreement")},be=()=>{a.push("/privacy")},xe=e=>{switch(e){case"home":he();break;case"upload":ke();break;case"password":ye()}},Ce=()=>{H.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{se.clearUserInfo(),J.success("已退出登录"),a.push("/login")}).catch(()=>{})};return(e,a)=>{const t=C,o=I,s=T,l=L,n=E,H=G,J=q,K=g("router-view"),oe=z,se=A,ue=R,pe=x;return k(),i(pe,{class:"layout-container"},{default:c(()=>[r(J,{class:"header"},{default:c(()=>[d("div",P,[d("div",Z,[r(t,{class:"logo-icon"},{default:c(()=>[r(u(j))]),_:1}),a[0]||(a[0]=d("div",{class:"logo-text"},[d("span",{class:"main-title"},"TG-Drive")],-1))]),d("div",F,[r(l,{onCommand:me,trigger:"click"},{dropdown:c(()=>[r(s,null,{default:c(()=>[r(o,{command:"light",icon:u(y)},{default:c(()=>a[1]||(a[1]=[f("亮色模式",-1)])),_:1,__:[1]},8,["icon"]),r(o,{command:"dark",icon:u(w)},{default:c(()=>a[2]||(a[2]=[f("暗色模式",-1)])),_:1,__:[2]},8,["icon"]),r(o,{command:"auto",icon:u(b)},{default:c(()=>a[3]||(a[3]=[f("跟随系统",-1)])),_:1,__:[3]},8,["icon"])]),_:1})]),default:c(()=>[d("span",N,[r(t,{size:20},{default:c(()=>[(k(),i(_(de.value)))]),_:1})])]),_:1}),le.value&&"user"===ne.value?(k(),m("div",O,[r(n,{type:"text",onClick:he},{default:c(()=>a[4]||(a[4]=[f("我的文件",-1)])),_:1,__:[4]}),r(n,{type:"text",onClick:ke},{default:c(()=>a[5]||(a[5]=[f("上传文件",-1)])),_:1,__:[5]}),r(n,{type:"text",onClick:ye},{default:c(()=>a[6]||(a[6]=[f("修改密码",-1)])),_:1,__:[6]})])):p("",!0),le.value&&"user"===ne.value?(k(),i(l,{key:1,class:"user-nav-mobile",onCommand:xe,trigger:"click"},{dropdown:c(()=>[r(s,null,{default:c(()=>[r(o,{command:"home",icon:u(B)},{default:c(()=>a[8]||(a[8]=[f("我的文件",-1)])),_:1,__:[8]},8,["icon"]),r(o,{command:"upload",icon:u(D)},{default:c(()=>a[9]||(a[9]=[f("上传文件",-1)])),_:1,__:[9]},8,["icon"]),r(o,{command:"password",icon:u(M)},{default:c(()=>a[10]||(a[10]=[f("修改密码",-1)])),_:1,__:[10]},8,["icon"])]),_:1})]),default:c(()=>[r(n,{type:"text",icon:u(S)},{default:c(()=>a[7]||(a[7]=[f(" 菜单 ",-1)])),_:1,__:[7]},8,["icon"])]),_:1})):p("",!0),r(n,{type:"info",plain:"",onClick:fe},{default:c(()=>a[11]||(a[11]=[f("关于",-1)])),_:1,__:[11]}),"admin"===ne.value?(k(),i(n,{key:2,type:"primary",plain:"",onClick:ve},{default:c(()=>a[12]||(a[12]=[f("管理",-1)])),_:1,__:[12]})):p("",!0),le.value?(k(),i(l,{key:4,onCommand:ge,trigger:"click"},{dropdown:c(()=>[r(s,null,{default:c(()=>[r(o,{disabled:""},{default:c(()=>[d("div",Y,[d("div",$,v(ie.value),1),d("div",ee,v(ce.value),1)])]),_:1}),r(o,{divided:"",command:"logout",icon:u(U)},{default:c(()=>a[14]||(a[14]=[f("退出登录",-1)])),_:1,__:[14]},8,["icon"])]),_:1})]),default:c(()=>[d("div",Q,[r(H,{size:32,src:"/public/favicon.ico",style:{cursor:"pointer"}}),d("div",V,[d("div",W,v(ie.value),1),d("div",X,v(re.value),1)])])]),_:1})):(k(),i(n,{key:3,type:"primary",onClick:_e},{default:c(()=>a[13]||(a[13]=[f("登录",-1)])),_:1,__:[13]}))])])]),_:1}),r(oe,{class:"main-content"},{default:c(()=>[r(K,null,{default:c(({Component:e})=>[r(h,{name:"fade",mode:"out-in"},{default:c(()=>[(k(),i(_(e)))]),_:2},1024)]),_:1})]),_:1}),r(ue,{class:"footer"},{default:c(()=>[d("div",ae,[d("div",te,[r(n,{type:"text",onClick:fe,class:"footer-link"},{default:c(()=>a[15]||(a[15]=[f(" 关于我们 ",-1)])),_:1,__:[15]}),r(se,{direction:"vertical"}),r(n,{type:"text",onClick:we,class:"footer-link"},{default:c(()=>a[16]||(a[16]=[f(" 用户协议 ",-1)])),_:1,__:[16]}),r(se,{direction:"vertical"}),r(n,{type:"text",onClick:be,class:"footer-link"},{default:c(()=>a[17]||(a[17]=[f(" 隐私政策 ",-1)])),_:1,__:[17]})]),a[18]||(a[18]=d("div",{class:"footer-copyright"},[d("span",null,"© 2025 TG-Drive. All rights reserved.")],-1))])]),_:1})]),_:1})}}}),[["__scopeId","data-v-56111045"]]);export{oe as default};
