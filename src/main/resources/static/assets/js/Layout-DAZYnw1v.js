import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                         *//* empty css                   *//* empty css                        *//* empty css                  *//* empty css                     */import{d as a,r as t,b as o,av as s,l,U as n,D as i,E as c,o as r,M as d,a as u,u as m,c as p,H as _,I as f,J as v,K as g,ab as h,T as k}from"./vue-vendor-Cc5FuWtX.js";import{ae as y,af as w,ag as b,ah as x,h as C,Z as j,ai as L,aj as T,ak as I,i as E,al as S,am as B,j as M,y as D,an as G,ao as U,ap as q,aq as z,B as A,ar as R,G as F,c as H}from"./element-plus-D2f55jhA.js";import{u as J}from"./user-CqZQgeNy.js";import"./index-BNZ_jOiX.js";const K={class:"header-content"},P={class:"logo"},Z={class:"actions"},N={class:"el-dropdown-link",style:{outline:"none",cursor:"pointer"}},O={key:0,class:"user-nav-desktop"},Q={class:"user-info"},V={class:"user-details"},W={class:"username"},X={class:"user-role"},Y={class:"dropdown-user-info"},$={class:"dropdown-username"},ee={class:"dropdown-email"},ae={class:"footer-content"},te={class:"footer-links"},oe=e(a({__name:"Layout",setup(e){const a=s(),oe=t("auto"),se=J(),le=o(()=>se.isLoggedIn),ne=o(()=>se.role),ie=o(()=>se.username||"用户"),ce=o(()=>se.email||""),re=o(()=>se.userRoleText);o(()=>a.currentRoute.value.path);const de=o(()=>"light"===oe.value?y:"dark"===oe.value?w:b),ue=()=>{document.body.classList.add("theme-switching"),setTimeout(()=>{if("auto"===oe.value){const e=window.matchMedia("(prefers-color-scheme: dark)");document.documentElement.classList.toggle("dark",e.matches)}else document.documentElement.classList.toggle("dark","dark"===oe.value)},80),setTimeout(()=>{document.body.classList.remove("theme-switching")},600)},me=e=>{oe.value=e,localStorage.setItem("theme",e),"vibrate"in navigator&&navigator.vibrate(50),ue()},pe=e=>{"auto"===oe.value&&(document.body.classList.add("theme-switching"),setTimeout(()=>{document.documentElement.classList.toggle("dark",e.matches)},80),setTimeout(()=>{document.body.classList.remove("theme-switching")},600))};l(()=>{se.initUserInfo();const e=localStorage.getItem("theme");oe.value=e||"auto",ue(),(()=>{const e=document.body;e.style.backgroundImage="",e.style.backgroundColor="#ffffff";const a=document.querySelector(".background-overlay");a&&a.remove()})(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",pe)}),n(()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",pe)});const _e=()=>{a.push("/login")},fe=()=>{a.push("/about")},ve=()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("role");e&&"visitor"!==t?a.push("/home"):F.alert("您当前是访客，请使用管理员账号登录！","权限提示",{confirmButtonText:"确定",type:"warning"})},ge=e=>{"logout"===e&&Ce()},he=()=>{a.push("/user/home")},ke=()=>{a.push("/user/upload")},ye=()=>{a.push("/user/changePassword")},we=()=>{a.push("/agreement")},be=()=>{a.push("/privacy")},xe=e=>{switch(e){case"home":he();break;case"upload":ke();break;case"password":ye()}},Ce=()=>{F.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{se.clearUserInfo(),H.success("已退出登录"),a.push("/login")}).catch(()=>{})};return(e,a)=>{const t=C,o=I,s=T,l=L,n=E,F=G,H=q,J=h("router-view"),oe=z,se=A,ue=R,pe=x;return r(),i(pe,{class:"layout-container"},{default:c(()=>[d(H,{class:"header"},{default:c(()=>[u("div",K,[u("div",P,[d(t,{class:"logo-icon"},{default:c(()=>[d(m(j))]),_:1}),a[0]||(a[0]=u("div",{class:"logo-text"},[u("span",{class:"main-title"},"TG-Drive")],-1))]),u("div",Z,[d(l,{onCommand:me,trigger:"click"},{dropdown:c(()=>[d(s,null,{default:c(()=>[d(o,{command:"light",icon:m(y)},{default:c(()=>a[1]||(a[1]=[v("亮色模式",-1)])),_:1,__:[1]},8,["icon"]),d(o,{command:"dark",icon:m(w)},{default:c(()=>a[2]||(a[2]=[v("暗色模式",-1)])),_:1,__:[2]},8,["icon"]),d(o,{command:"auto",icon:m(b)},{default:c(()=>a[3]||(a[3]=[v("跟随系统",-1)])),_:1,__:[3]},8,["icon"])]),_:1})]),default:c(()=>[u("span",N,[d(t,{size:20},{default:c(()=>[(r(),i(f(de.value)))]),_:1})])]),_:1}),le.value&&"user"===ne.value?(r(),p("div",O,[d(n,{type:"text",onClick:he},{default:c(()=>a[4]||(a[4]=[v("我的文件",-1)])),_:1,__:[4]}),d(n,{type:"text",onClick:ke},{default:c(()=>a[5]||(a[5]=[v("上传文件",-1)])),_:1,__:[5]}),d(n,{type:"text",onClick:ye},{default:c(()=>a[6]||(a[6]=[v("修改密码",-1)])),_:1,__:[6]})])):_("",!0),le.value&&"user"===ne.value?(r(),i(l,{key:1,class:"user-nav-mobile",onCommand:xe,trigger:"click"},{dropdown:c(()=>[d(s,null,{default:c(()=>[d(o,{command:"home",icon:m(B)},{default:c(()=>a[8]||(a[8]=[v("我的文件",-1)])),_:1,__:[8]},8,["icon"]),d(o,{command:"upload",icon:m(M)},{default:c(()=>a[9]||(a[9]=[v("上传文件",-1)])),_:1,__:[9]},8,["icon"]),d(o,{command:"password",icon:m(D)},{default:c(()=>a[10]||(a[10]=[v("修改密码",-1)])),_:1,__:[10]},8,["icon"])]),_:1})]),default:c(()=>[d(n,{type:"text",icon:m(S)},{default:c(()=>a[7]||(a[7]=[v(" 菜单 ",-1)])),_:1,__:[7]},8,["icon"])]),_:1})):_("",!0),d(n,{type:"info",plain:"",onClick:fe},{default:c(()=>a[11]||(a[11]=[v("关于",-1)])),_:1,__:[11]}),"admin"===ne.value?(r(),i(n,{key:2,type:"primary",plain:"",onClick:ve},{default:c(()=>a[12]||(a[12]=[v("管理",-1)])),_:1,__:[12]})):_("",!0),le.value?(r(),i(l,{key:4,onCommand:ge,trigger:"click"},{dropdown:c(()=>[d(s,null,{default:c(()=>[d(o,{disabled:""},{default:c(()=>[u("div",Y,[u("div",$,g(ie.value),1),u("div",ee,g(ce.value),1)])]),_:1}),d(o,{divided:"",command:"logout",icon:m(U)},{default:c(()=>a[14]||(a[14]=[v("退出登录",-1)])),_:1,__:[14]},8,["icon"])]),_:1})]),default:c(()=>[u("div",Q,[d(F,{size:32,src:"/public/favicon.ico",style:{cursor:"pointer"}}),u("div",V,[u("div",W,g(ie.value),1),u("div",X,g(re.value),1)])])]),_:1})):(r(),i(n,{key:3,type:"primary",onClick:_e},{default:c(()=>a[13]||(a[13]=[v("登录",-1)])),_:1,__:[13]}))])])]),_:1}),d(oe,{class:"main-content"},{default:c(()=>[d(J,null,{default:c(({Component:e})=>[d(k,{name:"fade",mode:"out-in"},{default:c(()=>[(r(),i(f(e)))]),_:2},1024)]),_:1})]),_:1}),d(ue,{class:"footer"},{default:c(()=>[u("div",ae,[u("div",te,[d(n,{type:"text",onClick:fe,class:"footer-link"},{default:c(()=>a[15]||(a[15]=[v(" 关于我们 ",-1)])),_:1,__:[15]}),d(se,{direction:"vertical"}),d(n,{type:"text",onClick:we,class:"footer-link"},{default:c(()=>a[16]||(a[16]=[v(" 用户协议 ",-1)])),_:1,__:[16]}),d(se,{direction:"vertical"}),d(n,{type:"text",onClick:be,class:"footer-link"},{default:c(()=>a[17]||(a[17]=[v(" 隐私政策 ",-1)])),_:1,__:[17]})]),a[18]||(a[18]=u("div",{class:"footer-copyright"},[u("span",null,"© 2025 TG-Drive. All rights reserved.")],-1))])]),_:1})]),_:1})}}}),[["__scopeId","data-v-56111045"]]);export{oe as default};
