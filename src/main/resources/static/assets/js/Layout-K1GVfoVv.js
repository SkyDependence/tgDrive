import{_ as e}from"./_plugin-vue_export-helper-Bm9C0Znx.js";import{u as a}from"./useSEO-CJTzPpgI.js";/* empty css                        *//* empty css                  *//* empty css                     */import{d as t,b as o,j as s,f as n,z as l,H as c,I as r,aw as d,ae as i,o as u,Q as m,a as p,u as g,S as f,M as y,T as v}from"./vue-vendor-uyOI1CZy.js";import{a8 as h,_ as k,a9 as _,aa as b,ab as w,ac as S,y as j,a as x,d as I,ad as C,ae as E,af as L,f as T,ag as z,ah as M,ai as q}from"./element-plus-Kv_AC7qh.js";import{s as B}from"./request-DEbmt4v_.js";import"./vendor-DlW7-jsh.js";const A={class:"header-content"},U={class:"logo"},$={class:"actions"},D={class:"el-dropdown-link",style:{outline:"none",cursor:"pointer"}},G=e(t({__name:"Layout",setup(e){const t=d(),G=o("auto");a();const H=s(()=>!!localStorage.getItem("token")),N=s(()=>"light"===G.value?_:"dark"===G.value?b:w),O=()=>{if("auto"===G.value){const e=window.matchMedia("(prefers-color-scheme: dark)");document.documentElement.classList.toggle("dark",e.matches)}else document.documentElement.classList.toggle("dark","dark"===G.value)},P=e=>{G.value=e,localStorage.setItem("theme",e),O()},Q=e=>{"auto"===G.value&&document.documentElement.classList.toggle("dark",e.matches)},R=e=>{const a=document.body;if(e.enabled&&e.imageUrl){a.style.backgroundImage=`url(${e.imageUrl})`,a.style.backgroundSize=e.mode||"cover",a.style.backgroundRepeat="repeat"===e.mode?"repeat":"no-repeat",a.style.backgroundPosition="center",a.style.backgroundAttachment="fixed"===e.mode?"fixed":"scroll";let t=document.querySelector(".background-overlay");if(t)t.style.opacity=""+(100-(e.opacity||80))/100;else{const t=document.createElement("div");t.className="background-overlay",t.style.cssText=`\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background-color: var(--el-bg-color);\n        opacity: ${(100-(e.opacity||80))/100};\n        pointer-events: none;\n        z-index: -1;\n      `,a.appendChild(t)}}else{a.style.backgroundImage="";const e=document.querySelector(".background-overlay");e&&e.remove()}};n(()=>{const e=localStorage.getItem("theme");G.value=e||"auto",O(),(async()=>{try{const e=await B.get("/api/misc/background");if(e.data.success){const a=e.data.data;R(a)}}catch(e){}})(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",Q)}),l(()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",Q)});const F=()=>{t.push("/login")},J=()=>{t.push("/about")},K=()=>{const e=localStorage.getItem("token"),a=localStorage.getItem("role");e&&"visitor"!==a?t.push("/home"):j.alert("您当前是访客，请使用管理员账号登录！","权限提示",{confirmButtonText:"确定",type:"warning"})},V=e=>{"logout"===e&&W()},W=()=>{j.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{localStorage.removeItem("token"),localStorage.removeItem("role"),x.success("已退出登录"),t.push("/login")}).catch(()=>{})};return(e,a)=>{const t=I,o=C,s=E,n=L,l=T,d=z,j=M,x=i("router-view"),B=q,G=h;return u(),c(G,{class:"layout-container"},{default:r(()=>[m(j,{class:"header"},{default:r(()=>[p("div",A,[p("div",U,[m(t,{class:"logo-icon"},{default:r(()=>[m(g(k))]),_:1}),a[0]||(a[0]=p("div",{class:"logo-text"},[p("span",{class:"main-title"},"TG-Drive"),p("span",{class:"sub-title"},"Stanley_Legend")],-1))]),p("div",$,[m(n,{onCommand:P,trigger:"click"},{dropdown:r(()=>[m(s,null,{default:r(()=>[m(o,{command:"light",icon:g(_)},{default:r(()=>a[1]||(a[1]=[f("亮色模式")])),_:1},8,["icon"]),m(o,{command:"dark",icon:g(b)},{default:r(()=>a[2]||(a[2]=[f("暗色模式")])),_:1},8,["icon"]),m(o,{command:"auto",icon:g(w)},{default:r(()=>a[3]||(a[3]=[f("跟随系统")])),_:1},8,["icon"])]),_:1})]),default:r(()=>[p("span",D,[m(t,{size:20},{default:r(()=>[(u(),c(y(N.value)))]),_:1})])]),_:1}),m(l,{type:"info",plain:"",onClick:J},{default:r(()=>a[4]||(a[4]=[f("关于")])),_:1}),m(l,{type:"primary",plain:"",onClick:K},{default:r(()=>a[5]||(a[5]=[f("管理")])),_:1}),H.value?(u(),c(n,{key:1,onCommand:V,trigger:"click"},{dropdown:r(()=>[m(s,null,{default:r(()=>[m(o,{command:"logout",icon:g(S)},{default:r(()=>a[7]||(a[7]=[f("退出登录")])),_:1},8,["icon"])]),_:1})]),default:r(()=>[m(d,{size:32,src:"/110871356.jpg",style:{cursor:"pointer"}})]),_:1})):(u(),c(l,{key:0,type:"primary",onClick:F},{default:r(()=>a[6]||(a[6]=[f("登录")])),_:1}))])])]),_:1}),m(B,{class:"main-content"},{default:r(()=>[m(x,null,{default:r(({Component:e})=>[m(v,{name:"fade",mode:"out-in"},{default:r(()=>[(u(),c(y(e)))]),_:2},1024)]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-00e17cf4"]]);export{G as default};
