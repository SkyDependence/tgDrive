import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                               *//* empty css                             *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                *//* empty css                     *//* empty css                 */import{d as a,r as l,V as s,l as r,c as t,M as o,E as u,o as d,R as n,u as i,J as c,K as p,a as m,L as f,a9 as g,H as v,D as _}from"./vue-vendor-CxLOoai_.js";import{s as x}from"./request-DvzUJvtB.js";import{d as y,b,q as h,a as j,c as V,r as k,s as w,m as z,w as C,x as U,o as B,y as T,h as q,f as D,z as I,A as F,j as R,B as A,C as H,D as L,F as $,G as E,H as G}from"./element-plus-DQjCWvVU.js";import"./vendor-CPGCUlN1.js";import"./user-CWlPWJjU.js";import"./index-CLLrkTrC.js";const J={class:"page-container"},K={class:"card-header"},M={class:"card-header"},S={class:"load-config-wrapper"},N={key:0,class:"config-preview"},O=e(a({__name:"Home",setup(e){const a=l(),O=s({name:"",token:"",target:"",url:"",pass:""}),P=l(!1),Q=l(!1),W=l(!1),X=l(!1),Y=l([]),Z=l(""),ee=l(null),ae=s({name:[{required:!0,message:"请输入配置名称",trigger:"blur"}],token:[{required:!0,message:"请输入 Bot Token",trigger:"blur"}],target:[{required:!0,message:"请输入 Chat ID",trigger:"blur"}]}),le=async()=>{W.value=!0;try{const e=await x.get("/config/configs");1===e.data.code&&Array.isArray(e.data.data)?Y.value=e.data.data:b.error("获取配置列表失败")}catch(e){b.error("获取配置列表失败，请检查网络")}finally{W.value=!1}},se=e=>{ee.value=Y.value.find(a=>a.name===e)||null},re=async()=>{a.value&&await a.value.validate(async e=>{var l,s,r;if(e){P.value=!0;try{const e=await x.post("/config",O);1===e.data.code?(b.success(e.data.msg||"配置提交成功"),null==(l=a.value)||l.resetFields(),le()):b.error(e.data.msg||"提交失败")}catch(t){b.error((null==(r=null==(s=t.response)?void 0:s.data)?void 0:r.msg)||"提交失败，请检查网络")}finally{P.value=!1}}})},te=()=>{var e;null==(e=a.value)||e.resetFields()},oe=async()=>{if(Z.value){Q.value=!0;try{const e=await x.get(`/config/${Z.value}`);1===e.data.code?b.success(e.data.msg||"配置加载成功"):b.error(e.data.msg||"加载配置失败")}catch(e){b.error("加载失败，请检查网络")}finally{Q.value=!1}}else b.warning("请先选择一个配置")},ue=async()=>{var e,a;if(Z.value){try{await E.confirm(`确定要删除配置 "${Z.value}" 吗？此操作不可撤销。`,"确认删除",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"})}catch{return}X.value=!0;try{const e=await x.delete(`/config/${Z.value}`);1===e.data.code?(b.success(e.data.msg||"配置删除成功"),Z.value="",ee.value=null,le()):b.error(e.data.msg||"删除配置失败")}catch(l){b.error((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.msg)||"删除失败，请检查网络")}finally{X.value=!1}}else b.warning("请先选择一个配置")};return r(()=>{le()}),(e,l)=>{const s=D,r=w,x=k,b=V,E=j,le=q,de=h,ne=y,ie=G,ce=F,pe=A,me=L,fe=H,ge=R;return d(),t("div",J,[o(ne,{class:"content-card"},{header:u(()=>[m("div",K,[o(s,null,{default:u(()=>[o(i(I))]),_:1}),l[6]||(l[6]=m("span",null,"Bot 配置",-1))])]),default:u(()=>[o(de,{ref_key:"ruleFormRef",ref:a,model:O,rules:ae,"label-position":"top",class:"config-form",onSubmit:n(re,["prevent"])},{default:u(()=>[o(E,{gutter:20},{default:u(()=>[o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"配置名称",prop:"name"},{default:u(()=>[o(r,{modelValue:O.name,"onUpdate:modelValue":l[0]||(l[0]=e=>O.name=e),placeholder:"为您的配置命名","prefix-icon":i(z),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"Chat ID",prop:"target"},{default:u(()=>[o(r,{modelValue:O.target,"onUpdate:modelValue":l[1]||(l[1]=e=>O.target=e),placeholder:"请输入接收文件的频道/用户 ID","prefix-icon":i(C),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:24,lg:24,xl:24},{default:u(()=>[o(x,{label:"Bot Token",prop:"token"},{default:u(()=>[o(r,{modelValue:O.token,"onUpdate:modelValue":l[2]||(l[2]=e=>O.token=e),placeholder:"请输入 Telegram Bot Token","prefix-icon":i(U),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"自定义 URL (选填)",prop:"url"},{default:u(()=>[o(r,{modelValue:O.url,"onUpdate:modelValue":l[3]||(l[3]=e=>O.url=e),placeholder:"用于生成下载链接的域名","prefix-icon":i(B),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),o(b,{xs:24,sm:24,md:12,lg:12,xl:12},{default:u(()=>[o(x,{label:"访问密码 (选填)",prop:"pass"},{default:u(()=>[o(r,{modelValue:O.pass,"onUpdate:modelValue":l[4]||(l[4]=e=>O.pass=e),type:"password",placeholder:"为配置设置访问密码","show-password":"","prefix-icon":i(T),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1})]),_:1}),o(x,{class:"form-actions"},{default:u(()=>[o(le,{type:"primary","native-type":"submit",loading:P.value,size:"large"},{default:u(()=>[c(p(P.value?"提交中...":"保存并提交"),1)]),_:1},8,["loading"]),o(le,{onClick:te,size:"large"},{default:u(()=>l[7]||(l[7]=[c("重置表单")])),_:1,__:[7]})]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(ne,{class:"content-card"},{header:u(()=>[m("div",M,[o(s,null,{default:u(()=>[o(i($))]),_:1}),l[8]||(l[8]=m("span",null,"加载现有配置",-1))])]),default:u(()=>[m("div",S,[o(ce,{modelValue:Z.value,"onUpdate:modelValue":l[5]||(l[5]=e=>Z.value=e),placeholder:"请选择一个配置文件进行加载",class:"config-select",size:"large",loading:W.value,onChange:se,filterable:""},{default:u(()=>[(d(!0),t(f,null,g(Y.value,e=>(d(),_(ie,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),o(le,{type:"success",onClick:oe,loading:Q.value,disabled:!Z.value,size:"large",plain:""},{default:u(()=>l[9]||(l[9]=[c(" 加载选中配置 ")])),_:1,__:[9]},8,["loading","disabled"]),o(le,{type:"danger",onClick:ue,loading:X.value,disabled:!Z.value,size:"large",plain:""},{default:u(()=>l[10]||(l[10]=[c(" 删除配置 ")])),_:1,__:[10]},8,["loading","disabled"])]),o(ge,null,{default:u(()=>[ee.value?(d(),t("div",N,[o(pe),l[11]||(l[11]=m("h3",null,"配置预览",-1)),o(fe,{column:1,border:"",size:"small"},{default:u(()=>[o(me,{label:"名称"},{default:u(()=>[c(p(ee.value.name),1)]),_:1}),o(me,{label:"Token"},{default:u(()=>[c(p(ee.value.token),1)]),_:1}),o(me,{label:"Chat ID"},{default:u(()=>[c(p(ee.value.target),1)]),_:1}),o(me,{label:"URL"},{default:u(()=>[c(p(ee.value.url||"未设置"),1)]),_:1}),o(me,{label:"密码"},{default:u(()=>[c(p(ee.value.pass?"******":"未设置"),1)]),_:1})]),_:1})])):v("",!0)]),_:1})]),_:1})])}}}),[["__scopeId","data-v-8a5d5fcf"]]);export{O as default};
