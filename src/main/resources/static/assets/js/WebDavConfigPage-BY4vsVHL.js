import{_ as e}from"./_plugin-vue_export-helper-DvehuVrX.js";/* empty css                 *//* empty css                *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                   */import{d as l,b as a,q as t,B as d,f as o,z as i,r as s,aF as n,s as r,_ as u,A as c,H as p,aG as m,aH as b,h as f,a5 as _,X as v,aI as g,aJ as w,aC as V,G as x}from"./element-plus-DQjCWvVU.js";import{a as h}from"./vendor-CPGCUlN1.js";import{d as y,r as D,V as A,b as W,l as U,c as j,M as C,D as k,H as M,E as q,o as P,J as S,u as z,a as B,K as R}from"./vue-vendor-CxLOoai_.js";const F={class:"webdav-config-container"},T={class:"usage-content"},E={class:"webdav-url"},H=e(y({__name:"WebDavConfigPage",setup(e){const y=D(),H=D(!1),$=D(!1),G=A({enabled:!0,pathPrefix:"/webdav",requireAuth:!0,allowedRoles:"admin",maxUploadSize:100,allowMkdir:!0,allowDelete:!0,allowMove:!0,allowCopy:!0,description:"WebDAV服务配置"}),I={pathPrefix:[{required:!0,message:"请输入访问路径",trigger:"blur"},{pattern:/^\/.*/,message:"路径必须以/开头",trigger:"blur"}],allowedRoles:[{required:!0,message:"请选择允许的角色",trigger:"change"}],maxUploadSize:[{required:!0,message:"请输入最大上传大小",trigger:"blur"},{type:"number",min:1,max:1024,message:"大小必须在1-1024MB之间",trigger:"blur"}]},J=W(()=>`${window.location.protocol}//${window.location.host}${G.pathPrefix}`),O=async()=>{try{const e=await h.get("/api/webdav-config");1===e.data.code?Object.assign(G,e.data.data):a.error(e.data.msg||"加载配置失败")}catch(e){a.error("加载配置失败")}},K=async()=>{if(y.value)try{await y.value.validate(),H.value=!0;const e=await h.put("/api/webdav-config",G);1===e.data.code?a.success("配置保存成功"):a.error(e.data.msg||"配置保存失败")}catch(e){a.error("配置保存失败")}finally{H.value=!1}},L=()=>{y.value&&(y.value.resetFields(),O())},N=async()=>{try{await x.confirm("确定要恢复默认配置吗？这将覆盖当前所有设置。","确认恢复默认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),$.value=!0;const e=await h.post("/api/webdav-config/reset");1===e.data.code?(a.success("已恢复默认配置"),await O()):a.error(e.data.msg||"恢复默认配置失败")}catch(e){"cancel"!==e&&a.error("恢复默认配置失败")}finally{$.value=!1}},X=e=>{e||x.confirm("禁用WebDAV服务后，所有WebDAV客户端将无法访问。确定要禁用吗？","确认禁用",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>{G.enabled=!0})},Q=async()=>{try{await navigator.clipboard.writeText(J.value),a.success("WebDAV地址已复制到剪贴板")}catch(e){a.error("复制失败")}};return U(()=>{O()}),(e,a)=>{const x=o,h=d,D=n,A=s,W=r,U=p,O=c,Y=b,Z=f,ee=t,le=l,ae=V;return P(),j("div",F,[C(le,{class:"config-card"},{header:q(()=>a[10]||(a[10]=[B("div",{class:"card-header"},[B("h2",null,"WebDAV配置"),B("p",{class:"subtitle"},"配置WebDAV服务的访问权限和功能设置")],-1)])),default:q(()=>[C(ee,{ref_key:"configFormRef",ref:y,model:G,rules:I,"label-width":"140px",class:"config-form"},{default:q(()=>[C(h,{"content-position":"left"},{default:q(()=>[C(x,null,{default:q(()=>[C(z(i))]),_:1}),a[11]||(a[11]=S(" 基础设置 "))]),_:1,__:[11]}),C(A,{label:"启用WebDAV",prop:"enabled"},{default:q(()=>[C(D,{modelValue:G.enabled,"onUpdate:modelValue":a[0]||(a[0]=e=>G.enabled=e),"active-text":"启用","inactive-text":"禁用",onChange:X},null,8,["modelValue"]),a[12]||(a[12]=B("div",{class:"form-tip"},"启用后可通过WebDAV协议访问文件",-1))]),_:1,__:[12]}),C(A,{label:"访问路径",prop:"pathPrefix"},{default:q(()=>[C(W,{modelValue:G.pathPrefix,"onUpdate:modelValue":a[1]||(a[1]=e=>G.pathPrefix=e),placeholder:"/webdav",disabled:!G.enabled},null,8,["modelValue","disabled"]),a[13]||(a[13]=B("div",{class:"form-tip"},"WebDAV服务的访问路径前缀",-1))]),_:1,__:[13]}),C(A,{label:"需要认证",prop:"requireAuth"},{default:q(()=>[C(D,{modelValue:G.requireAuth,"onUpdate:modelValue":a[2]||(a[2]=e=>G.requireAuth=e),"active-text":"需要","inactive-text":"不需要",disabled:!G.enabled},null,8,["modelValue","disabled"]),a[14]||(a[14]=B("div",{class:"form-tip"},"是否需要用户名密码认证",-1))]),_:1,__:[14]}),C(h,{"content-position":"left"},{default:q(()=>[C(x,null,{default:q(()=>[C(z(u))]),_:1}),a[15]||(a[15]=S(" 权限设置 "))]),_:1,__:[15]}),C(A,{label:"允许的角色",prop:"allowedRoles"},{default:q(()=>[C(O,{modelValue:G.allowedRoles,"onUpdate:modelValue":a[3]||(a[3]=e=>G.allowedRoles=e),placeholder:"请选择允许访问的用户角色",disabled:!G.enabled},{default:q(()=>[C(U,{label:"仅管理员",value:"admin"}),C(U,{label:"访客用户",value:"visitor"})]),_:1},8,["modelValue","disabled"]),a[16]||(a[16]=B("div",{class:"form-tip"},"设置哪些角色的用户可以访问WebDAV",-1))]),_:1,__:[16]}),C(h,{"content-position":"left"},{default:q(()=>[C(x,null,{default:q(()=>[C(z(m))]),_:1}),a[17]||(a[17]=S(" 功能设置 "))]),_:1,__:[17]}),C(A,{label:"最大上传大小",prop:"maxUploadSize"},{default:q(()=>[C(Y,{modelValue:G.maxUploadSize,"onUpdate:modelValue":a[4]||(a[4]=e=>G.maxUploadSize=e),min:1,max:1024,step:10,disabled:!G.enabled},null,8,["modelValue","disabled"]),a[18]||(a[18]=B("span",{class:"unit"},"MB",-1)),a[19]||(a[19]=B("div",{class:"form-tip"},"单个文件的最大上传大小限制",-1))]),_:1,__:[18,19]}),C(A,{label:"允许创建目录",prop:"allowMkdir"},{default:q(()=>[C(D,{modelValue:G.allowMkdir,"onUpdate:modelValue":a[5]||(a[5]=e=>G.allowMkdir=e),"active-text":"允许","inactive-text":"禁止",disabled:!G.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"允许删除文件",prop:"allowDelete"},{default:q(()=>[C(D,{modelValue:G.allowDelete,"onUpdate:modelValue":a[6]||(a[6]=e=>G.allowDelete=e),"active-text":"允许","inactive-text":"禁止",disabled:!G.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"允许移动文件",prop:"allowMove"},{default:q(()=>[C(D,{modelValue:G.allowMove,"onUpdate:modelValue":a[7]||(a[7]=e=>G.allowMove=e),"active-text":"允许","inactive-text":"禁止",disabled:!G.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"允许复制文件",prop:"allowCopy"},{default:q(()=>[C(D,{modelValue:G.allowCopy,"onUpdate:modelValue":a[8]||(a[8]=e=>G.allowCopy=e),"active-text":"允许","inactive-text":"禁止",disabled:!G.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,{label:"配置描述",prop:"description"},{default:q(()=>[C(W,{modelValue:G.description,"onUpdate:modelValue":a[9]||(a[9]=e=>G.description=e),type:"textarea",rows:3,placeholder:"请输入配置描述",disabled:!G.enabled},null,8,["modelValue","disabled"])]),_:1}),C(A,null,{default:q(()=>[C(Z,{type:"primary",onClick:K,loading:H.value},{default:q(()=>[C(x,null,{default:q(()=>[C(z(_))]),_:1}),a[20]||(a[20]=S(" 保存配置 "))]),_:1,__:[20]},8,["loading"]),C(Z,{onClick:L},{default:q(()=>[C(x,null,{default:q(()=>[C(z(v))]),_:1}),a[21]||(a[21]=S(" 重置 "))]),_:1,__:[21]}),C(Z,{onClick:N,loading:$.value},{default:q(()=>[C(x,null,{default:q(()=>[C(z(g))]),_:1}),a[22]||(a[22]=S(" 恢复默认 "))]),_:1,__:[22]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),G.enabled?(P(),k(le,{key:0,class:"usage-card"},{header:q(()=>a[23]||(a[23]=[B("div",{class:"card-header"},[B("h3",null,"WebDAV使用说明")],-1)])),default:q(()=>[B("div",T,[C(ae,{title:"WebDAV访问地址",type:"info",closable:!1,"show-icon":""},{default:q(()=>[B("div",E,[B("code",null,R(J.value),1),C(Z,{size:"small",type:"primary",link:"",onClick:Q},{default:q(()=>[C(x,null,{default:q(()=>[C(z(w))]),_:1}),a[24]||(a[24]=S(" 复制 "))]),_:1,__:[24]})])]),_:1}),a[25]||(a[25]=B("div",{class:"usage-steps"},[B("h4",null,"使用步骤："),B("ol",null,[B("li",null,"在支持WebDAV的客户端中添加网络位置"),B("li",null,"输入上述WebDAV访问地址"),B("li",null,"使用您的用户名和密码进行认证"),B("li",null,"即可像本地文件夹一样操作远程文件")])],-1)),a[26]||(a[26]=B("div",{class:"client-recommendations"},[B("h4",null,"推荐客户端："),B("ul",null,[B("li",null,[B("strong",null,"Windows:"),S(" 文件资源管理器、WinSCP")]),B("li",null,[B("strong",null,"macOS:"),S(" Finder、Cyberduck")]),B("li",null,[B("strong",null,"Linux:"),S(" Nautilus、Dolphin")]),B("li",null,[B("strong",null,"移动端:"),S(" ES文件浏览器、FE文件管理器")])])],-1))])]),_:1})):M("",!0)])}}}),[["__scopeId","data-v-a10f13cb"]]);export{H as default};
