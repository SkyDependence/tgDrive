import{_ as e}from"./index-BMCoaVX0.js";/* empty css                 *//* empty css                    */import{p as a,a as l,o as s,q as r,t as o,U as t,O as u,a9 as n,ax as i,v as m,u as d,S as p,T as c}from"./vue-vendor-BrR667iQ.js";import{e as g,a3 as v,i as f,ap as h,$ as _,E as y,h as b,a1 as w,a2 as x,an as V,aq as j,f as k}from"./element-plus-p6bCxHry.js";import{s as S}from"./request-ByDjFvYQ.js";import"./utils-CuRI1GyR.js";const I={class:"login-page-container"},q={class:"login-card"},z={class:"login-header"},T={class:"login-options"},U=e(a({__name:"LoginPage",setup(e){const a=i(),U=l({username:"",password:""}),P=l(),C=l(!1),B=l(!1),E={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名长度至少为3个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6个字符",trigger:"blur"}]},F=()=>{var e;null==(e=P.value)||e.validate(e=>{return l=this,s=null,r=function*(){if(e){C.value=!0;try{const e=yield S.post("/auth/login",{username:U.value.username,password:U.value.password});if(1===e.data.code){const l=e.data.data;localStorage.setItem("token",l.token),localStorage.setItem("role",l.role),B.value?localStorage.setItem("username",U.value.username):localStorage.removeItem("username"),y.success(e.data.msg||"登录成功"),a.push("/home")}else y.error(e.data.msg||"登录失败")}catch(l){y.error("登录失败，请检查网络或联系管理员")}finally{C.value=!1}}},new Promise((e,a)=>{var o=e=>{try{u(r.next(e))}catch(l){a(l)}},t=e=>{try{u(r.throw(e))}catch(l){a(l)}},u=a=>a.done?e(a.value):Promise.resolve(a.value).then(o,t);u((r=r.apply(l,s)).next())});var l,s,r})},G=()=>{b.alert("请联系管理员重置您的密码。","忘记密码",{confirmButtonText:"好的"})};return s(()=>{const e=localStorage.getItem("username");e&&(U.value.username=e,B.value=!0)}),(e,a)=>{const l=g,s=w,i=x,y=V,b=j,S=k,K=v;return m(),r("div",I,[o("div",q,[o("div",z,[t(l,{size:28,color:"var(--el-color-primary)"},{default:u(()=>[t(d(f))]),_:1}),a[3]||(a[3]=o("h2",{class:"login-title"},"欢迎回来",-1)),a[4]||(a[4]=o("p",{class:"login-subtitle"},"登录以继续使用 ST-TG网盘",-1))]),t(K,{model:U.value,rules:E,ref_key:"loginFormRef",ref:P,"label-position":"top",onKeyup:n(F,["enter"]),class:"login-form"},{default:u(()=>[t(i,{label:"用户名",prop:"username"},{default:u(()=>[t(s,{modelValue:U.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>U.value.username=e),"prefix-icon":d(h),placeholder:"请输入用户名",size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),t(i,{label:"密码",prop:"password"},{default:u(()=>[t(s,{modelValue:U.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value.password=e),"prefix-icon":d(_),type:"password",placeholder:"请输入密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),t(i,null,{default:u(()=>[o("div",T,[t(y,{modelValue:B.value,"onUpdate:modelValue":a[2]||(a[2]=e=>B.value=e)},{default:u(()=>a[5]||(a[5]=[p("记住我")])),_:1},8,["modelValue"]),t(b,{type:"primary",onClick:G},{default:u(()=>a[6]||(a[6]=[p("忘记密码？")])),_:1})])]),_:1}),t(i,null,{default:u(()=>[t(S,{type:"primary",onClick:F,loading:C.value,class:"login-button",size:"large",block:""},{default:u(()=>[p(c(C.value?"登录中...":"登 录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),[["__scopeId","data-v-3e6a37ce"]]);export{U as default};
