import{_ as e}from"./index-BMCoaVX0.js";/* empty css                *//* empty css                 */import{p as a,a as s,Z as r,q as l,U as o,O as d,v as u,t as n,u as t,a2 as i,S as p,T as m}from"./vue-vendor-BrR667iQ.js";import{Q as c,ax as w,ap as f,$ as v,at as g,E as P,e as b,a1 as h,a2 as _,f as x,a3 as y}from"./element-plus-p6bCxHry.js";import{s as V}from"./request-ByDjFvYQ.js";import"./utils-CuRI1GyR.js";const j={class:"page-container"},q={class:"card-header"},z=e(a({__name:"ChangePassword",setup(e){const a=s({username:"",oldPassword:"",newPassword:"",confirmPassword:""}),z=s(),U=s(!1),k=r({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:16,message:"密码长度应为 6 到 16 个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,s,r)=>{""===s?r(new Error("请再次输入新密码")):s!==a.value.newPassword?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]}),E=()=>{var e;null==(e=z.value)||e.validate(e=>{return s=this,r=null,l=function*(){var s;if(e){U.value=!0;try{const e=yield V.post("/auth/change-password",{username:a.value.username,oldPassword:a.value.oldPassword,newPassword:a.value.newPassword});1===e.data.code?(P.success("密码修改成功"),null==(s=z.value)||s.resetFields()):P.error(e.data.msg||"密码修改失败")}catch(r){P.error("修改密码失败，请检查网络或联系管理员")}finally{U.value=!1}}},new Promise((e,a)=>{var o=e=>{try{u(l.next(e))}catch(s){a(s)}},d=e=>{try{u(l.throw(e))}catch(s){a(s)}},u=a=>a.done?e(a.value):Promise.resolve(a.value).then(o,d);u((l=l.apply(s,r)).next())});var s,r,l})};return(e,s)=>{const r=b,P=h,V=_,C=x,F=y,S=c;return u(),l("div",j,[o(S,{class:"content-card"},{header:d(()=>[n("div",q,[o(r,null,{default:d(()=>[o(t(w))]),_:1}),s[4]||(s[4]=n("span",null,"修改密码",-1))])]),default:d(()=>[o(F,{model:a.value,rules:k,ref_key:"passwordFormRef",ref:z,"label-position":"top",onSubmit:i(E,["prevent"]),class:"password-form"},{default:d(()=>[o(V,{label:"用户名",prop:"username"},{default:d(()=>[o(P,{modelValue:a.value.username,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value.username=e),"prefix-icon":t(f),placeholder:"请输入您的用户名",size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(V,{label:"旧密码",prop:"oldPassword"},{default:d(()=>[o(P,{modelValue:a.value.oldPassword,"onUpdate:modelValue":s[1]||(s[1]=e=>a.value.oldPassword=e),"prefix-icon":t(v),type:"password",placeholder:"请输入您的当前密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(V,{label:"新密码",prop:"newPassword"},{default:d(()=>[o(P,{modelValue:a.value.newPassword,"onUpdate:modelValue":s[2]||(s[2]=e=>a.value.newPassword=e),"prefix-icon":t(v),type:"password",placeholder:"请输入 6-16 位的新密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(V,{label:"确认新密码",prop:"confirmPassword"},{default:d(()=>[o(P,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":s[3]||(s[3]=e=>a.value.confirmPassword=e),"prefix-icon":t(g),type:"password",placeholder:"请再次输入新密码",size:"large","show-password":"",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),o(V,null,{default:d(()=>[o(C,{type:"primary",onClick:E,loading:U.value,class:"submit-button",size:"large",block:""},{default:d(()=>[p(m(U.value?"正在提交...":"确认修改"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}}),[["__scopeId","data-v-d5ec31db"]]);export{z as default};
