var a=(a,e,l)=>new Promise((t,s)=>{var i=a=>{try{n(l.next(a))}catch(e){s(e)}},o=a=>{try{n(l.throw(a))}catch(e){s(e)}},n=a=>a.done?t(a.value):Promise.resolve(a.value).then(i,o);n((l=l.apply(a,e)).next())});import{_ as e}from"./index-BMCoaVX0.js";/* empty css                *//* empty css                             *//* empty css               *//* empty css                   *//* empty css                 */import{E as l,Q as t,C as s,az as i,aA as o,aB as n,h as c,e as r,aC as d,a5 as u,f as p,a6 as v,aw as f,a7 as m}from"./element-plus-p6bCxHry.js";import{a as y}from"./utils-CuRI1GyR.js";import{p as g,a as h,f as _,o as b,q as j,U as k,O as w,v as x,t as z,u as T,S as B,T as C}from"./vue-vendor-BrR667iQ.js";const P={class:"page-container"},A={class:"card-header"},S={class:"action-section"},q={class:"status-section"},D={class:"action-item"},E={class:"action-item"},I={class:"task-controls"},K={class:"action-item"},L={class:"config-info"},N=e(g({__name:"BotKeepAlivePage",setup(e){const g=h(!1),N=h(!1),O=h(!1),Q=h(!1),U=h(""),F=_(()=>g.value?"保活任务运行中":"保活任务已停止"),G=_(()=>g.value?"success":"warning"),H=_(()=>g.value?"定时保活任务正在运行，将在每天凌晨2点自动发送保活消息，确保机器人保持活跃状态。":"定时保活任务已停止，机器人可能会因长时间不活跃而被Telegram限制。建议启动定时任务。"),J=()=>{U.value=(new Date).toLocaleString("zh-CN")},M=()=>a(this,null,function*(){try{const a=yield y.get("/api/bot/keep-alive/status");1===a.data.code&&(g.value="运行中"===a.data.data,J())}catch(a){l.error("获取任务状态失败")}}),R=()=>a(this,null,function*(){N.value=!0;try{const a=yield y.post("/api/bot/keep-alive/send");1===a.data.code?(l.success("保活消息发送成功"),J()):l.error(a.data.msg||"发送失败")}catch(a){l.error("发送保活消息失败")}finally{N.value=!1}}),V=()=>a(this,null,function*(){try{yield c.confirm("确定要启动定时保活任务吗？任务将在每天凌晨2点自动发送保活消息。","确认启动",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),O.value=!0;const a=yield y.post("/api/bot/keep-alive/start");1===a.data.code?(l.success("定时保活任务启动成功"),yield M()):l.error(a.data.msg||"启动失败")}catch(a){"cancel"!==a&&l.error("启动定时任务失败")}finally{O.value=!1}}),W=()=>a(this,null,function*(){try{yield c.confirm("确定要停止定时保活任务吗？停止后机器人可能会因长时间不活跃而被限制。","确认停止",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),Q.value=!0;const a=yield y.post("/api/bot/keep-alive/stop");1===a.data.code?(l.success("定时保活任务停止成功"),yield M()):l.error(a.data.msg||"停止失败")}catch(a){"cancel"!==a&&l.error("停止定时任务失败")}finally{Q.value=!1}});return b(()=>{M()}),(a,e)=>{const l=r,c=d,y=u,h=p,_=v,b=f,J=m,M=t;return x(),j("div",P,[k(M,{class:"content-card"},{header:w(()=>[z("div",A,[k(l,null,{default:w(()=>[k(T(s))]),_:1}),e[0]||(e[0]=z("span",null,"机器人保活管理",-1))])]),default:w(()=>[z("div",S,[z("div",q,[k(c,{title:F.value,type:G.value,description:H.value,"show-icon":"",closable:!1},null,8,["title","type","description"])]),k(y,{direction:"horizontal"}),z("div",D,[e[2]||(e[2]=z("h3",null,"手动发送保活消息",-1)),e[3]||(e[3]=z("p",null,"立即发送一条保活消息到Telegram，用于测试机器人连接状态。",-1)),k(h,{type:"primary",onClick:R,loading:N.value,icon:T(i),size:"large"},{default:w(()=>e[1]||(e[1]=[B(" 发送保活消息 ")])),_:1},8,["loading","icon"])]),k(y,{direction:"horizontal"}),z("div",E,[e[6]||(e[6]=z("h3",null,"定时保活任务",-1)),e[7]||(e[7]=z("p",null,"控制自动保活任务的启动和停止。任务将在每天凌晨2点自动发送保活消息。",-1)),z("div",I,[k(h,{type:"success",onClick:V,loading:O.value,disabled:g.value,icon:T(o),size:"large"},{default:w(()=>e[4]||(e[4]=[B(" 启动定时任务 ")])),_:1},8,["loading","disabled","icon"]),k(h,{type:"warning",onClick:W,loading:Q.value,disabled:!g.value,icon:T(n),size:"large",plain:""},{default:w(()=>e[5]||(e[5]=[B(" 停止定时任务 ")])),_:1},8,["loading","disabled","icon"])])]),k(y,{direction:"horizontal"}),z("div",K,[e[10]||(e[10]=z("h3",null,"保活配置",-1)),z("div",L,[k(J,{column:1,border:""},{default:w(()=>[k(_,{label:"发送时间"},{default:w(()=>e[8]||(e[8]=[B("每天凌晨2点")])),_:1}),k(_,{label:"发送间隔"},{default:w(()=>e[9]||(e[9]=[B("24小时")])),_:1}),k(_,{label:"任务状态"},{default:w(()=>[k(b,{type:g.value?"success":"danger"},{default:w(()=>[B(C(g.value?"运行中":"已停止"),1)]),_:1},8,["type"])]),_:1}),k(_,{label:"最后更新"},{default:w(()=>[B(C(U.value),1)]),_:1})]),_:1})])])])]),_:1})])}}}),[["__scopeId","data-v-a24025c8"]]);export{N as default};
